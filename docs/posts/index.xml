
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
 <channel>
   <title>Posts on æ²³é©¬èœ€é»çœŸæ˜¯çš„</title>
   <link>https://hemashushu.github.io/posts/</link>
   <description>Recent content in Posts on æ²³é©¬èœ€é»çœŸæ˜¯çš„</description>
   <generator>Hugo -- gohugo.io</generator>
   <language>en-us</language>
   <copyright>Copyright &amp;copy; 2022 - Hippospark</copyright>
   <lastBuildDate>Mon, 31 Oct 2022 14:34:52 +0800</lastBuildDate>
   
       <atom:link href="https://hemashushu.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
   
   
     <item>
       <title>ä»é›¶å¼€å§‹ä¸€æ­¥ä¸€æ­¥æ„å»ºç°ä»£è®¡ç®—æœºç³»ç»Ÿ - åˆ¨æ ¹é—®åº•çš„å¼€å§‹</title>
       <link>https://hemashushu.github.io/posts/2022-10-31-building-a-modern-computer-system-from-scratch-step-by-step/</link>
       <pubDate>Mon, 31 Oct 2022 14:34:52 +0800</pubDate>
       
       <guid>https://hemashushu.github.io/posts/2022-10-31-building-a-modern-computer-system-from-scratch-step-by-step/</guid>
       <description>&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;RISC-V æ˜¯æœ€è¿‘å‡ å¹´çƒ­é—¨çš„è®¡ç®—æœºæŒ‡ä»¤é›†ï¼Œç›¸ä¿¡å·²ç»æœ‰ä¸å°‘æœ‹å‹å·²ç»å°è¯•è¿‡ç¼–è¯‘ RISC-V ç‰ˆçš„ Linux å†…æ ¸ï¼Œæˆ–è€…è·Ÿç€æ•™ç¨‹ç¼–å†™ç©å…·æ“ä½œç³»ç»Ÿã€åˆ¶ä½œç©å…·ç¼–ç¨‹è¯­è¨€ï¼Œç”šè‡³è¿˜æœ‰ç”¨ HDLï¼ˆç¡¬ä»¶æè¿°è¯­è¨€ï¼‰ç¼–å†™è‡ªå·±çš„ç©å…· CPUã€‚&lt;/p&gt;&lt;p&gt;æ— è®ºä½ æ˜¯å“ªç§ï¼Œåˆšå¼€å§‹æ—¶è‚¯å®šæ—¢æ¿€åŠ¨åˆå…´å¥‹ï¼Œå°±åƒè¦åœ¨ä¸€ä¸ªå¼‚ä¸–ç•Œå¼€å§‹ä¸€æ®µæ–°å†’é™©çš„å‹‡è€…é‚£æ ·ã€‚ä¸è¿‡ç¿»åˆ°æ•™ç¨‹çš„ç¬¬äºŒç« ï¼Œå¯èƒ½å¤§éƒ¨åˆ†æœ‹å‹å°±å¼€å§‹çœ‰å¤´ç´§é”ï¼Œç„¶åå’¬ç€ç‰™åˆç¿»äº†å‡ ç« ï¼Œç»è¿‡ä¸€ç•ªæŒ£æ‰æœ€ååªèƒ½æ”¾å¼ƒã€‚è¿™æ—¶å€™ä½ å¯èƒ½å¾ˆç–‘æƒ‘ï¼šâ€œæ˜æ˜å†™äº†å‡ å¹´çš„ç¨‹åºï¼Œå„ç§ç®—æ³•é¢˜æ—©å·²ä¸æ”¾åœ¨çœ¼é‡Œï¼Œæ€ä¹ˆåœ¨è¿™é‡Œå°±ç¿»è½¦äº†å‘¢ï¼Ÿï¼&amp;quot;&lt;/p&gt;&lt;p&gt;æ˜¾ç„¶è¿™æ˜¯å› ä¸ºç¼ºå°‘å¯¹ &lt;em&gt;ç³»ç»Ÿçš„åº•å±‚æŠ€æœ¯&lt;/em&gt; çš„äº†è§£ï¼ˆ&lt;em&gt;ç³»ç»Ÿçš„åº•å±‚æŠ€æœ¯&lt;/em&gt; ä¹Ÿå°±æ˜¯ &lt;em&gt;è®¡ç®—æœºåŸºç¡€æŠ€æœ¯&lt;/em&gt;ï¼Œä¸è¿‡è¿™ä¸ªåç§°ç»å¸¸å¼•èµ·ç†å·¥ç§‘ä¹‹å¤–çš„äººè¯¯è§£ï¼Œä¸‹é¢ç®€ç§° &lt;em&gt;ç³»ç»ŸæŠ€æœ¯&lt;/em&gt;ï¼‰ï¼Œä½ å¯èƒ½ä¼šåé©³ï¼šâ€ç³»ç»ŸæŠ€æœ¯å˜›ï¼Œåœ¨è®¡ç®—æœºåŸºç¡€è¯¾ç¨‹é‡Œæˆ‘æ—©å°±å­¦è¿‡äº†ï¼Œè€ƒè¯•ä¹Ÿé€šè¿‡äº†ï¼â€œã€‚æ˜¯çš„ï¼Œåœ¨è®¡ç®—æœºä¸“ä¸šçš„è¯¾ç¨‹è®¾ç½®é‡Œéƒ½æœ‰è¯¸å¦‚ &lt;em&gt;ç»„æˆåŸç†&lt;/em&gt;ã€&lt;em&gt;ç¼–è¯‘åŸç†&lt;/em&gt;ã€&lt;em&gt;æ“ä½œç³»ç»Ÿ&lt;/em&gt; ç­‰è¯¾ç¨‹ï¼Œè€Œä¸”è¿˜æ‹…å¿ƒä½ å¸æ”¶ä¸äº†äºæ˜¯ä¸€é—¨ä¸€é—¨åœ°åˆ†å‡ ä¸ªå­¦æœŸæ•™å­¦ã€‚ä¸è¿‡&lt;strong&gt;æŠŠè¿™äº›ç§‘ç›®åˆ†å¼€å­¦ä¹ æ˜¯é”™è¯¯çš„&lt;/strong&gt;ï¼Œè®¡ç®—æœºçš„ç³»ç»ŸæŠ€æœ¯ç›¸äº’äº¤å‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/path.png&#34; alt=&#34;path&#34;&gt;&lt;em&gt;èºæ—‹å¼çš„å­¦ä¹ è·¯å¾„&lt;/em&gt;&lt;/p&gt;&lt;p&gt;è®¡ç®—æœºç³»ç»ŸåŒ…æ‹¬äº† &lt;em&gt;è¯­è¨€&lt;/em&gt;ã€&lt;em&gt;å¤„ç†å™¨&lt;/em&gt; å’Œ &lt;em&gt;æ“ä½œç³»ç»Ÿ&lt;/em&gt; ä¸‰ä¸ªåŸºæœ¬ç»„æˆéƒ¨åˆ†ã€‚å¦‚æœä»è¿œè·ç¦»æ¥çœ‹ï¼Œå¤„ç†å™¨å’Œæ“ä½œç³»ç»Ÿæ˜¯åŒä¸€å›äº‹ï¼Œå®ƒä»¬å…±åŒæ„å»ºäº†ä¸€ç§äººç±»æ–‡æ˜å½“ä¸­æœ€å¤æ‚çš„æœºå™¨ â€”â€”â€”â€” è®¡ç®—æœºã€‚å¤„ç†å™¨è´Ÿè´£å®ç°ä¸å˜çš„é€»è¾‘è¿ç®—ï¼Œæ“ä½œç³»ç»Ÿæ˜¯å¤„ç†å™¨çš„è‡ªç„¶å»¶ä¼¸ï¼Œè´Ÿè´£å®ç°éœ€è¦å˜åŒ–çš„éƒ¨åˆ†ï¼Œè€Œè¯­è¨€ç”¨äºè¡¨è¾¾ã€å°è£…å’ŒæŠ½è±¡æœºå™¨çš„åŠŸèƒ½ï¼Œä½¿å¾—æœºå™¨å’Œäººç±»ä¹‹é—´çš„äº¤æµæˆä¸ºå¯èƒ½ã€‚å¯è§è®¡ç®—æœºç³»ç»Ÿçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†æ˜¯ &lt;strong&gt;åŒä¸€ä¸ªç›®çš„ â€”â€”â€”â€” è®©æœºå™¨è§£å†³é—®é¢˜&lt;/strong&gt; çš„ä¸åŒä¾§é¢ï¼Œåˆ†å¼€å­¦ä¹ è‡ªç„¶æ— æ³•ç†è§£å…¶ä¸­çš„è”ç³»å’Œç¼˜ç”±ã€‚ä¸å¦¨æŠŠæ¯ä¸€ä¸ªé¢†åŸŸæƒ³è±¡æˆä¸€æ ¹æ ¹ç«‹èµ·æ¥çš„æŸ±å­ï¼Œæ­£ç¡®çš„å­¦ä¹ è·¯å¾„æ˜¯å›´ç»•ç€è¿™äº›æŸ±å­&lt;strong&gt;èºæ—‹å¼åœ°é€æ¸å¾€ä¸Šçˆ¬&lt;/strong&gt;ï¼Œè€Œä¸æ˜¯ä¸€å£æ°”çˆ¬å®Œä¸€æ ¹æŸ±å­ï¼Œç„¶åæ»‘ä¸‹æ¥å†çˆ¬å¦ä¸€æ ¹æŸ±å­ã€‚&lt;/p&gt;&lt;p&gt;å…¶æ¬¡å­¦ä¹ æ–¹å¼ä¹Ÿå­˜åœ¨é—®é¢˜ï¼Œè®¡ç®—æœºç³»ç»ŸæŠ€æœ¯å¤§éƒ¨åˆ†æ˜¯å·¥ç¨‹å¸ˆä»¬åœ¨ä¸æ–­åœ°è§£å†³é—®é¢˜ä¹‹åå¾—å‡ºçš„æ€»ç»“å’Œç§¯ç´¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›æŠ€æœ¯å½“ä¸­ç†è®ºå¹¶ä¸æ˜¯å ä¸»å¯¼ä½œç”¨ï¼Œæ›´å¤šæ˜¯ä¸ºäº†è§£å†³é—®é¢˜è€Œé€šè¿‡å„ç§å°è¯•åå¾—å‡ºçš„ &lt;em&gt;æœ€ä½³å®è·µ&lt;/em&gt;ã€‚å› æ­¤è¾ƒå¥½çš„çš„å­¦ä¹ æ–¹å¼åº”è¯¥æ˜¯å…ˆä»æ¢ç´¢å’Œå®è·µå¼€å§‹å…¥æ‰‹ï¼Œç„¶å&lt;strong&gt;è¾¹å®è·µè¾¹è¯•é”™ã€è¾¹é¢†ä¼šè¾¹æ€»ç»“&lt;/strong&gt;ï¼Œè€Œä¸æ˜¯å…ˆå­¦ä¸€å¤§å †åŸç†ï¼Œåšå®Œä¸€å †ä¹ é¢˜ï¼Œå†æ¥å®è·µã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/way.png&#34; alt=&#34;way&#34;&gt;&lt;/p&gt;&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œè™½ç„¶æˆ‘ä»¬å‡ ä¹éƒ½å­¦è¿‡è·Ÿè®¡ç®—æœºç³»ç»Ÿç›¸å…³çš„ç§‘ç›®ï¼Œä½†å› ä¸ºè·Ÿç³»ç»Ÿçš„æ„å»ºæ–¹å¼å’Œè¿‡ç¨‹éƒ½ç›¸å·®ç”šè¿œï¼Œæ‰€ä»¥å®é™…ä¸Šå¹¶æ²¡æœ‰çœŸæ­£æŒæ¡åˆ°è¿™äº›æŠ€æœ¯ã€‚ä¸å¦¨è¯•è¯•åœ¨æ²¡æœ‰ç½‘ç»œçš„å¸®åŠ©ä¸‹ï¼Œèƒ½å¦è‡ªå·±è®¾è®¡ä¸€å¥—æœ€ç®€çš„æŒ‡ä»¤é›†ï¼Œç„¶åæ‰‹ç”»å¾®æ¶æ„ï¼ˆmicroarchitectureï¼‰çš„å¤§è‡´æ•°æ®é€šè·¯ï¼ˆdata pathï¼‰ï¼›æˆ–è€…ç»™å®šä¸€ä¸ªç›®æ ‡æ¶æ„ï¼Œç¼–å†™ä¸€ä¸ªå†·å¯åŠ¨çš„å¼•å¯¼ç¨‹åºï¼›åˆæˆ–è€…ä¸ä¾èµ–ä»»ä½•åº“ï¼Œä»é›¶å¼€å§‹æ‰‹å†™ä¸€ä¸ªç®€å•çš„è¯­æ³•è§£æå™¨ã€‚&lt;/p&gt;&lt;h2 id=&#34;ç‰¹ç‚¹&#34;&gt;ç‰¹ç‚¹&lt;/h2&gt;&lt;p&gt;å®é™…ä¸Šæˆ‘ä»¬åœ¨å¹³æ—¶çš„å·¥ä½œå’Œå­¦ä¹ å½“ä¸­å·²ç»ç§¯ç´¯äº†ä¸€å®šçš„ç³»ç»ŸçŸ¥è¯†ï¼Œåªæ˜¯å®ƒä»¬åœ¨è„‘æµ·é‡Œæˆ–è€…æ˜¯æ¾æ•£è¯´ç€æ˜¯æ¸¸ç¦»çš„çŠ¶æ€ï¼Œæˆ‘å¸Œæœ›èƒ½é€šè¿‡ä¸€ç³»åˆ—æ–‡ç« ï¼ŒæŠŠè¿™äº›çŸ¥è¯†æœ‰åºåœ°è¿æ¥èµ·æ¥ï¼Œä»è€Œæˆä¸ºä½ æŒæ¡çš„æŠ€æœ¯ã€‚è¿™ç³»åˆ—æ–‡ç« æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸å†æ˜¯ â€œè®²åŸç†ç„¶ååšé¡¹ç›®â€ï¼Œè€Œæ˜¯ä»æ¢ç´¢å’Œå®è·µå…¥æ‰‹ï¼Œåœ¨å®è·µå’Œè¯•é”™è¿‡ç¨‹ä¸­å†ç©¿æ’åŸç†ï¼ˆä¸ºäº†ç»™ä½ è§£é—·ï¼Œæœ‰æ—¶è¿˜ä¼šç©¿æ’ä¸€äº›æˆ‘çŸ¥é“çš„å°å…¸æ•…å°æ•…äº‹ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;ä¸å†æ ¹æ®å­¦ç§‘åˆ†ç±»ï¼Œè€Œæ˜¯æ ¹æ®ç³»ç»Ÿçš„æ„å»ºè¿‡ç¨‹ä»¥åŠæˆ‘ä»¬èƒ½ç†è§£çš„ç¨‹åº¦ï¼ŒæŠŠæ•´ä¸ªç³»åˆ—åˆ‡åˆ†ä¸ºå¤šä¸ªå°é˜¶æ®µã€‚æ¯ä¸ªå°é˜¶ä¼šåŒæ—¶æ¶‰åŠå¤šä¸ªé¢†åŸŸï¼ˆå­¦ç§‘ï¼‰çš„çŸ¥è¯†ï¼Œæ¯ä¸ªé¢†åŸŸéƒ½æ˜¯å¤Ÿç”¨ä¸ºæ­¢ï¼Œä¸ä¼šè¿‡åº¦æ·±å…¥ï¼Œå®Œæˆä¸€ä¸ªé˜¶æ®µå†è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚&lt;/li&gt;&lt;li&gt;&lt;strong&gt;ä¸éœ€è¦ä»»ä½•ä¸“é—¨çš„ IDEã€å·¥å…·ã€SDK æˆ–è€…åº“&lt;/strong&gt;ï¼Œä»é›¶å¼€å§‹æ„å»ºã€‚å¼€å§‹é˜¶æ®µåªéœ€å‡ ä¸ªé€šç”¨çš„å¼€æºå…è´¹çš„ç¼–è¯‘å™¨å’Œå·¥å…·ï¼Œåé¢åˆ™ä½¿ç”¨è‡ªå·±çš„å·¥å…·ï¼Œå› æ­¤å¯ä»¥å½»åº•å¼„æ˜ç™½æ¯ä¸€ä¸ªæŠ€æœ¯ç»†èŠ‚ï¼ˆæ¯•ç«Ÿå°±è¿å·¥å…·éƒ½æ˜¯è‡ªå·±æ„å»ºçš„ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;æ— éœ€æ˜‚è´µçš„è½¯ä»¶å’Œç¡¬ä»¶ï¼Œåªä½¿ç”¨å‡ ä¸ªé€šç”¨çš„å¼€æºå…è´¹çš„è½¯ä»¶ï¼Œå’Œå‡ ä¸ªæœ€å¹¿æ³›ä½¿ç”¨çš„ï¼ˆä¹…ç»è€ƒéªŒçš„ï¼‰æœ€å»‰ä»·çš„ç¡¬ä»¶æ¨¡å—ï¼Œå³å¯ä»¥å®Œæˆåˆ°æœ€åä¸€ç« ã€‚å¾ˆå¤šä¸“ä¸šçš„ç³»ç»ŸæŠ€æœ¯æ•™ç¨‹æˆ–è€…åŸ¹è®­éœ€è¦å„ç§æ˜‚è´µçš„é«˜å¤§ä¸Šçš„ä¸“ä¸šè½¯ä»¶å’Œç¡¬ä»¶ï¼Œè€Œæˆ‘ä»¬è¿™ä¸ªç³»åˆ—åªæœ‰ç¡¬ä»¶æ¨¡å—éœ€è¦å¼€é”€ï¼Œè€Œä¸”ä¸€å…±åªéœ€ä¸€ä¸¤ç™¾æ¥å—é’±ï¼Œæœ€é‡è¦çš„æ˜¯è¿™ä¸ªç³»åˆ—ä¸æ˜¯ä¸ºäº†è®©ä½ æˆä¸ºæŸä¸ªè½¯ä»¶æˆ–è€…ç¡¬ä»¶çš„æ“ä½œå·¥å’Œåº”ç”¨è€…ï¼Œè€Œæ˜¯è®©ä½ åˆ›é€ å·¥å…·ã€æ„å»ºç³»ç»Ÿã€‚ï¼ˆä¸ºæ‰“æ¶ˆä½ çš„ç–‘è™‘æˆ‘å…ˆè¯´æ˜ï¼Œè¿™ç³»åˆ—æ–‡ç« æ˜¯å…è´¹çš„ï¼Œæ–‡ç« å½“ä¸­ä¹Ÿä¸ä¼šæœ‰ä»»ä½•å¹¿å‘Šæˆ–è€…æ¨å¹¿é“¾æ¥ï¼‰&lt;/li&gt;&lt;li&gt;ä¸æ˜¯ç§‘æ™®æˆ–è€…èµ°é©¬è§‚èŠ±å¼çš„è§‚æ‘©ï¼Œè€Œæ˜¯æ·±å…¥åœ°å¯¹è®¡ç®—æœºç³»ç»Ÿçš„å®Œæ•´å®è·µã€‚é€šè¿‡è¿™ä¸€ç³»åˆ—æ–‡ç« ä½ ä¼šå¯¹ç³»ç»Ÿæœ‰æ­£ç¡®çš„è®¤è¯†å’Œç†è§£ï¼Œå¯ä»¥ä¸è¢«é‚£äº›å¹¿æ³›æµä¼ çš„å®åˆ™é”™è¯¯çš„ â€œçŸ¥è¯†â€ æ‰€è¿·æƒ‘ï¼ˆæ¯”å¦‚å¾ˆå¤šäººè®¤ä¸ºè®¡ç®—æœºæ ¸å¿ƒæŠ€æœ¯åªæœ‰èŠ¯ç‰‡åˆ¶é€ æœºå™¨ï¼Œä¼¼ä¹è§£å†³è¿™ä¸€é¡¹å…¶å®ƒéƒ½ä¸æ˜¯é—®é¢˜ï¼Œè€Œäº‹å®ä¸Šè¿™æ˜¯å®Œå…¨é”™è¯¯çš„ï¼Œåˆ¶é€ æœºå™¨å¤„äºæœ«ç«¯ç¯èŠ‚ï¼Œè·Ÿç³»ç»ŸçœŸæ­£çš„æ ¸å¿ƒå’Œæºå¤´ç›¸å·®åä¸‡å…«åƒé‡Œï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™ä¸€ç³»åˆ—æ–‡ç« ä¼šä»¥ RISC-V æŒ‡ä»¤é›†ä½œä¸ºå­¦ä¹ å’Œå®ç°çš„ç›®æ ‡æ¶æ„ï¼Œä¹‹æ‰€ä»¥é€‰æ‹© RISC-V åŸå› æœ‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å®ƒçš„æŒ‡ä»¤é›†ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬è‡ªå·±åŠ¨æ‰‹å®ç° &amp;ldquo;æœ€å°çš„èƒ½å·¥ä½œçš„&amp;rdquo; æ±‡ç¼–å™¨åŠå¤„ç†å™¨æˆä¸ºå¯èƒ½ï¼›&lt;/li&gt;&lt;li&gt;æœ‰å¤§é‡ç›¸å…³çš„å¼€æºå…è´¹çš„å·¥å…·å’Œæ–‡æ¡£ï¼Œå¯ä»¥äº«ç”¨ç°æœ‰çš„å·¥å…·æ¥æ£€æŸ¥å’ŒéªŒè¯æˆ‘ä»¬çš„ &amp;ldquo;ä½œå“&amp;rdquo; æ˜¯å¦æ­£ç¡®ï¼Œè¿™å¯¹æ‘¸ç´¢å’Œå­¦ä¹ è¿‡ç¨‹éå¸¸é‡è¦ï¼›&lt;/li&gt;&lt;li&gt;æœ€åå¦‚æœæˆ‘ä»¬åšå‡ºäº†äº§å“ï¼Œä¹Ÿæ— éœ€é¡¾å¿Œæˆæƒé—®é¢˜ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2 id=&#34;å†…å®¹ç®€ä»‹&#34;&gt;å†…å®¹ç®€ä»‹&lt;/h2&gt;&lt;p&gt;æ— å¯å¦è®¤è®¡ç®—æœºç³»ç»Ÿçš„å†…å®¹éå¸¸ä¹‹å¤šï¼Œå®ƒæ˜¯å‡ åå¹´ä»¥æ¥æˆåƒä¸Šä¸‡å…¨çƒæœ€é¡¶å°–å·¥ç¨‹å¸ˆçš„æ€»ç»“å’Œç§¯ç´¯ï¼Œæ— è®ºæ˜¯çŸ¥è¯†é¢å¹¿åº¦å’Œæ·±åº¦éƒ½å‡ ä¹é€¼è¿‘äººè„‘çš„æé™ï¼Œä»æŸä¸ªè§’åº¦ç”šè‡³å¯ä»¥è¯´ï¼Œå®ƒæ˜¯ä¸€ç¾¤æ€ç»´&lt;strong&gt;è¿œè¶…è¶Šæˆ‘ä»¬å½“å‰æ—¶ä»£&lt;/strong&gt;çš„äººçš„ä½œå“ã€‚æ²³é©¬èœ€é»çŸ¥é“æ— æ³•ç®€å•åœ°é€šè¿‡å‡ ç¯‡æ–‡ç« å°±èƒ½è®²å®Œï¼Œæ‰€ä»¥å‡†å¤‡äº†å››ä¸ªç³»åˆ—ï¼ˆseriesï¼‰ï¼Œæ¯ä¸ªç³»åˆ—åˆ†ä¸ºè‹¥å¹²éƒ¨ï¼ˆpartï¼‰ï¼Œæ¯éƒ¨å«è‹¥å¹²ç¯‡æ–‡ç« ï¼ˆchapterï¼‰ï¼Œä¸€å…±ä¹Ÿå°±ç™¾æ¥ç¯‡é•¿æ–‡ã€‚ä¸€å¥è¯æè¿°è¿™ä¸€ç³»åˆ—æ–‡ç« çš„ä¸»è¦å†…å®¹å°±æ˜¯ï¼š&lt;strong&gt;å­¦ä¹ ç°æœ‰çš„å·¥å…·å’Œç³»ç»Ÿ -&amp;gt; åˆ¶ä½œè‡ªå·±çš„å·¥å…· -&amp;gt; æ‰“é€ æ–°çš„ç³»ç»Ÿ&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/content.png&#34; alt=&#34;content&#34;&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­çš„å†…å®¹éå¸¸å¤šï¼Œä¸è¿‡ä½ ä¸ç”¨æ‹…å¿ƒéš¾åº¦è¿‡é«˜è€Œæ— æ³•å®Œæˆï¼Œå› ä¸ºæ¯ä¸€ä¸ªéƒ¨åˆ†è™½ç„¶åå ‚å¾ˆå¤§ï¼Œä½†éƒ½æ˜¯ä»…å®ç°æœ€åŸºæœ¬çš„ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯ &amp;ldquo;åˆšå¥½èƒ½ç”¨&amp;rdquo; çš„ç¨‹åº¦å³æ­¢ï¼Œæ‰€ä»¥åªéœ€ä¸€æ­¥æ­¥è·Ÿç€æ¥ï¼Œå°±ä¸ä¼šå‘ç”Ÿåœ¨ä¸­é€”å°±è¢«å¡ä½çš„æƒ…å†µã€‚ä¸è¿‡æˆ‘ä¹Ÿä¼šåœ¨ â€œç®€é™‹â€ å’Œ â€œå®ç”¨â€ ä¹‹é—´å¹³è¡¡ï¼Œè®©æ¯ä¸€éƒ¨çš„ â€œä½œå“â€ éƒ½æœ‰æœ‰å®ç”¨ä»·å€¼ã€‚&lt;/p&gt;&lt;p&gt;ç°ä»£ä¸»æµçš„è®¡ç®—æœºç³»ç»Ÿéƒ½æœ‰æ²‰é‡çš„å†å²åŒ…è¢±ï¼Œæ¯”å¦‚ GCC å·²æœ‰ä¸‰åå¤šå¹´çš„å†å²ï¼ŒLinux å†…æ ¸ä¹Ÿä¿®ä¿®è¡¥è¡¥ä¸‰åå¹´ï¼Œå¯¼è‡´æ— è®ºæ˜¯é˜…è¯»ç†è§£ã€ä¿®æ”¹ã€æ‰©å……éƒ½éå¸¸ç¹æ‚ï¼Œè€Œä¸”å¾ˆå¤šæ–°è§‚å¿µæ— æ³•æ•´åˆã€‚è€Œæˆ‘ä»¬çš„ç³»ç»Ÿå› ä¸ºæ˜¯ä»é›¶å¼€å§‹ï¼Œå®Œå…¨æ²¡æœ‰åŒ…è¢±ï¼Œæ‰€ä»¥å®ç°èµ·æ¥ç›¸å¯¹ä¼šç®€å•è½»æ¾ï¼Œæœ‰äº›é—®é¢˜ä¹Ÿå¯ä»¥ &lt;strong&gt;ä»æ ¹æœ¬ä¸Šè§£å†³&lt;/strong&gt;ï¼ˆæ¯”å¦‚å†…å­˜å®‰å…¨é—®é¢˜ï¼Œä»æŒ‡ä»¤åˆ°æ“ä½œç³»ç»Ÿåˆ°ç¼–è¯‘å™¨ä¸€èµ·é…åˆå³èƒ½åœ¨å…¼é¡¾æ€§èƒ½å’Œå®‰å…¨çš„å‰æä¸‹è§£å†³ï¼‰ï¼›æ–°ç†å¿µï¼ˆä¸¥æ ¼æ¥è¯´å¹¶ä¸æ˜¯æ–°çš„ï¼Œåªæ˜¯å› ä¸ºæ²¡æœ‰èå…¥ç°æœ‰ç³»ç»Ÿè€Œé²œæœ‰äººè®¤è¯†ï¼‰ä¹Ÿèƒ½æ— æ‰€é¡¾å¿Œåœ°åŠ å…¥ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨åŒä¸€é—¨è¯­è¨€å®ç°ç¡¬ä»¶å¼€å‘ã€åº•å±‚å¼€å‘ã€åç«¯å¼€å‘å’Œå‰ç«¯å¼€å‘ï¼›è®¾è®¡ä¸€é—¨é˜…è¯»å‹å¥½çš„æ±‡ç¼–è¯­è¨€ï¼›è®¾è®¡ä¸€é—¨æè¿°å‹çš„é“¾æ¥è„šæœ¬è¯­è¨€ï¼›ä½¿ç”¨å¾®å†…æ ¸ï¼Œé©±åŠ¨èƒ½åƒæ™®é€šç¨‹åºä¸€æ ·å¼€å‘ã€è°ƒè¯•å’Œå®‰è£…ï¼›ç³»ç»Ÿæ°¸ä¸éœ€å…³æœºå’Œé‡å¯ï¼Œå¯å›æ»šçš„æ›´æ–°ï¼›ç³»ç»ŸåŸºäºèƒ½åŠ›ï¼ˆcapabilityï¼‰è€Œä¸æ˜¯ &lt;em&gt;ç”¨æˆ·å’Œç»„&lt;/em&gt; çš„å®‰å…¨æ¨¡å‹ç­‰ç­‰ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥è¿™å¥—ç³»ç»Ÿæœ‰ç›¸å½“å¤šçš„ç‰¹ç‚¹å’Œä¼˜ç‚¹ï¼Œå³ä½¿ä½ èƒ½çœ‹åˆ°ç±»ä¼¼ â€œä»é›¶å¼€å§‹æ„å»ºç³»ç»Ÿâ€ çš„ä¹¦ç±æˆ–æ–‡ç« ï¼Œæˆ‘ä»¬è¿™ä¸ªç³»åˆ—ä»è®©ä½ è€³ç›®ä¸€æ–° ğŸ˜ã€‚&lt;/p&gt;&lt;h2 id=&#34;ç‚¹èµè½¬å‘æ‰“èµ&#34;&gt;ç‚¹èµã€è½¬å‘ã€æ‰“èµ&lt;/h2&gt;&lt;p&gt;è™½ç„¶è¿™ç³»åˆ—æ–‡ç« çš„å¤§éƒ¨åˆ†å†…å®¹æˆ‘éƒ½å·²ç»å®è·µè¿‡ï¼Œä¸è¿‡æˆ‘å‘ç°è¦æŠŠå®ƒä»¬ä»å¤´åˆ°å°¾è®²è§£èµ·æ¥ç›¸å½“æœ‰æŒ‘æˆ˜æ€§ï¼šåºå¤§è€Œäº¤å‰çš„å†…å®¹å¦‚ä½•ç»„ç»‡æ‰èƒ½åšåˆ°ç”±æ˜“åˆ°éš¾ï¼Œå¦‚ä½•æŒ‘é€‰å®è·µçš„å†…å®¹ï¼Œå¦‚ä½•åšåˆ°ç¯‡ç« ä¹‹é—´å†…å®¹çš„è‡ªç„¶è¿‡æ¸¡å’Œè¡”æ¥ï¼Œå¦‚ä½•ç¡®ä¿å†…å®¹çš„å‡†ç¡®ï¼Œå¦‚ä½•ä¿è¯è¯»è€…çœ‹å¾—æ˜ç™½ä¸å¡é¡¿ç­‰ç­‰ï¼Œå•å•ç¬¬ä¸€ä¸ªç³»åˆ—çš„å‰ä¸¤éƒ¨å…± 8 ç¯‡æ–‡ç« ï¼Œå‰å‰åååå¤ç¢ç£¨å’Œä¿®æ”¹ï¼Œå±…ç„¶ç”¨äº†å››ä¸ªå¤šæœˆçš„æ—¶é—´ã€‚æˆ‘ä¸çŸ¥é“è¦å‡ å¹´æ—¶é—´æ‰èƒ½æŠŠæœ€åä¸€ç« å†™å®Œã€‚&lt;/p&gt;&lt;p&gt;è€Œå¦ä¸€æ–¹é¢ï¼Œè™½ç„¶ä»å®è§‚ä¸Šæ¥è¯´è®¡ç®—æœºç³»ç»ŸæŠ€æœ¯æ‰¿è½½ç€ç§‘å­¦æŠ€æœ¯çš„ä¼ æ‰¿å’Œåˆ›æ–°ï¼Œæ‰¿è½½è€…ç°ä»£å·¥ä¸šçš„åŸºç¡€ç­‰é‡è¦æ„ä¹‰ï¼Œä½†å¯¹äºä¸ªäººæ¥è¯´ï¼Œå´å¾ˆ &amp;ldquo;ç°å®åœ°&amp;rdquo; å‡ ä¹æ²¡æœ‰ä»»ä½•ç”¨å¤„ï¼ˆğŸ’°ï¼‰ï¼Œæ¯•ç«Ÿå‡ ä¹æ‰€æœ‰ä¼ä¸šéƒ½ä»äº‹åº”ç”¨å±‚é¢çš„å¼€å‘ï¼Œç³»ç»ŸæŠ€æœ¯æ— è®ºæ˜¯å¯¹æ™®é€šäººè¿˜æ˜¯å¯¹å¼€å‘äººå‘˜éƒ½å¤ªè¿‡é¥è¿œäº†ã€‚è™½ç„¶ä½œè€…å¾ˆåŠªåŠ›åœ°æƒ³å†™å¥½æ¯ä¸€ç¯‡æ–‡ç« ï¼Œä½†é˜…è¯»çš„äººæ˜¾ç„¶æ˜¯å¯¥å¯¥å¯æ•°çš„ï¼Œè¿™æ˜¯æå…¶å°‘æ•°äººæ‰ä¼šæ„Ÿå…´è¶£çš„å†…å®¹ã€‚å› æ­¤ï¼Œå¦‚æœä½ ç¢°å·§çœ‹åˆ°è¿™ä¸€ç³»åˆ—æ–‡ç« ï¼Œå¦‚æœè§‰å¾—æœ‰æ”¶è·ï¼Œè¯·æ¯«ä¸çŠ¹è±«åœ°æ‰“èµä½œè€…å§ ğŸ˜„ï¼ä½ çš„ä¸€ç“¶å¯ä¹ä¸€æ¯å†°çº¢èŒ¶çš„æ‰“èµå°±æ˜¯ä¸‹ä¸€ç¯‡æ–‡ç« çš„å†™ä½œåŠ¨åŠ› ğŸ˜­ã€‚&lt;/p&gt;&lt;div&gt;    &lt;img src=&#34;https://hemashushu.github.io/images/subscribe-and-donate.png&#34; class=&#34;block-image image-480px&#34;/&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œè™½ç„¶ç³»ç»ŸæŠ€æœ¯æ²¡æœ‰ç°å®ä¸Šçš„ç”¨å¤„ï¼Œä½†å®ƒå¯ä»¥å¾ˆå¥½åœ°æ»¡è¶³äººç±»åŸå§‹çš„ â€œå¥½å¥‡ã€æ¢ç´¢ã€åˆ›é€ â€ çš„æœ¬èƒ½ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œè¿˜æœ‰ä»€ä¹ˆæ¯” â€œç‹¬è‡ªä¸€äººå¾’æ‰‹å¾æœäººç±»æ–‡æ˜å²ä¸Šæœ€å¤æ‚çš„æœºå™¨â€ æ›´é…·çš„äº‹æƒ…å‘¢ï¼Ÿï¼å½“ä½ å®Œæˆæœ€åä¸€ç« æ—¶ï¼Œç›¸ä¿¡ä¼šçœ‹åˆ°ä¸€ä¸ªä¸åŒçš„ä¸–ç•Œã€‚ç‚¹å‡»ä¸‹é¢çš„ç›®å½•æ ‡é¢˜å¼€å§‹å¼‚ä¸–ç•Œä¹‹æ—…å§ï¼&lt;/p&gt;&lt;hr&gt;&lt;h2 id=&#34;ç›®å½•&#34;&gt;ç›®å½•&lt;/h2&gt;&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;note&lt;/strong&gt; æ­¤ç›®å½•ä¼šæŒç»­æ›´æ–°&amp;hellip;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;ç³»åˆ— 1: ä¸€æ­¥ä¸€æ­¥æ·±å…¥ RISC-V ç³»ç»Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;ç¬¬ä¸€éƒ¨ï¼šäº†è§£ç¼–è¯‘å™¨ã€é“¾æ¥å™¨ã€è°ƒè¯•å™¨ä»¥åŠä¸€äº›å¸¸ç”¨äºŒè¿›åˆ¶å·¥å…·çš„ä½¿ç”¨æ–¹æ³•ï¼Œäº†è§£ç¨‹åºçš„ç»„æˆï¼Œæ„å»ºæœ€å°ç‹¬ç«‹å¼å¯æ‰§è¡Œç¨‹åºï¼ˆfreestandingï¼Œä¹Ÿå« &lt;em&gt;è£¸æœºç¨‹åº&lt;/em&gt;ï¼‰ç­‰ï¼›&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;risc-v-gcc-quick-start/&#34;&gt;S01C01 RISC-V GCC å¿«é€Ÿå…¥é—¨&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;build-minimal-risc-v-program/&#34;&gt;S01C02 æ„å»ºæœ€å°çš„ RISC-V ç¨‹åº&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;qemu-and-debug/&#34;&gt;S01C03 QEMU æ¨¡æ‹Ÿå™¨åŠç¨‹åºçš„è°ƒè¯•&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ç¬¬äºŒéƒ¨ï¼šé€šè¿‡å¾®æ§åˆ¶å™¨ï¼ˆMCUï¼‰æ¥ç®€å•åœ°äº†è§£è½¯ä»¶å’Œç¡¬ä»¶ä¹‹é—´çš„äº¤äº’åŸç†ï¼Œé€šè¿‡ä¸ä½¿ç”¨ SDK æˆ–è€…ç¡¬ä»¶æŠ½è±¡åº“ï¼ˆHALï¼‰ï¼Œè€Œæ˜¯ç›´æ¥è¯»å†™å¯„å­˜å™¨çš„æ–¹å¼ç¼–å†™è£¸æœºç¨‹åºï¼ˆå›ºä»¶ï¼‰ï¼Œæ§åˆ¶ç”µä¿¡å·çš„è¾“å…¥è¾“å‡ºï¼ˆGPIOï¼‰ï¼Œå®ç°ä¸²å£é€šä¿¡ç­‰ï¼›&lt;/p&gt;&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ç¬¬ä¸‰éƒ¨ï¼šäº†è§£ç°ä»£ç³»ç»Ÿçš„ç¨‹åºåŠ è½½ã€åŠ¨æ€é“¾æ¥çš„åŸç†ï¼Œäº†è§£ RISC-V çš„å‡½æ•°è°ƒç”¨è§„ç¨‹ä»¥åŠåŸºæœ¬æŒ‡ä»¤ï¼Œä½¿ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™ç®€å•çš„ç¨‹åºï¼›&lt;/p&gt;&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ç¬¬å››éƒ¨ï¼šè®¾è®¡ä¸€é—¨ç›®æ ‡æ¶æ„ä¸º RISC-V çš„æ±‡ç¼–è¯­è¨€ï¼Œå®ç°å…¶æ±‡ç¼–å™¨ï¼ŒåŒæ—¶äº†è§£ç®€å•çš„è¯­æ³•è§£æå™¨çš„åŸç†ï¼›&lt;/p&gt;&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ç¬¬äº”éƒ¨ï¼šè®¾è®¡ä¸€é—¨é“¾æ¥è„šæœ¬è¯­è¨€ï¼Œå®ç°å…¶é“¾æ¥å™¨ï¼ŒåŒæ—¶äº†è§£è„šæœ¬è§£æå™¨çš„åŸç†ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;ç³»åˆ— 2: ä¸€æ­¥ä¸€æ­¥å®ç°ä¸€é—¨ç°ä»£è¯­è¨€åŠå…¶ç¼–è¯‘å™¨&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¬¬ä¸€éƒ¨ï¼šè®¾è®¡ä¸€é—¨ä¸­é—´è¯­è¨€ï¼ˆIRï¼‰ï¼Œå®ç°ä»ä¸­é—´è¯­è¨€åˆ°æ±‡ç¼–è¯­è¨€çš„ä»£ç ç”Ÿæˆå™¨ï¼ˆcode generatorï¼‰ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬äºŒéƒ¨ï¼šè®¾è®¡ä¸€é—¨ç°ä»£çš„é™æ€ç±»å‹çš„è¯­è¨€ï¼Œå®ç°é«˜çº§è¯­è¨€åˆ°ä¸­é—´è¯­è¨€çš„ä»£ç ç”Ÿæˆå™¨ï¼Œè‡³æ­¤å®Œæˆäº†ä¸€ä¸ª &lt;em&gt;ç®€å•çš„å®Œæ•´çš„ç¼–è¯‘ç³»ç»Ÿ&lt;/em&gt;ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬ä¸‰éƒ¨ï¼šå®ç° &lt;a href=&#34;https://webassembly.org/&#34;&gt;WASM&lt;/a&gt; è™šæ‹Ÿæœºï¼ˆVMï¼‰ï¼Œç„¶åå®ç°ä¸­é—´è¯­è¨€åˆ° WASM çš„ä»£ç ç”Ÿæˆå™¨ã€‚å®ç° WASM VM çš„åŒæ—¶å¯ä»¥å¤§è‡´åœ°è®¤è¯†ä¸€ä¸ªå¤„ç†å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¦ä¸€æ–¹é¢æœ‰äº† WASM ä»£ç ç”Ÿæˆå™¨ï¼Œæ„å‘³ç€æˆ‘ä»¬çš„è¯­è¨€èƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬å››éƒ¨ï¼šå®ç°ä¸­é—´è¯­è¨€åˆ° &lt;a href=&#34;https://llvm.org/docs/LangRef.html&#34;&gt;LLVM IR&lt;/a&gt; çš„ä»£ç ç”Ÿæˆå™¨ï¼Œè®©æˆ‘ä»¬çš„è¯­è¨€èƒ½ç”Ÿæˆç›®æ ‡æ¶æ„ä¸º &lt;code&gt;x86&lt;/code&gt; å’Œ &lt;code&gt;arm&lt;/code&gt; çš„ç¨‹åºã€‚&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬äº”éƒ¨ï¼šå®ç°é¡¹ç›®æ„å»ºå™¨åŠåŒ…ç®¡ç†å™¨ï¼Œè¿™æ˜¯ä»»ä½•ç°ä»£è¯­è¨€éƒ½å¿…å¤‡çš„ã€‚&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬å…­éƒ¨ï¼šç”¨å½“å‰è¯­è¨€é‡å†™ç¼–è¯‘å™¨ï¼Œå®ç°è¯­è¨€è‡ªæ‰˜ç®¡ï¼ˆself-hostingï¼‰ï¼Œå³ç¼–è¯‘å™¨å¯ä»¥ç¼–è¯‘è‡ªå·±çš„æºä»£ç ï¼Œä»æ­¤æˆ‘ä»¬å¼€å§‹ä½¿ç”¨è‡ªå·±çš„å·¥å…·æ¥æ„å»ºç³»ç»Ÿã€‚&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;ç³»åˆ— 3: ä¸€æ­¥ä¸€æ­¥å®ç°ä¸€ä¸ªå®ç”¨å‹çš„ RISC-V CPU&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¬¬ä¸€éƒ¨ï¼šè®¾è®¡ä¸€ä¸ªæœ€å°çš„æŒ‡ä»¤é›†ï¼Œå®ç°æ•°å­—ç´¯åŠ å’Œå†…å­˜åŠ è½½å’Œå­˜å‚¨åŠŸèƒ½ï¼›ç„¶åé€šè¿‡æ•°å­—ç”µè·¯ä»¿çœŸè½¯ä»¶å®ç°ä¸€ä¸ªæœ€ç®€å¤„ç†å™¨ï¼Œè¯¥å¤„ç†å™¨åŒ…å«äº† ROMã€RAMã€å¯„å­˜å™¨å †ï¼ˆregister fileï¼‰ã€è¯‘ç å™¨ã€æ§åˆ¶å™¨åŠç®—æœ¯é€»è¾‘å•å…ƒï¼ˆALUï¼‰ç­‰åŸºæœ¬å¤„ç†å™¨è¦ç´ ï¼Œèƒ½æ‰§è¡Œæˆ‘ä»¬çš„æŒ‡ä»¤é›†ã€‚é€šè¿‡è¿™ä¸€éƒ¨æ¥äº†è§£å¤„ç†å™¨çš„åŸºæœ¬è¿ä½œåŸç†ï¼Œä»¥åŠè½¯ä»¶å¦‚ä½•å˜æˆç”µä¿¡å·ã€‚&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬äºŒéƒ¨ï¼šä»æˆ‘ä»¬çš„è¯­è¨€æ´¾ç”Ÿå‡ºä¸€é—¨ HDL è¯­è¨€ï¼Œå®ç°è¯¥é—¨è¯­è¨€çš„æ•°å­—é€»è¾‘ç”µè·¯æ¨¡æ‹Ÿå™¨ä»¥åŠæµ‹è¯•ï¼ˆéªŒè¯ï¼‰æ¡†æ¶ï¼›å®ç°ä»è¿™é—¨è¯­è¨€åˆ° &lt;a href=&#34;https://en.wikipedia.org/wiki/SystemVerilog&#34;&gt;SystemVerilog&lt;/a&gt; çš„ä»£ç ç”Ÿæˆå™¨ï¼Œç„¶åç”¨è¿™é—¨è¯­è¨€é‡æ–°å®ç°ä¸Šä¸€éƒ¨çš„åŸºç¡€ç»„ä»¶ä»¥åŠå¤„ç†å™¨ï¼Œå¹¶ä¸‹è½½åˆ° FPGA ç¡¬ä»¶ä¸Šé€šç”µæµ‹è¯•ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬ä¸‰éƒ¨ï¼šä½¿ç”¨è‡ªå·±çš„ HDL è¯­è¨€å®ç°ä¸€ä¸ªå¤šæ—¶é’Ÿå‘¨æœŸçš„ RV64I å¤„ç†å™¨ï¼Œå¹¶ä¸‹è½½åˆ° FPGA ç¡¬ä»¶ä¸Šé€šç”µæµ‹è¯•ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬å››éƒ¨ï¼šå®ç°å¸¸è§çš„é€šä¿¡åè®®ï¼ˆæ¯”å¦‚ UARTã€$I^2C$ã€SPIï¼‰ï¼Œä¹¦å†™å¸¸è§çš„å¤–è®¾ï¼ˆæ¯”å¦‚ GPIO æ¥å£ã€SPI Flashã€SD å¡ã€SSD 1306 æ˜¾ç¤ºå±ç­‰ï¼‰çš„é©±åŠ¨ã€‚æ•´åˆæˆ‘ä»¬çš„å¤„ç†å™¨ï¼Œå®ç°ä¸€ä¸ªå®Œæ•´çš„ç¡¬ä»¶ç³»ç»Ÿï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬äº”éƒ¨ï¼šå°†å¤„ç†å™¨å¾®æ¶æ„å‡çº§ä¸ºå¤šçº§æµæ°´çº¿è®¾è®¡ã€‚&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;ç³»åˆ— 4: ä¸€æ­¥ä¸€æ­¥å®ç°ä¸€ä¸ªå®ç”¨çš„å¾®å†…æ ¸æ“ä½œç³»ç»Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¬¬ä¸€éƒ¨ï¼šä¸ºæˆ‘ä»¬çš„å¤„ç†å™¨æ·»åŠ å†…å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰ä»¥åŠç‰¹æƒç›¸å…³çš„æ¨¡å—ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬äºŒéƒ¨ï¼šå®ç°æœ€å°çš„å†…æ ¸ï¼Œå³å®ç°åŸºæœ¬çš„ä¸²å£è¾“å…¥è¾“å‡ºï¼Œå¤šçº§é¡µè¡¨ï¼Œå†…å­˜ç®¡ç†ï¼Œç¨‹åºçš„åŠ è½½åŠè¿›ç¨‹çš„ç®€å•åˆ†æ—¶åˆ‡æ¢ï¼Œä»¥åŠæ¶ˆæ¯æœºåˆ¶ç­‰ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬ä¸‰éƒ¨ï¼šå®ç°ç®€åŒ–ç‰ˆçš„ &lt;code&gt;ext4&lt;/code&gt; æ–‡ä»¶ç³»ç»Ÿï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬å››éƒ¨ï¼šå®ç°ç®€å•çš„ç”¨æˆ·äº¤äº’ç•Œé¢ï¼ˆshellï¼‰ä»¥åŠä¸€ä¸ªåŒ…ç®¡ç†å™¨ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬äº”éƒ¨ï¼šå®ç°ä¸€ä¸ªç®€å•çš„å›¾å½¢åŠ é€Ÿåå¤„ç†å™¨ï¼ˆcoprocessorï¼‰ï¼›&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ç¬¬å…­éƒ¨ï¼šå®ç°ä¸€ä¸ªç®€å•çš„å›¾å½¢åº“ï¼Œå®ç°ä¸€ä¸ªå¤å¤é£æ ¼çš„æ¨ªå‘å·è½´åŠ¨ä½œæ¸¸æˆã€‚&lt;ul&gt;&lt;li&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</description>
     </item>
   
     <item>
       <title></title>
       <link>https://hemashushu.github.io/posts/2022-11-06-risc-v-gcc-quick-start/readme/</link>
       <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
       
       <guid>https://hemashushu.github.io/posts/2022-11-06-risc-v-gcc-quick-start/readme/</guid>
       <description>&lt;h1 id=&#34;risc-v-gcc-quick-start&#34;&gt;RISC-V GCC Quick Start&lt;/h1&gt;</description>
     </item>
   
     <item>
       <title></title>
       <link>https://hemashushu.github.io/posts/2022-11-06-risc-v-gcc-quick-start/readme.zh-hans/</link>
       <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
       
       <guid>https://hemashushu.github.io/posts/2022-11-06-risc-v-gcc-quick-start/readme.zh-hans/</guid>
       <description>&lt;h1 id=&#34;risc-v-gcc-å¿«é€Ÿå…¥é—¨&#34;&gt;RISC-V GCC å¿«é€Ÿå…¥é—¨&lt;/h1&gt;&lt;p&gt;XiaoXuan Assembler éœ€è¦å…¶å®ƒç¼–è¯‘å™¨çš„ç¼–è¯‘ç»“æœä½œä¸ºå‚ç…§ç‰©ï¼Œè€Œ &lt;a href=&#34;https://github.com/riscv-collab/riscv-gnu-toolchain&#34;&gt;RISC-V GCC&lt;/a&gt; æ˜¯æ¯”è¾ƒå®Œå–„å’Œæˆç†Ÿçš„ RISC-V ç¼–è¯‘å™¨ï¼Œå› æ­¤ XiaoXuan Assembler é»˜è®¤é€‰ç”¨å®ƒå¯¹ç¼–è¯‘ã€æ±‡ç¼–å’Œé“¾æ¥çš„ç»“æœè¿›è¡Œå‚è€ƒã€éªŒè¯å’Œæµ‹è¯•ã€‚&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ–‡ç« å°†ä¼šæ„å»ºä¸¤ä¸ªéå¸¸ç®€å•çš„ç¨‹åºï¼šä¸€ä¸ª &amp;ldquo;Hello World!&amp;rdquo; ç¨‹åºå’Œä¸€ä¸ªè£¸æœºç¨‹åºï¼Œé€šè¿‡æ„å»ºçš„è¿‡ç¨‹ä»¥ç®€å•äº†è§£ RISC-V GCC çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚&lt;/p&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#risc-v-gcc-%E4%BB%8B%E7%BB%8D&#34;&gt;RISC-V GCC ä»‹ç»&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#qemu-%E6%A8%A1%E6%8B%9F%E5%99%A8&#34;&gt;QEMU æ¨¡æ‹Ÿå™¨&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F&#34;&gt;ç¬¬ä¸€ä¸ªç¨‹åº&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E7%BC%96%E8%AF%91&#34;&gt;ç¼–è¯‘&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%B7%A5%E5%85%B7&#34;&gt;äºŒè¿›åˆ¶å·¥å…·&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#size&#34;&gt;&lt;code&gt;size&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#readelf&#34;&gt;&lt;code&gt;readelf&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#objdump&#34;&gt;&lt;code&gt;objdump&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%BF%90%E8%A1%8C&#34;&gt;è¿è¡Œ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%88%86%E9%98%B6%E6%AE%B5%E7%BC%96%E8%AF%91&#34;&gt;åˆ†é˜¶æ®µç¼–è¯‘&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BC%96%E8%AF%91%E5%8F%82%E6%95%B0&#34;&gt;å¸¸ç”¨çš„ç¼–è¯‘å‚æ•°&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%A3%B8%E6%9C%BA%E7%A8%8B%E5%BA%8F&#34;&gt;è£¸æœºç¨‹åº&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%BB%84%E6%88%90&#34;&gt;ç¨‹åºçš„ç»„æˆ&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E5%9F%BA%E7%A1%80%E5%BA%93&#34;&gt;åŸºç¡€åº“&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%AE%A1%E7%AE%97%E5%BA%93&#34;&gt;è®¡ç®—åº“&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E4%B8%BB%E7%A8%8B%E5%BA%8F&#34;&gt;ä¸»ç¨‹åº&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%90%AF%E5%8A%A8%E5%99%A8&#34;&gt;å¯åŠ¨å™¨&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%BC%96%E8%AF%91-1&#34;&gt;ç¼–è¯‘&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%89%93%E5%8C%85%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6&#34;&gt;æ‰“åŒ…ç›®æ ‡æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E9%93%BE%E6%8E%A5&#34;&gt;é“¾æ¥&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%BF%90%E8%A1%8C-1&#34;&gt;è¿è¡Œ&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;!-- raw HTML omitted --&gt;&lt;h2 id=&#34;risc-v-gcc-ä»‹ç»&#34;&gt;RISC-V GCC ä»‹ç»&lt;/h2&gt;&lt;p&gt;å‡è®¾æˆ‘ä»¬å·¥ä½œç¯å¢ƒçš„æ¶æ„æ˜¯ &lt;em&gt;x86_64&lt;/em&gt;ï¼Œç°åœ¨éœ€è¦æŠŠç¨‹åºï¼ˆçš„æºä»£ç ï¼‰ç¼–è¯‘æˆå¯ä»¥åœ¨ RISC-V æ¶æ„ä¸Šè¿è¡Œçš„ç¨‹åºï¼Œè¿™ç§ç¼–è¯‘å«åš &lt;em&gt;äº¤å‰ç¼–è¯‘&lt;/em&gt;ã€‚ç›¸å¯¹åœ°ï¼Œåœ¨ â€œå½“å‰æ¶æ„â€ é‡Œç¼–è¯‘å‡ºç»™ &amp;ldquo;å½“å‰æ¶æ„&amp;rdquo; è¿è¡Œçš„ç¨‹åºï¼Œè¿™ç§ç¼–è¯‘å« &lt;em&gt;æœ¬åœ°ç¼–è¯‘&lt;/em&gt;ï¼Œæˆ–è€…ç®€ç§°ç¼–è¯‘ã€‚äº¤å‰ç¼–è¯‘æœ¬è´¨ä¸Šæ˜¯ &amp;ldquo;æ ¹æ®æºä»£ç ç”Ÿæˆç›®æ ‡æ¶æ„çš„ä¸€ç³»åˆ—æŒ‡ä»¤&amp;rdquo;ï¼Œäº¤å‰ç¼–è¯‘å™¨åœ¨çš„å®ç°æ–¹æ³•è·Ÿæ™®é€šçš„ç¼–è¯‘å™¨æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç”Ÿæˆçš„æŒ‡ä»¤ä¸æ˜¯å½“å‰æ¶æ„ï¼Œè€Œæ˜¯ç›®æ ‡æ¶æ„çš„æŒ‡ä»¤ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¿›è¡Œäº¤å‰ç¼–è¯‘æ—¶ï¼Œé€šå¸¸éœ€è¦ç¡®å®š &lt;em&gt;ç›®æ ‡æ¶æ„&lt;/em&gt; å’Œ &lt;em&gt;ç›®æ ‡å¹³å°&lt;/em&gt;ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;ç›®æ ‡æ¶æ„&lt;/em&gt; æ˜¯æŒ‡ç›®æ ‡æœºå™¨çš„ CPU æŒ‡ä»¤é›†æ¶æ„ï¼ˆISAï¼Œæœ‰æ—¶ç®€ç§°ä¸º &lt;em&gt;æŒ‡ä»¤é›†&lt;/em&gt; ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ï¼Œæ¯”å¦‚å¸¸ç”¨çš„ Intel å’Œ AMD CPU çš„æŒ‡ä»¤é›†æ˜¯ &lt;em&gt;x86_64&lt;/em&gt;ï¼Œç§»åŠ¨ç”µè¯ç”¨çš„ ARM CPU æŒ‡ä»¤é›†æ˜¯ &lt;em&gt;aarch64&lt;/em&gt;ï¼Œä»¥åŠé¡¹ç›® XiaoXuan Assembly - RISCV çš„ç›®æ ‡ CPU çš„æŒ‡ä»¤é›†æ˜¯ &lt;em&gt;rv64g&lt;/em&gt; ç­‰ç­‰ã€‚&lt;/li&gt;&lt;li&gt;&lt;em&gt;ç›®æ ‡å¹³å°&lt;/em&gt; æ˜¯æŒ‡ &lt;em&gt;ç›®æ ‡æ“ä½œç³»ç»Ÿ&lt;/em&gt;ï¼Œå½“ç„¶åœ¨å¼€å‘ç¨‹åºæ—¶ï¼Œå¯èƒ½è¿˜å¾—è€ƒè™‘ç›®æ ‡å¹³å°æ›´ç»†åŒ–çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ç›®æ ‡å¹³å°æ˜¯å“ªä¸ª Linux å‘è¡Œç‰ˆï¼Œå› ä¸ºä¸åŒçš„å‘è¡Œç‰ˆçš„æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„ï¼ˆFHSï¼ŒFilesystem Hierarchy Standardï¼‰å¾€å¾€æœ‰ç»†å¾®çš„å·®åˆ«ï¼Œè¿™ä¼šå¯¼è‡´è¯¸å¦‚å…±äº«åº“ç­‰æ–‡ä»¶çš„æ‰€åœ¨ä½ç½®æœ‰æ‰€ä¸åŒã€‚ä½†å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œå®ƒåªéœ€ç¡®å®šç›®æ ‡æ¶æ„å’Œç›®æ ‡å¹³å°å³å¯ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¹äº &lt;em&gt;è£¸æœºç¨‹åº&lt;/em&gt;ï¼Œå³åœ¨ &amp;ldquo;æ— æ“ä½œç³»ç»Ÿ&amp;rdquo; çš„ç¯å¢ƒé‡Œè¿è¡Œçš„ç¨‹åºï¼Œæ¯”å¦‚åœ¨å¾®æ§åˆ¶å™¨ï¼ˆMCUï¼‰é‡Œè¿è¡Œçš„ç¨‹åºï¼Œæˆ–è€…å†…æ ¸ç¨‹åºï¼Œåœ¨ç¼–è¯‘æ—¶åˆ™åªéœ€ç¡®è®¤ &lt;em&gt;ç›®æ ‡æ¶æ„&lt;/em&gt; å³å¯ã€‚&lt;/p&gt;&lt;p&gt;GCC æ˜¯ä¸€å¥—å¸¸ç”¨ç¼–è¯‘å·¥å…·ï¼ˆå¦ä¸€ä¸ªæ˜¯ LLVMï¼‰ï¼Œè€Œ RISC-V GCC åˆ™æ˜¯åŸºäº GCC ä¸”ç›®æ ‡æ¶æ„è®¾å®šä¸º RISC-V çš„äº¤å‰ç¼–è¯‘å·¥å…·ã€‚åœ¨å¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆé‡Œéƒ½å¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨æ‰¾åˆ°å®ƒå¹¶å®‰è£…å®ƒã€‚æ³¨æ„åœ¨é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£… RISC-V GCC çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‘ç°æœ‰ä¸¤å¥—åç§°ç›¸è¿‘çš„å·¥å…·ï¼Œæ¯”å¦‚åœ¨ &lt;em&gt;Arch Linux&lt;/em&gt; é‡Œï¼Œæœ‰ &lt;code&gt;riscv64-elf-gcc&lt;/code&gt;ã€&lt;code&gt;riscv64-elf-gdb&lt;/code&gt;ã€&lt;code&gt;riscv64-elf-binutils&lt;/code&gt; å’Œ &lt;code&gt;riscv64-linux-gnu-gcc&lt;/code&gt;ã€&lt;code&gt;riscv64-linux-gnu-gdb&lt;/code&gt;ã€&lt;code&gt;riscv64-linux-gnu-binutils&lt;/code&gt;ï¼ˆåœ¨ &lt;em&gt;Ubuntu&lt;/em&gt; é‡Œï¼Œå®ƒä»¬åˆ†åˆ«å« &lt;code&gt;gcc-riscv64-unknown-elf&lt;/code&gt;ã€&lt;code&gt;gcc-riscv64-linux-gnu&lt;/code&gt; å’Œ &lt;code&gt;gdb-multiarch&lt;/code&gt;ï¼‰ã€‚å‰è€…ç”¨äºç¼–è¯‘ &amp;ldquo;è£¸æœº&amp;rdquo; ç¨‹åºï¼Œåè€…ç”¨äºç¼–è¯‘åœ¨ Linux ç¯å¢ƒä¸­è¿è¡Œçš„ç¨‹åºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸æ‰€æ¥è§¦åˆ°çš„ç¨‹åºã€‚æ¡ä»¶å…è®¸çš„è¯ï¼Œå»ºè®®ä¸¤å¥—å·¥å…·éƒ½å®‰è£…ã€‚å¦‚æœä½ ç³»ç»Ÿçš„åŒ…ä»“åº“é‡Œæ²¡æœ‰ RISC-V GCCï¼Œåˆ™å¯ä»¥ä» &lt;a href=&#34;https://github.com/riscv-collab/riscv-gcc&#34;&gt;å®˜æ–¹çš„ä»“åº“&lt;/a&gt; ä¸‹è½½æºç å¹¶é€šè¿‡æºç çš„æ–¹å¼å®‰è£…ã€‚&lt;/p&gt;&lt;h2 id=&#34;qemu-æ¨¡æ‹Ÿå™¨&#34;&gt;QEMU æ¨¡æ‹Ÿå™¨&lt;/h2&gt;&lt;p&gt;å¯¹äº RISC-V GCC ç”Ÿæˆçš„ç¨‹åºï¼Œå½“ç„¶éœ€è¦åœ¨ RISC-V æ¶æ„çš„æœºå™¨ä¸Šè¿è¡Œï¼Œä¸è¿‡è‡³ä¹¦å†™æœ¬æ–‡çš„æ—¶é—´ï¼ˆ2022 å¹´ï¼‰ä¸ºæ­¢ï¼Œå°šæœªæœ‰æˆç†Ÿä¸”ç»æµçš„ RISC-V ç¡¬ä»¶ï¼Œå¤§éƒ¨åˆ† RISC-V è®¡ç®—æœºä»ä»¥å¼€å‘æ¿çš„å½¢å¼æä¾›ã€‚æ‰€ä»¥ä¸ºäº†ä¾¿äºæµ‹è¯•ç¨‹åºï¼ŒXiaoXuan Assembler æ˜¯é€šè¿‡ &lt;a href=&#34;https://www.qemu.org/&#34;&gt;QEMU&lt;/a&gt; æ¨¡æ‹Ÿå™¨æ¥è¿è¡Œå’Œæµ‹è¯• RISC-V ç¨‹åºçš„ã€‚&lt;/p&gt;&lt;p&gt;å¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆé‡Œçš„åŒ…ä»“åº“é‡Œéƒ½åŒ…å«æœ‰ QEMUï¼Œæ‰€ä»¥åªéœ€ä½¿ç”¨ç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨å°±å¯ä»¥å®‰è£… QEMUï¼Œæ¯”å¦‚åœ¨ &lt;em&gt;Arch Linux&lt;/em&gt; é‡Œï¼Œéœ€è¦å®‰è£…åŒ… &lt;code&gt;qemu-system-riscv&lt;/code&gt;ã€&lt;code&gt;qemu-user&lt;/code&gt; å’Œ &lt;code&gt;qemu-user-static&lt;/code&gt;ï¼ˆåœ¨ &lt;em&gt;Ubuntu&lt;/em&gt; é‡Œï¼ŒåŒ…ååˆ†åˆ«ä¸º &lt;code&gt;qemu-system&lt;/code&gt;ï¼Œ&lt;code&gt;qemu-user&lt;/code&gt; å’Œ &lt;code&gt;qemu-user-static&lt;/code&gt;ï¼‰ã€‚å¯¹äºåŒ…ä»“åº“é‡Œæ²¡æœ‰ QEMU çš„å‘è¡Œç‰ˆï¼Œå¯ä»¥ä¸‹è½½ QEMU çš„æºç ï¼Œç„¶åæ ¹æ®&lt;a href=&#34;https://wiki.qemu.org/Documentation/Platforms/RISCV&#34;&gt;è¿™ç¯‡æŒ‡å¼•&lt;/a&gt;ç¼–è¯‘å®‰è£…ã€‚&lt;/p&gt;&lt;p&gt;QEMU å¯ä»¥æ¨¡æ‹Ÿä¸€æ•´å¥—å®Œæ•´çš„ç¡¬ä»¶ï¼ŒåŒ…æ‹¬ CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œæ¥å£ã€USB æ¥å£ç­‰ç»„ä»¶ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒQEMU è¿˜å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ª Linux ç³»ç»Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒQEMU æœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼Œå‰è€…ç§°ä¸º &lt;em&gt;å…¨ç³»ç»Ÿæ¨¡å¼&lt;/em&gt;ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹å¯ä»¥æ‰§è¡Œæ‰€æœ‰ CPU æŒ‡ä»¤ï¼Œå¯ä»¥è¿è¡Œè£¸æœºç¨‹åºã€‚åè€…ç§°ä¸º &lt;em&gt;ç”¨æˆ·æ¨¡å¼&lt;/em&gt;ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œç¼–è¯‘ç›®æ ‡å¹³å°ä¸º Linux çš„ç¨‹åºã€‚&lt;/p&gt;&lt;p&gt;å…¨ç³»ç»Ÿæ¨¡å¼ä½¿ç”¨ç¨‹åº &lt;code&gt;qemu-system-riscv64&lt;/code&gt; æ¥å¯åŠ¨ï¼Œå¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šæœºå™¨ç±»å‹ã€CPU æ ¸å¿ƒçš„æ•°é‡ã€å†…å­˜çš„å®¹é‡ã€è™šæ‹Ÿç£ç›˜ç­‰ã€‚ç”¨æˆ·æ¨¡å¼ä½¿ç”¨ç¨‹åº &lt;code&gt;qemu-riscv64&lt;/code&gt; æ¥å¯åŠ¨ï¼ŒæŠŠæˆ‘ä»¬å†™çš„åº”ç”¨ç¨‹åºï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„æ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ä¼ ç»™è¿™ä¸ªç¨‹åºå³å¯ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒQEMU ä¼šæŠŠåº”ç”¨ç¨‹åºè½¬æ¢ä¸ºä¸»æœºå¹³å°æ”¯æŒçš„ç¨‹åºï¼Œæ‰€ä»¥å¦‚æœè¦å†™äº†ä¸€ä¸ªå‘æ§åˆ¶å°æ‰“å°ä¸€è¡Œå­—ç¬¦çš„ &amp;ldquo;Hello world&amp;rdquo; ç¨‹åºï¼Œè®©å®ƒè·‘èµ·æ¥çš„æœ€å¿«æ–¹æ³•æ˜¯ä½¿ç”¨ &lt;code&gt;riscv64-linux-gnu-gcc&lt;/code&gt; ç¼–è¯‘ï¼Œç„¶åä½¿ç”¨ &lt;code&gt;qemu-riscv64&lt;/code&gt; æ¥è¿è¡Œã€‚&lt;/p&gt;&lt;h2 id=&#34;ç¬¬ä¸€ä¸ªç¨‹åº&#34;&gt;ç¬¬ä¸€ä¸ªç¨‹åº&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€ä¸ªç¨‹åºæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¨‹åºï¼Œå…¶åŠŸèƒ½æ˜¯å‘å±å¹•æ‰“å°ä¸€è¡Œæ–‡å­— &amp;ldquo;Hello world!&amp;quot;ã€‚ä¸‹é¢å¿«é€Ÿåœ°è¿‡ä¸€éç¼–è¯‘ã€é“¾æ¥ã€è¿è¡Œçš„è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;ç¬¬ä¸€ä¸ªç¨‹åºçš„æºä»£ç æ–‡ä»¶ä½äºç›®å½• &lt;a href=&#34;./resources/hello-world/&#34;&gt;resources/hello-world&lt;/a&gt; é‡Œï¼Œæ–‡ä»¶åä¸º &lt;code&gt;app.c&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello world!&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç¼–è¯‘&#34;&gt;ç¼–è¯‘&lt;/h3&gt;&lt;p&gt;é¦–å…ˆåˆ‡æ¢åˆ°æ–‡æœ¬æ‰€åœ¨çš„ç›®å½•çš„å­ç›®å½• &lt;a href=&#34;./resources/hello-world/&#34;&gt;resources/hello-world&lt;/a&gt;ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ cd resources/hello-world&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å› ä¸ºè¿™ä¸æ˜¯ &amp;ldquo;è£¸æœº&amp;rdquo; ç¨‹åºï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ &lt;code&gt;riscv64-linux-gnu-gcc&lt;/code&gt; æ¥ç¼–è¯‘ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -g -Wall -o app.out app.c&lt;/code&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-g&lt;/code&gt; ç”¨äºç”Ÿæˆé¢å¤–çš„è°ƒè¯•ä¿¡æ¯ï¼ˆå¯ä¾› GDB ä½¿ç”¨ï¼‰ï¼›&lt;/li&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-Wall&lt;/code&gt; ç”¨äºæŠ¥å‘Šç¼–è¯‘è¿‡ç¨‹ä¸­çš„æ‰€æœ‰è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ï¼›&lt;/li&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-o app.out&lt;/code&gt; ç”¨äºæŒ‡å®šè¾“å‡ºçš„æ–‡ä»¶çš„åç§°ï¼Œå¦‚æœç¼ºçœè¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤çš„è¾“å‡ºæ–‡ä»¶åä¸º &lt;code&gt;a.out&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç¼–è¯‘å®Œæˆåå¾—åˆ°æ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶&lt;/h3&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;file&lt;/code&gt; å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æ ¼å¼ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ file app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app.out: ELF 64-bit LSB pie executable, UCB RISC-V, RVC, double-float ABI, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-riscv64-lp64d.so.1, BuildID[sha1]=eb3dabb395852de771d6ac7129d1da24ca574350, for GNU/Linux 4.15.0, with debug_info, not stripped&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;ELF&lt;/code&gt; å’Œ &lt;code&gt;executable&lt;/code&gt;ï¼Œè¡¨æ˜å½“å‰æ–‡ä»¶æ˜¯ä¸€ä¸ª ELF æ ¼å¼å½“ä¸­çš„ &lt;em&gt;å¯æ‰§è¡Œæ–‡ä»¶&lt;/em&gt;ã€‚ELF æ ¼å¼çš„æ–‡ä»¶ä¸»è¦æœ‰ 3 ç§ç±»å‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;executable&lt;/code&gt; æ˜¯ &lt;em&gt;å¯æ‰§è¡Œæ–‡ä»¶&lt;/em&gt;ï¼›&lt;/li&gt;&lt;li&gt;&lt;code&gt;shared object&lt;/code&gt; æ˜¯ &lt;em&gt;å…±äº«å¯¹è±¡æ–‡ä»¶&lt;/em&gt;ï¼Œä¹Ÿå°±æ˜¯å…±äº«åº“ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è¢«å¯æ‰§è¡Œæ–‡ä»¶é“¾æ¥ï¼ˆæˆ–è€…è¯´ &lt;em&gt;è°ƒç”¨&lt;/em&gt;ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;relocatable&lt;/code&gt; æ˜¯ &lt;em&gt;å¯é‡å®šå‘æ–‡ä»¶&lt;/em&gt;ï¼Œå³ç¼–è¯‘ä»»åŠ¡ä¸­é€”äº§ç”Ÿçš„ &lt;em&gt;ç›®æ ‡æ–‡ä»¶&lt;/em&gt;ï¼Œå½“åªç¼–è¯‘è€Œä¸é“¾æ¥ä¸€ä¸ª C æºä»£ç æ–‡ä»¶æ—¶ï¼Œäº§ç”Ÿçš„æ­£æ˜¯è¿™ç§ç±»å‹çš„æ–‡ä»¶ã€‚è¿™ç§ &amp;ldquo;ä¸­é—´é˜¶æ®µäº§ç”Ÿ&amp;rdquo; çš„æ–‡ä»¶ä¸»è¦ç”¨æ¥é“¾æ¥ï¼Œä»¥äº§ç”Ÿæœ€åçš„ç»“æœ â€”â€”â€”â€” å¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…å…±äº«åº“ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;dynamically linked&lt;/code&gt;, &lt;code&gt;interpreter ...&lt;/code&gt;ï¼Œè¡¨æ˜å½“å‰å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ &lt;em&gt;åŠ¨æ€é“¾æ¥&lt;/em&gt; ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåœ¨è¿è¡Œæ—¶ï¼Œè¦éœ€è¦å…¶å®ƒå…±äº«åº“çš„å¸®å¿™æ‰èƒ½å®Œæˆæ‰€æœ‰å·¥ä½œã€‚è€Œè¿™äº›åº“çš„åŠ è½½ä»»åŠ¡åˆ™ç”± &lt;code&gt;interpreter&lt;/code&gt; æŒ‡å®šçš„ç¨‹åºæ¥å®Œæˆï¼Œæˆ–è€…è¯´ &lt;code&gt;interpreter&lt;/code&gt; æŒ‡å®šçš„æ˜¯ä¸€ä¸ª &lt;em&gt;è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥å™¨&lt;/em&gt;ï¼Œæˆ–è€…ç®€å•ç†è§£ä¸º &lt;em&gt;åº”ç”¨ç¨‹åºåˆå§‹åŒ–å™¨ï¼Œå…±äº«åº“åŠ è½½å™¨&lt;/em&gt;ã€‚å¯æ‰§è¡Œæ–‡ä»¶è¿˜å¯ä»¥æ˜¯ &lt;em&gt;é™æ€é“¾æ¥&lt;/em&gt; ç±»å‹ï¼Œè¡¨ç¤ºå®ƒåœ¨è¿è¡Œæ—¶ä¸éœ€è¦å…¶å®ƒå…±äº«åº“å¸®å¿™ï¼Œåªéœ€æ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼Œå…¶å®ƒçš„å·¥ä½œå…¨éƒ¨è‡ªå·±å®Œæˆã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;pie&lt;/code&gt;ï¼Œè¡¨æ˜å½“å‰çš„å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ &lt;code&gt;ä½ç½®æ— å…³çš„å¯æ‰§è¡Œæ–‡ä»¶&lt;/code&gt;ï¼ˆ&lt;code&gt;Position Independent Executables&lt;/code&gt;ï¼‰ï¼Œè¿™éƒ¨åˆ†å†…å®¹å°†ä¼šåœ¨æœ¬é¡¹ç›®çš„å…¶å®ƒæ–‡ç« é‡Œè®²è§£ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;64-bit&lt;/code&gt;, &lt;code&gt;RISC-V&lt;/code&gt;, &lt;code&gt;double-float ABI&lt;/code&gt;ï¼Œ&lt;code&gt;GNU/Linux 4.15.0&lt;/code&gt;ï¼Œè¿™äº›é›¶æ•£çš„ä¿¡æ¯è¡¨æ˜å½“å‰å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®æ ‡æ¶æ„ã€ç›®æ ‡å¹³å°ä»¥åŠç›®æ ‡å¹³å°çš„ä¸€äº›ç»†åŒ–ä¿¡æ¯ï¼Œè¿™äº›å†…å®¹å°†ä¼šåœ¨æœ¬é¡¹ç›®çš„å…¶å®ƒæ–‡ç« é‡Œè®²è§£ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;LSB&lt;/code&gt;ï¼Œè¡¨æ˜å½“å‰å¯æ‰§è¡Œæ–‡ä»¶é‡Œçš„æ•°æ®æ˜¯ &amp;ldquo;ä½ç«¯å­—èŠ‚ä¼˜å…ˆ&amp;rdquo;ï¼ˆ&amp;ldquo;least-significant byte first&amp;rdquo;ï¼‰çš„ï¼Œç›¸å½“äºå¹³å¸¸è¯´çš„ &amp;ldquo;ä½ç«¯åº&amp;rdquo;ï¼ˆ&amp;ldquo;little-endian&amp;rdquo;ï¼‰ã€‚ç›¸å¯¹çš„ï¼Œè¿˜æœ‰ &lt;code&gt;MSB&lt;/code&gt;ï¼Œå³ &amp;ldquo;é«˜ç«¯å­—èŠ‚ä¼˜å…ˆ&amp;rdquo;ï¼ˆ&amp;ldquo;most-significant byte&amp;rdquo;ï¼‰ï¼Œç›¸å½“äº &amp;ldquo;é«˜ç«¯åº&amp;rdquo;ï¼ˆ&amp;ldquo;big-endian&amp;rdquo;ï¼‰ã€‚è¿™å†³å®šäº†ä¸€ä¸ªæ•´æ•°åœ¨å†…å­˜æˆ–è€…ç£ç›˜ç§å¦‚ä½•å‚¨å­˜ï¼Œæ¯”å¦‚æ•°å­— &lt;code&gt;0x11223344&lt;/code&gt;ï¼Œåœ¨å†…å­˜ä¸­å¦‚æœä½¿ç”¨ &lt;code&gt;LSB&lt;/code&gt;ï¼Œåˆ™è¢«å‚¨å­˜ä¸º &amp;ldquo;(ä½åœ°å€) 44 33 22 11 ï¼ˆé«˜åœ°å€ï¼‰&amp;quot;ï¼Œå¦‚æœä½¿ç”¨ &lt;code&gt;MSB&lt;/code&gt;ï¼Œåˆ™ä¼šè¢«å‚¨å­˜ä¸º &amp;ldquo;(ä½åœ°å€) 11 22 33 44ï¼ˆé«˜åœ°å€ï¼‰&amp;quot;ã€‚ç”¨åå…­è¿›åˆ¶æŸ¥çœ‹å™¨æŸ¥çœ‹ &lt;code&gt;LSB&lt;/code&gt; ç±»å‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å®¹æ—¶ï¼Œå¦‚æœçœ‹çš„å†…å®¹æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆéœ€è¦åœ¨è„‘æµ·é‡ŒæŠŠæ•°å­—åè¿‡æ¥å†ç»„åˆæ‰æ˜¯å®ƒçš„çœŸå®å€¼ï¼Œè€Œå¦‚æœçœ‹çš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥å¾ˆè‡ªç„¶åœ°é¡ºåºé˜…è¯»ã€‚ç®€å•æ¥è¯´ï¼Œçœ‹æ•°å­—å¾ˆå¤´ç—›ï¼Œçœ‹æ–‡æœ¬å¾ˆèˆ’ç•…ï¼Œè€Œ &lt;code&gt;MSB&lt;/code&gt; åˆ™åˆšå¥½ç›¸åã€‚ä¸è¿‡è¿™éƒ½æ˜¯äººç±»æ‰æœ‰çš„çƒ¦æ¼ï¼Œå¯¹äºè®¡ç®—æœºæ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„å“¦ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;with debug_info&lt;/code&gt;, &lt;code&gt;not stripped&lt;/code&gt;ï¼Œè¡¨æ˜å½“å‰å¯æ‰§è¡Œæ–‡ä»¶é‡ŒåŒ…å«è°ƒè¯•ä¿¡æ¯ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;file&lt;/code&gt; å‘½ä»¤åªèƒ½éå¸¸ç²—ç•¥åœ°æŸ¥çœ‹æ–‡ä»¶çš„æ ¼å¼å’Œç±»å‹ï¼Œå¦‚æœæƒ³è¯¦ç»†äº†è§£ &lt;code&gt;ELF&lt;/code&gt; çš„å†…å®¹ï¼Œè¿˜éœ€è¦ä¸‹é¢çš„äºŒè¿›åˆ¶å·¥å…·ã€‚&lt;/p&gt;&lt;h3 id=&#34;äºŒè¿›åˆ¶å·¥å…·&#34;&gt;äºŒè¿›åˆ¶å·¥å…·&lt;/h3&gt;&lt;p&gt;åœ¨å®‰è£… RISC-V GCC æ—¶ï¼Œè¿˜åŒæ—¶å®‰è£…äº† RISC-V Binutilsï¼Œè¿™å¥—å·¥å…·é“¾æä¾›äº†è·Ÿ &lt;a href=&#34;https://www.gnu.org/software/binutils/&#34;&gt;GNU Binutils&lt;/a&gt; å¯¹åº”çš„å·¥å…·ã€‚&lt;/p&gt;&lt;h4 id=&#34;size&#34;&gt;&lt;code&gt;size&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;é¦–å…ˆæ˜¯æŸ¥çœ‹ç¨‹åºå¤§å°çš„å·¥å…· &lt;code&gt;size&lt;/code&gt;ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-size app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   text    data     bss     dec     hex filename&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   1123     584       8    1715     6b3 app.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;text&lt;/code&gt; è¡¨ç¤ºç¨‹åºçš„æŒ‡ä»¤åºåˆ—ï¼›&lt;/li&gt;&lt;li&gt;&lt;code&gt;data&lt;/code&gt; è¡¨ç¤ºç¨‹åºçš„åˆå§‹æ•°æ®ï¼›&lt;/li&gt;&lt;li&gt;&lt;code&gt;bss&lt;/code&gt; è¡¨ç¤ºæœªåˆå§‹åŒ–çš„ï¼ˆæˆ–è€…åˆå§‹å€¼ä¸º &lt;code&gt;0&lt;/code&gt; çš„ï¼‰å…¨å±€å˜é‡ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;dec&lt;/code&gt; å’Œ &lt;code&gt;hex&lt;/code&gt; æ˜¯å‰é¢ä¸‰é¡¹å†…å®¹çš„å¤§å°ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼‰çš„æ€»å’Œçš„åè¿›åˆ¶å’Œåå…­è¿›åˆ¶ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ &lt;code&gt;bss&lt;/code&gt; çš„æ•°å€¼ç”¨äºåœ¨å†…å­˜é‡Œæå‰åˆ†é…ç©ºé—´ï¼Œé™¤äº†ä¸€ä¸ªæ•´æ•°ä¹‹å¤–ï¼Œæœ¬èº«ä¸å æ–‡ä»¶ä»»ä½•ç©ºé—´ï¼Œä½†åœ¨ç»Ÿè®¡æ—¶ï¼Œä»ç„¶æŠŠå®ƒä¹ŸåŠ ä¸Šäº†ã€‚&lt;/p&gt;&lt;p&gt;æ ¹æ®ä¸Šé¢æ˜¾ç¤ºçš„æ•°å€¼å¯çŸ¥ï¼Œç¼–è¯‘å™¨åœ¨æˆ‘ä»¬å†™çš„åº”ç”¨ç¨‹åºé‡Œå¡å…¥äº†ä¸å°‘çš„é¢å¤–çš„å†…å®¹ï¼Œæ¯•ç«Ÿå½“å‰ç¨‹åºåªæœ‰ä¸€ä¸ªåªåŒ…å«ä¸€æ¡ &lt;code&gt;printf&lt;/code&gt; è¯­å¥çš„å‡½æ•°ï¼Œè¿™æ ·çš„ä¸€æ¡è¯­å¥ä¸å¤ªå¯èƒ½å¯¹åº” 1000 å¤šä¸ªå­—èŠ‚çš„æŒ‡ä»¤ï¼Œè€Œä¸”æ–‡æœ¬å†…å®¹ &amp;ldquo;Hello world!\n&amp;rdquo; ä¹Ÿæ²¡æœ‰ 500 å¤šå­—èŠ‚ã€‚&lt;/p&gt;&lt;h4 id=&#34;readelf&#34;&gt;&lt;code&gt;readelf&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;å·¥å…· &lt;code&gt;readelf&lt;/code&gt; å¯ä»¥æŸ¥çœ‹è¯¥ ELF æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-readelf -l app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ï¼ˆéƒ¨åˆ†ï¼‰ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Elf file type is DYN (Position-Independent Executable file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Entry point 0x5b0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;There are 10 program headers, starting at offset 64&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Program Headers:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Type           Offset             VirtAddr           PhysAddr&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 FileSiz            MemSiz              Flags  Align&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  LOAD           0x0000000000000000 0x0000000000000000 0x0000000000000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 0x00000000000006e4 0x00000000000006e4  R E    0x1000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  LOAD           0x0000000000000e08 0x0000000000001e08 0x0000000000001e08&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 0x0000000000000248 0x0000000000000250  RW     0x1000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Section to Segment mapping:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Segment Sections...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   03     .interp .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .plt .text .rodata .eh_frame_hdr .eh_frame&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   04     .preinit_array .init_array .fini_array .dynamic .data .got .bss&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹é¢ç®€å•è®²è§£ä¸Šé¢çš„å†…å®¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;LOAD&lt;/code&gt; è¡¨ç¤ºå°†ä¼šè¢«åŠ è½½è¿›å†…å­˜çš„ segmentï¼ˆå› ä¸º &lt;code&gt;segment&lt;/code&gt; å’Œ &lt;code&gt;section&lt;/code&gt; åœ¨ä¸­æ–‡é‡Œéƒ½å«ä½œ &lt;code&gt;æ®µ&lt;/code&gt;ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨è‹±æ–‡åç§°ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ &lt;code&gt;æ®µ&lt;/code&gt; æ˜¯æŒ‡ &lt;code&gt;section&lt;/code&gt;ï¼‰ï¼Œä¸‹æ–¹çš„ &lt;code&gt;Section to Segment mapping&lt;/code&gt; åˆ—ä¸¾äº†æ¯ä¸ª segment ç”±å“ªäº› section ç»„æˆã€‚&lt;/p&gt;&lt;p&gt;ELF æ–‡ä»¶çš„ä¸»è¦å†…å®¹ç”±å¤šä¸ªæ®µï¼ˆsectionï¼‰ç»„æˆï¼Œè¿™äº›æ®µå¯ä»¥å½¢æˆä¸¤ä¸ªè§†å›¾ï¼šä»ç¨‹åºåŠ è½½å™¨çš„è§’åº¦çœ‹ï¼Œæœ‰ä¸€ä¸ªå« &lt;code&gt;segments&lt;/code&gt; çš„è§†å›¾ï¼›ä»ç¼–è¯‘å™¨ã€é“¾æ¥å™¨è§’åº¦çœ‹æœ‰ä¸€ä¸ªå« &lt;code&gt;sections&lt;/code&gt; çš„è§†å›¾ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;LOAD&lt;/code&gt; é¡¹ç›®æ˜¾ç¤ºäº† segment çš„æ–‡ä»¶åç§»åœ°å€ã€è™šæ‹Ÿåœ°å€ã€ç‰©ç†åœ°å€ã€åœ¨æ–‡ä»¶ä¸­çš„å¤§å°ã€åœ¨å†…å­˜ä¸­çš„å¤§å°ã€æ ‡è®°ç­‰ä¿¡æ¯ï¼ˆè¿™äº›å†…å®¹ä¼šåœ¨æœ¬é¡¹ç›®çš„å…¶å®ƒæ–‡ç« ç§è®²è§£ï¼‰ã€‚è¿™äº›ä¿¡æ¯ä¼šå†³å®šç¨‹åºåŠ è½½å™¨å¦‚ä½•å¤„ç† segmentï¼Œæ¯”å¦‚ &lt;code&gt;RE&lt;/code&gt; æ ‡è®°è¡¨ç¤ºè¿™æ®µå†…å®¹åœ¨å†…å­˜ä¸­å…·æœ‰ &amp;ldquo;read, execute&amp;rdquo; æƒé™ï¼Œ&lt;code&gt;RW&lt;/code&gt; æ ‡è®°è¡¨ç¤ºè¿™æ®µå†…å®¹åœ¨å†…å­˜ä¸­å…·æœ‰ &amp;ldquo;read, write&amp;rdquo; æƒé™ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;åœ¨ç°ä»£çš„ CPU å†…å­˜ç®¡ç†å•å…ƒé‡Œï¼Œç‰©ç†å†…å­˜è¢«è™šæ‹ŸåŒ–ï¼Œå¹¶ä»¥å›ºå®šçš„å¤§å°ï¼ˆæ¯”å¦‚ 4KBï¼‰åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªåŒºå—ï¼ˆå«ä½œ &lt;em&gt;é¡µé¢&lt;/em&gt;ï¼‰ï¼Œæ¯ä¸ªå†…å­˜é¡µé¢éƒ½å¯ä»¥æœ‰ä¸åŒçš„æƒé™ï¼Œæ¯”å¦‚æœ‰äº›å†…å­˜é¡µé¢åªå¯è¯»ã€æœ‰äº›å¯è¯»å†™ã€æœ‰äº›å¯æ‰§è¡Œã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;Entry point 0x5b0&lt;/code&gt; è¡¨ç¤ºç¨‹åºçš„å…¥å£ï¼Œå³ç¨‹åºç¬¬ä¸€ä¸ªä¼šè¢«æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œä½äºåœ°å€ &lt;code&gt;0x5b0&lt;/code&gt;ï¼Œã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h4 id=&#34;objdump&#34;&gt;&lt;code&gt;objdump&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;å·¥å…· &lt;code&gt;objdump&lt;/code&gt; å¯ä»¥åæ±‡ç¼–å¯æ‰§è¡Œæ–‡ä»¶å½“ä¸­çš„ä»£ç æ®µï¼ŒæŸ¥çœ‹ä½ç½® &lt;code&gt;0x5b0&lt;/code&gt; çš„å†…å®¹ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-objdump -d app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºï¼ˆéƒ¨åˆ†ï¼‰ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Disassembly of section .text:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000005b0 &amp;lt;_start&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5b0:   022000ef                jal     ra,5d2 &amp;lt;load_gp&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5b4:   87aa                    mv      a5,a0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5b6:   00002517                auipc   a0,0x2&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5ba:   a8253503                ld      a0,-1406(a0) # 2038 &amp;lt;_GLOBAL_OFFSET_TABLE_+0x10&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5be:   6582                    ld      a1,0(sp)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5c0:   0030                    addi    a2,sp,8&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5c2:   ff017113                andi    sp,sp,-16&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5c6:   4681                    li      a3,0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5c8:   4701                    li      a4,0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5ca:   880a                    mv      a6,sp&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5cc:   fc5ff0ef                jal     ra,590 &amp;lt;__libc_start_main@plt&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5d0:   9002                    ebreak&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½æ„Ÿåˆ°å¾ˆæƒŠè®¶ï¼ŒåŸæ¥ç¨‹åºçš„å…¥å£ï¼ˆå³æœ€å…ˆå¼€å§‹æ‰§è¡Œçš„æŒ‡ä»¤ï¼‰å¹¶ä¸æ˜¯ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªåä¸º &lt;code&gt;_start&lt;/code&gt; çš„è¿‡ç¨‹ï¼ˆå¤§éƒ¨åˆ† C è¯­è¨€çš„æ•™ç§‘ä¹¦æˆ–è€…æ•™ç¨‹éƒ½è·Ÿæˆ‘ä»¬è¯´ï¼šç¨‹åºçš„å…¥å£æ˜¯ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå–„æ„çš„è°è¨€ï¼‰ã€‚&lt;code&gt;_start&lt;/code&gt; è¿‡ç¨‹ä¼šåšä¸€ç³»åˆ—çš„åˆå§‹åŒ–å·¥ä½œï¼Œç„¶åæ‰ä¼šè°ƒç”¨ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ï¼Œåœ¨ &lt;code&gt;main&lt;/code&gt; å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå®ƒè¿˜ä¼šåšä¸€äº›æ¸…ç†å·¥ä½œã€‚&lt;/p&gt;&lt;p&gt;åœ¨ä¸Šä¸€ä¸ªè¾“å‡ºçš„ç»“æœé‡Œå¾€ä¸‹ç¿»ï¼Œå°±å¯ä»¥æ‰¾åˆ°å‡½æ•° &lt;code&gt;main&lt;/code&gt; çš„å†…å®¹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000668 &amp;lt;main&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 668:   1141                    addi    sp,sp,-16&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 66a:   e406                    sd      ra,8(sp)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 66c:   e022                    sd      s0,0(sp)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 66e:   0800                    addi    s0,sp,16&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 670:   00000517                auipc   a0,0x0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 674:   02050513                addi    a0,a0,32 # 690 &amp;lt;_IO_stdin_used+0x8&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 678:   f29ff0ef                jal     ra,5a0 &amp;lt;puts@plt&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 67c:   0001                    nop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 67e:   60a2                    ld      ra,8(sp)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 680:   6402                    ld      s0,0(sp)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 682:   0141                    addi    sp,sp,16&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 684:   8082                    ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯¥æ®µæŒ‡ä»¤åŒ…å«äº†æ™®é€šå‡½æ•°çš„ &lt;em&gt;å¼€åœºç™½&lt;/em&gt; å’Œ &lt;em&gt;æ”¶åœºç™½&lt;/em&gt; æ¨¡æ¿ä»£ç ï¼Œä»¥åŠä¸€å¥å¯¹å‡½æ•° &lt;code&gt;puts&lt;/code&gt; çš„è°ƒç”¨ã€‚&lt;/p&gt;&lt;h3 id=&#34;è¿è¡Œ&#34;&gt;è¿è¡Œ&lt;/h3&gt;&lt;p&gt;å› ä¸º &lt;code&gt;app.out&lt;/code&gt; ä¸æ˜¯ &amp;ldquo;è£¸æœº&amp;rdquo; ç¨‹åºï¼Œå®ƒä¾èµ–å¹³å°ï¼ˆå³æ“ä½œç³»ç»Ÿï¼Œå¹³å°æä¾›äº†åŒ…æ‹¬ç¨‹åºåŠ è½½ã€å†…å­˜åˆ†é…å’Œç³»ç»Ÿè°ƒç”¨ç­‰åŠŸèƒ½ï¼‰æ‰èƒ½è¿è¡Œï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œå¯ä»¥ä½¿ç”¨ QEMU æ¨¡æ‹Ÿå™¨çš„ &lt;em&gt;ç”¨æˆ·æ¨¡å¼&lt;/em&gt; ç¨‹åº &lt;code&gt;qemu-riscv64&lt;/code&gt; æ¥è¿è¡Œï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ qemu-riscv64 app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¿è¡Œçš„ç»“æœæ˜¯ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;qemu-riscv64: Could not open &amp;#39;/lib/ld-linux-riscv64-lp64d.so.1&amp;#39;: No such file or directory&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ˜¾ç„¶ç¨‹åºå¹¶æ²¡æœ‰æ­£ç¡®åœ°è¿è¡Œï¼Œè¿™æ˜¯å› ä¸ºå½“å‰åº”ç”¨ç¨‹åºè°ƒç”¨äº† &lt;code&gt;printf&lt;/code&gt; å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°å®é™…ä¸Šæ˜¯è°ƒç”¨äº†æ ‡å‡†åº“çš„å‡½æ•° &lt;code&gt;puts&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;RISC-V GCC é»˜è®¤äº§ç”ŸåŠ¨æ€é“¾æ¥ç±»å‹çš„ç¨‹åºï¼Œåœ¨è¿è¡Œè¿™ç§ç¨‹åºæ—¶éœ€è¦ä¸€ä¸ª &lt;em&gt;è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥å™¨&lt;/em&gt;ï¼ˆåœ¨å½“å‰çš„ä¾‹å­é‡Œï¼Œå®ƒå°±æ˜¯ &lt;code&gt;ld-*.so&lt;/code&gt;ï¼‰åŠ è½½ç¨‹åºæ‰€éœ€çš„å…±äº«åº“ï¼Œä»¥åŠè¿›è¡Œä¸€ç³»åˆ—çš„åˆå§‹åŒ–å·¥ä½œï¼ˆæ¯”å¦‚å¯»æ‰¾æ ‡å‡†åº“å½“ä¸­å‡½æ•° &lt;code&gt;puts&lt;/code&gt; çš„åœ°å€ï¼‰ã€‚ç„¶è€Œä¸å¹¸çš„æ˜¯ &lt;code&gt;qemu-riscv64&lt;/code&gt; å¥½åƒä¸èƒ½æ­£ç¡®åœ°å®šä½ &lt;code&gt;ld-*.so&lt;/code&gt;ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;è™½ç„¶ &lt;em&gt;åŠ¨æ€é“¾æ¥&lt;/em&gt; æ¦‚å¿µå¯¹æ“ä½œç³»ç»Ÿæ¥è¯´æ˜¯ä¸é”™çš„ä¸»æ„ï¼Œä½†å¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºçš„åŠ¨æ€é“¾æ¥å¯¼è‡´çš„é—®é¢˜ä»¤äººç›¸å½“å¤´ç—›ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;æ²³é©¬èœ€é»æš‚æ—¶æ²¡æ‰¾åˆ°ä¼˜é›…åœ°è§£å†³è¯¥é—®é¢˜çš„æ–¹æ³•ï¼Œå› æ­¤ä¸‹é¢æ¢ä¸€ç§æ–¹å¼ï¼šç”Ÿæˆé™æ€é“¾æ¥ç±»å‹çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å³åœ¨ç”¨ GCC ç¼–è¯‘æ—¶ä¼ å…¥ &lt;code&gt;-static&lt;/code&gt; å‚æ•°ï¼Œç”¨äºæŒ‡ç¤º GCC ç”Ÿæˆé™æ€é“¾æ¥çš„ç¨‹åºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGCC ä¼šæŠŠè¢«è°ƒç”¨çš„å¤–éƒ¨å‡½æ•°çš„äºŒè¿›åˆ¶ä»£ç ï¼ˆå³æŒ‡ä»¤åºåˆ—ï¼‰å¤åˆ¶è¿›æˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶é‡Œï¼Œè¿™æ ·ç¨‹åºåœ¨è¿è¡Œæ—¶å°±ä¸éœ€è¦å…¶å®ƒå…±äº«åº“äº†ï¼Œè‡ªç„¶ä¹Ÿä¸éœ€è¦ &lt;code&gt;ld.so&lt;/code&gt; äº†ï¼Œå®ƒç›´æ¥è·Ÿæ“ä½œç³»ç»Ÿæ‰“äº¤é“ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -static -o app.static.out app.c&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å…ˆçœ‹çœ‹æ–‡ä»¶æ ¼å¼ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ file app.static.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app.static.out: ELF 64-bit LSB executable, UCB RISC-V, RVC, double-float ABI, version 1 (SYSV), statically linked, BuildID[sha1]=e5483614d4b600c22bdada95913a953eae577965, for GNU/Linux 4.15.0, with debug_info, not stripped&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŸå…ˆçš„ &amp;ldquo;dynamically linked&amp;rdquo; å·²ç»å˜ä¸º &amp;ldquo;statically linked&amp;rdquo;ã€‚å†çœ‹çœ‹æ–‡ä»¶çš„å¤§å°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-size app.static.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   text    data     bss     dec     hex filename&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 387532   22024   21760  431316   694d4 app.static.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»£ç æ®µçš„å¤§å°ä» 1KB å¤šå¢é•¿åˆ°è¿‘ 400KBï¼Œè¿™æ˜¯å› ä¸ºé“¾æ¥å™¨æŠŠæ‰€ç”¨åˆ°çš„å‡½æ•°çš„äºŒè¿›åˆ¶ä»£ç éƒ½å¤åˆ¶è¿‡æ¥äº†ï¼Œå¦‚æœåæ±‡ç¼– &lt;code&gt;app.static.out&lt;/code&gt; å°†ä¼šå¾—åˆ°è¶…é•¿çš„æ–‡æœ¬ï¼Œå› æ­¤è¿™é‡Œå°±ç•¥è¿‡äº†ï¼Œä¸‹é¢è¿è¡Œè¿™ä¸ªé™æ€é“¾æ¥çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ qemu-riscv64 app.static.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¿™æ¬¡å¾—åˆ°äº†é¢„æœŸçš„ç»“æœï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Hello world!&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é‚£ä¹ˆç©¶ç«Ÿæœ‰æ²¡åŠæ³•ç”¨ &lt;code&gt;qemu-riscv64&lt;/code&gt; è¿è¡ŒåŠ¨æ€é“¾æ¥çš„ç¨‹åºå‘¢ï¼Ÿæ–¹æ³•å½“ç„¶æ˜¯æœ‰çš„ï¼Œåªéœ€è®© &lt;code&gt;qemu-riscv64&lt;/code&gt; æ‰¾åˆ° &lt;code&gt;ld.so&lt;/code&gt; çš„æ­£ç¡®è·¯å¾„å°±å¯ä»¥äº†ï¼&lt;/p&gt;&lt;p&gt;å¦‚æœä½ çš„ç³»ç»Ÿæ˜¯ &lt;em&gt;Arch Linux&lt;/em&gt;ï¼Œä¼šå‘ç°æ–‡ä»¶ &lt;code&gt;ld-linux-riscv64-lp64d.so.1&lt;/code&gt; çš„æ­£ç¡®ç›®å½•æ˜¯ &lt;code&gt;/usr/riscv64-linux-gnu/lib&lt;/code&gt;ï¼ŒæŒ‰ç…§ &lt;code&gt;qemu-riscv64&lt;/code&gt; çš„è¯´æ˜ï¼Œåªè¦æŠŠè¿™ä¸ªè·¯å¾„é€šè¿‡å‚æ•° &lt;code&gt;-L /path/to/ld.so&lt;/code&gt; æˆ–è€…ç¯å¢ƒå˜é‡ &lt;code&gt;QEMU_LD_PREFIX&lt;/code&gt; ä¼ å…¥å³å¯ï¼Œç„¶è€Œæ²³é©¬èœ€é»å¹¶æ²¡æœ‰æˆåŠŸï¼ˆåŸå› æœªçŸ¥ï¼‰ã€‚ä¸‹é¢æ¼”ç¤ºå¦ä¸€ç§è§£å†³æ–¹æ³•ï¼Œå³æŒ‡å®šç¨‹åºçš„ &lt;em&gt;è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥å™¨&lt;/em&gt;ï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;åœ¨é“¾æ¥æ—¶ä¼ å…¥å‚æ•° &lt;code&gt;--dynamic-linker /path/to/ld.so&lt;/code&gt; æ›´æ”¹ç¨‹åºçš„ &lt;code&gt;interpreter&lt;/code&gt;ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -g -Wall -Wl,--dynamic-linker,/usr/riscv64-linux-gnu/lib/ld-linux-riscv64-lp64d.so.1 -o app.out app.c -L /usr/riscv64-linux-gnu/lib -lc&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ç¼–è¯‘å®Œæ¯•ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;file&lt;/code&gt; å‘½ä»¤æ£€æŸ¥ç¨‹åºï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ file app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app.out: ELF 64-bit LSB pie executable, UCB RISC-V, RVC, double-float ABI, version 1 (SYSV), dynamically linked, interpreter /usr/riscv64-linux-gnu/lib/ld-linux-riscv64-lp64d.so.1, BuildID[sha1]=973ca74e3c1f08bde10d29d173aa6370ab947b2b, for GNU/Linux 4.15.0, with debug_info, not stripped&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯è§ &lt;code&gt;interpreter&lt;/code&gt; å·²ç»æˆåŠŸæ›´æ”¹ä¸ºæŒ‡å®šçš„è·¯å¾„ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;åœ¨è¿è¡Œç¨‹åºçš„æ—¶å€™ï¼Œæ·»åŠ  RISC-V Linux GNU å…±äº«åº“çš„ä½ç½®ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ LD_LIBRARY_PATH=/usr/riscv64-linux-gnu/lib qemu-riscv64 app.out&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¦‚æ­¤ä¸€æ¥å°±èƒ½æ­£ç¡®è¿è¡Œç¨‹åºäº†ã€‚&lt;/p&gt;&lt;p&gt;ä¸Šé¢çš„å‘½ä»¤çš„å‚æ•°éå¸¸å¤šï¼Œå…·ä½“çš„å«ä¹‰ï¼Œä»¥åŠä¼˜é›…çš„ç¼–è¯‘å’Œè¿è¡ŒåŠ¨æ€é“¾æ¥ç¨‹åºçš„æ–¹æ³•ï¼Œè¯·çœ‹æœ¬é¡¹ç›®çš„å¦ä¸€ç¯‡æ–‡ç«  &lt;a href=&#34;../dynamic-linking/README.zh-Hans.md&#34;&gt;åŠ¨æ€é“¾æ¥çš„åŸç†&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;åˆ†é˜¶æ®µç¼–è¯‘&#34;&gt;åˆ†é˜¶æ®µç¼–è¯‘&lt;/h3&gt;&lt;p&gt;å½“æ‰§è¡Œå‘½ä»¤ &lt;code&gt;riscv64-linux-gnu-gcc&lt;/code&gt; å°†ä¸€ä¸ª C æºä»£ç ç¼–è¯‘ä¸ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œå®é™…ä¸Š GCC æ˜¯åˆ† 4 ä¸ªé˜¶æ®µï¼ˆæˆ–è€…è¯´æ­¥éª¤ï¼‰æ¥å®Œæˆçš„ï¼š&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/gcc-compile-stage.png&#34; alt=&#34;GCC compile stages&#34;&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;é¢„å¤„ç†&lt;/p&gt;&lt;p&gt;å°†æºä»£ç é‡Œçš„ &lt;code&gt;include&lt;/code&gt; æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œè§£æå…¶ä¸­çš„æ¡ä»¶ç¼–è¯‘æŒ‡ä»¤ï¼ˆ&lt;code&gt;#ifdef&lt;/code&gt;ï¼‰ï¼Œå±•å¼€å®ï¼ˆ&lt;code&gt;macro&lt;/code&gt;ï¼‰ç­‰ã€‚ç›¸å½“äºå‘½ä»¤ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-cpp app.c &amp;gt; app.i&lt;/code&gt;&lt;/p&gt;&lt;p&gt;æˆ–è€…&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -E app.c &amp;gt; app.i&lt;/code&gt;&lt;/p&gt;&lt;p&gt;æ³¨æ„ä¸Šé¢ç¨‹åº &lt;code&gt;riscv64-linux-gnu-cpp&lt;/code&gt; å½“ä¸­çš„ &amp;ldquo;cpp&amp;rdquo; æ˜¯æŒ‡ &amp;ldquo;C Preprocessor&amp;rdquo;ï¼Œè€Œä¸æ˜¯ &amp;ldquo;C++&amp;rdquo; çš„æ„æ€ã€‚ç»è¿‡é¢„å¤„ç†çš„ C è¯­è¨€æºä»£ç æ–‡ä»¶çš„æ‰©å±•åä¸º &lt;code&gt;*.i&lt;/code&gt;ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ç¼–è¯‘&lt;/p&gt;&lt;p&gt;å°† C ä»£ç ç¼–è¯‘ä¸ºæ±‡ç¼–ä»£ç ï¼Œç›¸å½“äºå‘½ä»¤ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -S app.i&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ç¬¬ 1 åˆ°ç¬¬ 2 æ­¥ä¹Ÿå¯ä»¥ä¸€æ­¥å®Œæˆï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -S app.c&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ç”Ÿæˆçš„æ±‡ç¼–æºä»£ç æ–‡ä»¶çš„æ‰©å±•åä¸º &lt;code&gt;*.s&lt;/code&gt;ï¼Œæ³¨æ„è¿™è·Ÿæˆ‘ä»¬æ‰‹å†™çš„æ±‡ç¼–æºä»£ç æ–‡ä»¶æ‰©å±•å &lt;code&gt;*.S&lt;/code&gt; ä¸åŒã€‚å¤§å†™ &lt;code&gt;S&lt;/code&gt; è¡¨ç¤ºä¼šç»è¿‡é¢„å¤„ç†ï¼ˆæ¯”å¦‚å¤„ç† &lt;code&gt;.include&lt;/code&gt; æŒ‡ä»¤ï¼‰åœ¨è¿›å…¥ä¸‹ä¸€æ­¥çš„æ±‡ç¼–å¤„ç†ï¼Œè€Œå°å†™çš„ &lt;code&gt;s&lt;/code&gt; è¡¨ç¤ºä¸ä¼šè¿›è¡Œé¢„å¤„ç†ã€‚å…·ä½“çš„æ‰©å±•åå’Œ GCC å‚æ•°å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;æ±‡ç¼–&lt;/p&gt;&lt;p&gt;å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºæœºå™¨æŒ‡ä»¤åºåˆ—ï¼Œå¹¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼Œç›¸å½“äºå‘½ä»¤ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-as -o app.o app.s&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ç¬¬ 1 åˆ°ç¬¬ 3 æ­¥ä¹Ÿå¯ä»¥ä¸€æ­¥å®Œæˆï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -c -o app.o app.c&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å‚æ•° &lt;code&gt;-c&lt;/code&gt; è¡¨ç¤ºåªç¼–è¯‘ä½†ä¸é“¾æ¥ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;é“¾æ¥&lt;/p&gt;&lt;p&gt;å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥èµ·æ¥ï¼Œå¹¶é‡æ–°å®šä½å…¶ä¸­çš„å…¨å±€å˜é‡å’Œå‡½æ•°çš„åœ°å€ï¼Œæœ€åç”Ÿæˆ ELF æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç›¸å½“äºå‘½ä»¤ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-ld -o app.out app_startup.o app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢çš„å‘½ä»¤ä¼šå°† &lt;code&gt;app_startup.o&lt;/code&gt; å’Œ &lt;code&gt;app.o&lt;/code&gt; ä¸¤ä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥èµ·æ¥å¹¶ç”Ÿæˆï¼ˆåŠ¨æ€é“¾æ¥ç±»å‹çš„ï¼‰å¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;æ³¨æ„ï¼Œä¸Šé¢çš„ &lt;code&gt;app_startup.o&lt;/code&gt; æ˜¯ä¸€ä¸ªå‡è±¡çš„åº”ç”¨ç¨‹åºå¯åŠ¨å™¨ï¼ˆæä¾›åº”ç”¨çš„å…¥å£ &lt;code&gt;_start&lt;/code&gt; è¿‡ç¨‹ä»¥åŠåšä¸€äº›åˆå§‹åŒ–å’Œæ¸…ç†å·¥ä½œï¼‰ï¼Œåœ¨å½“å‰ç¤ºä¾‹çš„æºä»£ç ç›®å½•é‡Œå¹¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¸Šé¢çš„å‘½ä»¤å¹¶ä¸èƒ½æˆåŠŸåœ°è¿è¡Œã€‚&lt;/p&gt;&lt;p&gt;ä¸Šé¢çš„ç¬¬ 1 åˆ° ç¬¬ 4 ä¸ªæ­¥éª¤å¯ä»¥ä¸€æ­¥å®Œæˆï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -o app.out app.c&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å¦‚æœä½ æƒ³çŸ¥é“ GCC åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„æ¯ä¸ªæ­¥éª¤ä»¥åŠç»†èŠ‚ï¼Œå¯ä»¥ä¼ å…¥ &lt;code&gt;-v&lt;/code&gt; å‚æ•°ï¼Œæ¯”å¦‚ &lt;code&gt;$ riscv64-linux-gnu-gcc -v -o app.out app.c&lt;/code&gt;ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;&lt;p&gt;åœ¨å¹³å¸¸çš„ç¼–è¯‘ç¨‹åºä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦åˆ†æˆ 4 æ­¥ï¼Œä¸€èˆ¬åªéœ€åˆ†æˆ &lt;em&gt;ç¼–è¯‘&lt;/em&gt; å’Œ &lt;em&gt;é“¾æ¥&lt;/em&gt; 2 æ­¥ï¼Œè€Œä¸”ä¸€èˆ¬éƒ½æ˜¯å€ŸåŠ©è¯¸å¦‚ &lt;code&gt;make&lt;/code&gt; ç­‰æ„å»ºå·¥å…·æ¥å®Œæˆã€‚ä½†æˆ‘ä»¬ä»ç„¶éœ€è¦æ¸…æ¥šçŸ¥é“ç¼–è¯‘å™¨çš„å„ä¸ªé˜¶æ®µçš„ä½œç”¨ï¼Œç†è§£è¿™äº›æ¦‚å¿µæœ‰åŠ©äºè§£å†³åœ¨ç¼–è¯‘è¿‡ç¨‹é‡åˆ°çš„å„ç§é—®é¢˜ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&#34;å¸¸ç”¨çš„ç¼–è¯‘å‚æ•°&#34;&gt;å¸¸ç”¨çš„ç¼–è¯‘å‚æ•°&lt;/h3&gt;&lt;p&gt;é™¤äº†ä¸Šé¢å·²ç»æ¼”ç¤ºè¿‡çš„ï¼ŒGCC è¿˜æœ‰ä¸€äº›å…¶å®ƒå¸¸ç”¨çš„å‚æ•°ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;-I&lt;/code&gt; ç”¨äºæŒ‡å®šå¤´æ–‡ä»¶çš„è·¯å¾„&lt;/p&gt;&lt;p&gt;æœ‰æ—¶å¤´æ–‡ä»¶ï¼ˆ&lt;code&gt;*.h&lt;/code&gt;ï¼‰åˆ†å¸ƒåœ¨å¤šä¸ªç›®å½•ï¼Œè¿™æ—¶å¯ä»¥ç”¨å‚æ•° &lt;code&gt;-I&lt;/code&gt; æŠŠé¢å¤–çš„å¤´æ–‡ä»¶çš„è·¯å¾„åŒ…å«è¿›æ¥ï¼Œæ¯”å¦‚å½“å‰çš„è·¯å¾„ä¸º &lt;code&gt;/home/yang/hello-world/app.c&lt;/code&gt;ï¼Œå‡å¦‚æœ‰é¢å¤–çš„å¤´æ–‡ä»¶ä½äº &lt;code&gt;/home/yang/hello-world/include/&lt;/code&gt;ï¼Œåˆ™å¯ä»¥è¿™æ ·ä¼ å…¥å‚æ•°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -I /home/yang/hello-world/include app.c&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;-L&lt;/code&gt; å’Œ &lt;code&gt;-l&lt;/code&gt; ç”¨äºæŒ‡å®šé¢å¤–åº“çš„è·¯å¾„å’Œåç§°&lt;/p&gt;&lt;p&gt;æ¥ç€ä¸Šä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœåº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨åˆ°åº“ &lt;code&gt;/home/yang/hello-world/lib/libmymath.a&lt;/code&gt;ï¼Œåˆ™å¯ä»¥è¿™æ ·ä¼ å…¥å‚æ•°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc app.c -L /home/yang/hello-world/lib -lmymath&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­å‚æ•° &lt;code&gt;-lmymath&lt;/code&gt; çš„ &lt;code&gt;-l&lt;/code&gt; æ˜¯å‚æ•°åç§°ï¼Œ&lt;code&gt;mymath&lt;/code&gt; æ˜¯å‚æ•°å€¼ï¼Œç­‰æ•ˆäº &lt;code&gt;-l mymath&lt;/code&gt;ã€‚è¿™ä¸ªå‚æ•°è¡¨ç¤ºç¼–è¯‘è¿‡ç¨‹ä¼šä½¿ç”¨åˆ°åº“æ–‡ä»¶ &lt;code&gt;libmymath.a&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;æ³¨æ„å‚æ•° &lt;code&gt;-l&lt;/code&gt; çš„å€¼æ˜¯åº“çš„ &lt;code&gt;soname&lt;/code&gt;ï¼Œæ¯”å¦‚ä¸Šä¾‹ç§åº“æ–‡ä»¶çš„çœŸå®åç§°æ˜¯ &lt;code&gt;libmymath.a&lt;/code&gt;ï¼Œå»é™¤äº†å‰ç¼€ &lt;code&gt;lib&lt;/code&gt; å’Œåç¼€ &lt;code&gt;.a&lt;/code&gt;ï¼ˆæˆ–è€… &lt;code&gt;.so&lt;/code&gt;ï¼‰ä¹‹åå°±æ˜¯ &lt;code&gt;soname&lt;/code&gt; äº†ã€‚æ›´å¤šçš„ä¾‹å­ï¼Œæ¯”å¦‚ &lt;code&gt;libm.so&lt;/code&gt; çš„ &lt;code&gt;soname&lt;/code&gt; æ˜¯å•ç‹¬ä¸€ä¸ªå­—æ¯ &lt;code&gt;m&lt;/code&gt;ï¼Œ&lt;code&gt;libpthread.so&lt;/code&gt; çš„æ˜¯ &lt;code&gt;pthread&lt;/code&gt;ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;æ³¨æ„ï¼šä¸€èˆ¬éœ€è¦æŠŠå‚æ•° &lt;code&gt;-L ... -l ...&lt;/code&gt; æ”¾åœ¨å‘½ä»¤çš„æœ«å°¾ï¼Œä¹Ÿå°±æ˜¯ä¾èµ–é¡¹çš„é¡ºåºå¿…é¡»éµå¾ª &amp;ldquo;è¢«ä¾èµ–çš„æ”¾åœ¨åé¢&amp;rdquo; çš„åŸåˆ™ï¼Œå¦‚æœé¡ºåºä¸å¯¹æœ‰å¯èƒ½å¯¼è‡´é“¾æ¥å¤±è´¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;GCC çš„ç¼–è¯‘è¿‡ç¨‹æ˜¯æ¾æ•£çš„ï¼Œå®ƒç”±ä¸Šä¸€èŠ‚æ‰€è¿°çš„ 4 ä¸ªç›¸å¯¹ç‹¬ç«‹çš„é˜¶æ®µç»„æˆï¼Œæ˜¾ç„¶å¤´æ–‡ä»¶æ˜¯åœ¨é¢„å¤„ç†é˜¶æ®µä½¿ç”¨ï¼Œè€Œåº“æ–‡ä»¶åˆ™æ˜¯åœ¨é“¾æ¥é˜¶æ®µä½¿ç”¨ï¼Œå½“ä½¿ç”¨ä¸€ä¸ª GCC å‘½ä»¤ç¼–è¯‘ä¸€ä¸ªç¨‹åºæ—¶ï¼Œå‚æ•° &lt;code&gt;-I -L -l&lt;/code&gt; éœ€è¦å…¨éƒ¨å¡«ä¸Šã€‚&lt;/p&gt;&lt;h2 id=&#34;è£¸æœºç¨‹åº&#34;&gt;è£¸æœºç¨‹åº&lt;/h2&gt;&lt;p&gt;è£¸æœºç¨‹åºæ˜¯æŒ‡åœ¨ &amp;ldquo;æ— æ“ä½œç³»ç»Ÿ&amp;rdquo; çš„ç¯å¢ƒä¸­è¿è¡Œçš„ç¨‹åºï¼Œå¬èµ·æ¥å¯èƒ½ä¼šè§‰å¾—å¾ˆç¥å¥‡ï¼šä¸€ä¸ªæœºå™¨ä¸ç”¨å®‰è£…æ“ä½œç³»ç»Ÿä¹Ÿèƒ½è¿è¡Œåº”ç”¨ç¨‹åºï¼Ÿæ˜¯çš„ï¼Œå¾ˆæ˜¾ç„¶è¯¸å¦‚æ“ä½œç³»ç»Ÿçš„å¼•å¯¼å™¨ï¼Œä»¥åŠæ“ä½œç³»ç»Ÿæœ¬èº«å°±æ˜¯è£¸æœºç¨‹åºã€‚&lt;/p&gt;&lt;p&gt;è£¸æœºç¨‹åºè·Ÿæ™®é€šåº”ç”¨ç¨‹åºå¹¶æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œå…¶ä¸­çš„æ•°å€¼è®¡ç®—ã€æµç¨‹æ§åˆ¶ã€ç¨‹åºçš„ç»“æ„ç­‰è·Ÿæ™®é€šåº”ç”¨ç¨‹åºæ˜¯ä¸€æ‘¸ä¸€æ ·çš„ï¼Œåªæ˜¯åœ¨è¿›è¡Œä¸€äº›ç‰¹æƒæˆ–è€… I/O æ“ä½œæ—¶ï¼Œéœ€è¦ç›´æ¥è·Ÿç¡¬ä»¶ï¼ˆåŒ…æ‹¬ CPU å’Œå¤–è®¾ï¼‰æ‰“äº¤é“ï¼Œè€Œä¸èƒ½è®©æ“ä½œç³»ç»Ÿä»£åŠ³ï¼ˆä¸€èˆ¬çš„ç¨‹åºæ˜¯é€šè¿‡è°ƒç”¨æ ‡å‡†åº“ï¼Œæ ‡å‡†åº“å†å‘æ“ä½œç³»ç»Ÿå‘èµ· &lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt; ç­‰ä¸€ç³»åˆ—è¿‡ç¨‹å®ç°ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å¹¸å¥½è·Ÿç¡¬ä»¶æ‰“äº¤é“éƒ½ä¸ç®—å¤ªå¤æ‚ï¼Œæœ‰äº›ç¡¬ä»¶åœ¨ç”µè·¯é‡Œè¢«æ˜ å°„åˆ°æŸæ®µå†…å­˜åœ°å€ï¼Œæ¯”å¦‚ä¸²å£æ§åˆ¶å°ï¼Œä½ åªéœ€æŠŠå®ƒä»¬å½“ä½œå†…å­˜æ¥è¯»å†™ï¼Œå†ç¨å¾®ç»è¿‡ä½è¿ç®—ç­‰å¤„ç†ï¼Œå³å¯è·å–è¿™äº›ç¡¬ä»¶çš„çŠ¶æ€æ•°æ®æˆ–è€…æ›´æ”¹å®ƒä»¬çš„çŠ¶æ€ï¼›æœ‰äº›ç¡¬ä»¶æœ‰ä¸“é—¨çš„ CPU æŒ‡ä»¤æ¥æ“ä½œï¼Œè£¸æœºç¨‹åºåªéœ€ç¼–å†™ç›¸åº”çš„æ±‡ç¼–ä»£ç å³å¯ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ª &amp;ldquo;è£¸æœº&amp;rdquo; ç‰ˆçš„ &amp;ldquo;Hello world!&amp;rdquo; ç¨‹åºï¼Œè¯¥ç¨‹åºå®ç° 3 ä¸ªåŠŸèƒ½ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å‘ä¸²å£æ§åˆ¶å°æ‰“å°ä¸€è¡Œ &amp;ldquo;Hello world!&amp;rdquo; æ–‡æœ¬ï¼›&lt;/li&gt;&lt;li&gt;è®¡ç®—ä¸¤ä¸ªæ•´æ•°çš„å’Œå¹¶æ˜¾ç¤ºå…¶ç»“æœï¼›&lt;/li&gt;&lt;li&gt;è®¡ç®—ä¸€ä¸ªæ•´æ•°åŠ ä¸Š 10 ä¹‹åçš„å€¼ï¼Œå¹¶æ˜¾ç¤ºå…¶ç»“æœã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¯¥ç¨‹åºçš„æºæ–‡ä»¶æ•°é‡æ¯”è¾ƒå¤šï¼Œæ¶‰åŠçš„æ–°é²œæ¦‚å¿µä¹Ÿæ¯”è¾ƒå¤šï¼Œåœ¨è¿™ç¯‡æ–‡ç« é‡Œæš‚æ—¶ä¸ä¼šä½œç»†è‡´çš„åˆ†æï¼Œå¦‚æœå¯¹å…¶ä¸­çš„ç»†èŠ‚æˆ–è€…åŸç†æœ‰ç–‘æƒ‘ï¼Œå¯ä»¥æš‚æ—¶å¿½ç•¥ã€‚åç»­çš„æ–‡ç« ä¼šæœ‰è¯¦ç»†çš„è®²è§£ï¼Œä½ å¯ä»¥åœ¨é˜…è¯»å®Œåç»­çš„æ–‡ç« ä¹‹åå†å›æ¥çœ‹è¯¥ç¨‹åºçš„å†…å®¹ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ªç« èŠ‚ä»…ä¸ºäº†ç®€å•ä»‹ç»ç”¨ GCC ç¼–è¯‘è£¸æœºç¨‹åºçš„è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;h3 id=&#34;ç¨‹åºçš„ç»„æˆ&#34;&gt;ç¨‹åºçš„ç»„æˆ&lt;/h3&gt;&lt;p&gt;ç¨‹åºç”±ä¸‹åˆ—å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;åŸºç¡€åº“ &lt;code&gt;put_char.S&lt;/code&gt; å’Œ &lt;code&gt;libprint.c&lt;/code&gt;&lt;/li&gt;&lt;li&gt;è®¡ç®—åº“ &lt;code&gt;liba.c&lt;/code&gt; å’Œ &lt;code&gt;libb.c&lt;/code&gt;&lt;/li&gt;&lt;li&gt;ä¸»ç¨‹åº &lt;code&gt;app.c&lt;/code&gt;&lt;/li&gt;&lt;li&gt;å¯åŠ¨å™¨ &lt;code&gt;app_startup.S&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 id=&#34;åŸºç¡€åº“&#34;&gt;åŸºç¡€åº“&lt;/h4&gt;&lt;p&gt;å› ä¸ºæ²¡æœ‰æ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼Œæ˜¾ç„¶æ— æ³•ç›´æ¥ä½¿ç”¨ &lt;code&gt;printf&lt;/code&gt; å‡½æ•°ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªåŠŸèƒ½ç›¸è¿‘çš„ç®€å•å‡½æ•°ã€‚&lt;/p&gt;&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œè¯¥åº”ç”¨ç¨‹åºå‡†å¤‡åœ¨è™šæ‹Ÿæœº RISC-V QEMU ä¸­è¿è¡Œï¼Œé€šè¿‡æŸ¥çœ‹ &lt;a href=&#34;https://github.com/qemu/qemu/blob/master/hw/riscv/virt.c&#34;&gt;QEMU RISC-V virt çš„æºä»£ç &lt;/a&gt; å¯ä»¥æ‰¾åˆ°ä¸€äº›åŸºæœ¬ç¡¬ä»¶çš„å†…å­˜æ˜ å°„å…³ç³»ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; MemMapEntry virt_memmap[] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_MROM] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;         {     &lt;span style=&#34;color:#ae81ff&#34;&gt;0x1000&lt;/span&gt;,        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xf000&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_UART0] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;        { &lt;span style=&#34;color:#ae81ff&#34;&gt;0x10000000&lt;/span&gt;,         &lt;span style=&#34;color:#ae81ff&#34;&gt;0x100&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_FLASH] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;        { &lt;span style=&#34;color:#ae81ff&#34;&gt;0x20000000&lt;/span&gt;,     &lt;span style=&#34;color:#ae81ff&#34;&gt;0x4000000&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_DRAM] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;         { &lt;span style=&#34;color:#ae81ff&#34;&gt;0x80000000&lt;/span&gt;,           &lt;span style=&#34;color:#ae81ff&#34;&gt;0x0&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ä¸²å£é€šä¿¡ UART è¢«æ˜ å°„åˆ° &lt;code&gt;0x1000_0000&lt;/code&gt;ï¼Œè¿™è¡¨æ˜åªéœ€å‘è¯¥å†…å­˜åœ°å€å†™å…¥ä¸€ä¸ª byte ç±»å‹æ•´æ•°ï¼Œè¯¥æ•´æ•°å¯¹åº”çš„ ASCII å­—ç¬¦å°±ä¼šè¢«é‡å®šå‘åˆ°è™šæ‹Ÿç»ˆç«¯ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;å¹¶éæ‰€æœ‰çš„ç¡¬ä»¶è¯»å†™éƒ½æ˜¯è¿™ç§æ–¹å¼ï¼Œåç»­çš„æ–‡ç« ä¼šè¯¦ç»†è®²è§£å¦‚ä½•ç”¨æ±‡ç¼–å†™é©±åŠ¨ï¼Œæ¯”å¦‚ GPIOï¼ŒI2C ç­‰æ§åˆ¶ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;æ‰€ä»¥è¦å®ç°æ‰“å°å•ä¸ªå­—ç¬¦çš„å‡½æ•°æ˜¯å¾ˆç®€å•çš„ï¼Œåœ¨ç›®å½• &lt;a href=&#34;./resources/bare-metal/&#34;&gt;resources/bare-metal&lt;/a&gt; é‡Œæœ‰æºä»£ç æ–‡ä»¶ &lt;code&gt;put_char.S&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-S&#34; data-lang=&#34;S&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ VIRT_UART0, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x10000000&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.section .text.put_char&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.globl put_char&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;put_char&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li s1, VIRT_UART0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    mv s2, a0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sb s2, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;(s1)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;p&gt;å› ä¸ºè¿™æ®µç¨‹åºåœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Œæ‰€ä»¥è¿™é‡Œå¿½ç•¥äº† UART å‘é€æ‰€éœ€çš„å»¶è¿Ÿã€‚å¦‚æœæ˜¯åœ¨çœŸå®ç¡¬ä»¶ä¸Šç¼–å†™å‘é€å­—ç¬¦çš„ç¨‹åºï¼Œåº”è¯¥æ£€æŸ¥ UART TX FIFO çš„å€¼ï¼Œä»…å½“ä¸Šä¸€ä¸ªå­—ç¬¦å‘é€å®Œæ¯•ä¹‹åï¼ˆå³ TX ç©ºé—²ä¹‹åï¼‰å†å‘é€ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œæ¯•ç«Ÿ CPU çš„å·¥ä½œé¢‘ç‡æ¯” UART çš„é«˜å¾ˆå¤šã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;æ‰“å°å­—ç¬¦å‡½æ•°ä¹Ÿå¯ä»¥ç”¨ C è¯­è¨€å®ç°ï¼Œæºä»£ç æ–‡ä»¶æ˜¯ &lt;code&gt;put_char.c&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#define VIRT_UART0 0x10000000&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;volatile&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; VIRT_UART0_PTR &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;)VIRT_UART0;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;put_char&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; c)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;VIRT_UART0_PTR &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; c;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºè¿™æ®µ C ä»£ç æ‰€è¡¨è¾¾çš„æ„æ€ä¸å¤Ÿæ±‡ç¼–çš„é‚£ä¹ˆæ˜ç¡®ï¼Œæ‰€ä»¥é€‰ç”¨äº†æ±‡ç¼–ç‰ˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;åœ¨æ­¤åŸºç¡€ä¹‹ä¸Šï¼Œå¯ä»¥ç”¨ C è¯­è¨€å®ç° &lt;code&gt;print_char&lt;/code&gt;ï¼Œ&lt;code&gt;print_string&lt;/code&gt; å’Œ &lt;code&gt;print_int&lt;/code&gt; ç­‰å‡½æ•°ï¼Œä»¥æ–¹ä¾¿åç»­çš„è°ƒç”¨ã€‚æºä»£ç æ–‡ä»¶ä¸º &lt;code&gt;libprint.c&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;#34;put_char.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;print_char&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; c)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    put_char((&lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)c);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;print_string&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;str)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;str &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        print_char(&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;str);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        str&lt;span style=&#34;color:#f92672&#34;&gt;++&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;print_int&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; s[&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;];&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    itoa(i, s, &lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_string(s);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è‡³æ­¤ï¼Œåº”ç”¨ç¨‹åºå·²ç»æœ‰æ‰“å°å­—ç¬¦ã€å­—ç¬¦ä¸²å’Œæ•°å­—çš„èƒ½åŠ›äº†ã€‚&lt;/p&gt;&lt;h4 id=&#34;è®¡ç®—åº“&#34;&gt;è®¡ç®—åº“&lt;/h4&gt;&lt;p&gt;æ¥ä¸‹æ¥å®ç°æ•´æ•°ç›¸åŠ ç­‰æ•°å­¦å‡½æ•°ï¼Œæºä»£ç æ–‡ä»¶åˆ†åˆ«ä¸º &lt;code&gt;liba.c&lt;/code&gt; å’Œ &lt;code&gt;libb.c&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// liba.c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; a, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; b)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; b;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// libb.c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;#34;liba.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;add10&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; add(i, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;p&gt;ä¹‹æ‰€ä»¥æŠŠå‡½æ•°åˆ’åˆ†åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ˜¯å› ä¸ºæ¥ä¸‹æ¥çš„ç« èŠ‚ä¼šè®²è¿° &lt;em&gt;æ‰“åŒ…ç›®æ ‡æ–‡ä»¶&lt;/em&gt; çš„åŠŸèƒ½ï¼Œå³æŠŠ &lt;code&gt;liba.o&lt;/code&gt; å’Œ &lt;code&gt;libb.o&lt;/code&gt; æ‰“åŒ…ä¸º &lt;code&gt;libmath.a&lt;/code&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h4 id=&#34;ä¸»ç¨‹åº&#34;&gt;ä¸»ç¨‹åº&lt;/h4&gt;&lt;p&gt;ç„¶åå†çœ‹çœ‹ä¸»ç¨‹åºï¼Œæºä»£ç æ–‡ä»¶ &lt;code&gt;app.c&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;#34;libmath.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;#34;libprint.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;bare_main&lt;/span&gt;()&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; m &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; add(a, b);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; n &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; add10(a);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_string(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello world!&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_int(m);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_char(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_int(n);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_char(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºè¿™ä¸ªæ˜¯ &amp;ldquo;è£¸æœº&amp;rdquo; ç¨‹åºï¼Œä¸ºäº†è·Ÿæ ‡å‡†ç¨‹åºåŒºåˆ†ï¼Œè¿™é‡ŒæŠŠä¸»å‡½æ•° &lt;code&gt;main&lt;/code&gt; å‘½åä¸º &lt;code&gt;bare_main&lt;/code&gt;ï¼ˆéšæ„çš„åç§°ï¼‰ã€‚&lt;/p&gt;&lt;h4 id=&#34;å¯åŠ¨å™¨&#34;&gt;å¯åŠ¨å™¨&lt;/h4&gt;&lt;p&gt;ç”±ä¸Šä¸€èŠ‚çŸ¥é“ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„å…¥å£ï¼ˆå³æœ€å…ˆå¼€å§‹æ‰§è¡Œçš„æŒ‡ä»¤ï¼‰æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„ &lt;code&gt;_start&lt;/code&gt; è¿‡ç¨‹ï¼Œç»è¿‡ä¸€ç³»åˆ—åˆå§‹åŒ–ä¹‹åæ‰è°ƒç”¨å‡½æ•° &lt;code&gt;main&lt;/code&gt;ã€‚ä½†è¿™äº›äº‹æƒ…ä»…åœ¨ç¼–è¯‘ä¸ºæ ‡å‡† Linux ç¨‹åºæ—¶æ‰ä¼šå‘ç”Ÿï¼Œç°åœ¨ç¼–è¯‘è£¸æœºç¨‹åºï¼Œç¼–è¯‘å™¨æ˜¯ä¸ä¼šè‡ªä½œä¸»å¼ åœ°æ·»åŠ è¿™äº›è¿‡ç¨‹çš„ï¼Œæ‰€ä»¥è¿˜å¾—å†™ä¸€ä¸ª &amp;ldquo;ç¨‹åºçš„å¯åŠ¨ç¨‹åº&amp;rdquo;ï¼Œæºä»£ç æ–‡ä»¶ä¸º &lt;code&gt;app_startup.S&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-S&#34; data-lang=&#34;S&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.section .text.entry&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.globl _start&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;_start&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    la sp, stack_top&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    call bare_main&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;_loop&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    nop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    j _loop&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢çš„ç¨‹åºçš„åŠŸèƒ½å¾ˆç®€å•ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å› ä¸ºç¨‹åºæœ‰åµŒå¥—çš„å‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ° &lt;em&gt;æ ˆ&lt;/em&gt;ã€‚é€šè¿‡å‘ &amp;ldquo;stack pointer&amp;rdquo; å¯„å­˜å™¨å†™å…¥ä¸€ä¸ªåœ°å€å³å¯è®¾ç½®æ ˆåº•ï¼ˆé«˜åœ°å€ï¼‰ï¼Œè¿™æ ·ä¸€æ¥ &lt;em&gt;æ ˆ&lt;/em&gt; å°±æ­å»ºå¥½äº†ã€‚ï¼ˆä»£ç ä¸­çš„ &lt;code&gt;stack_top&lt;/code&gt; æ˜¯é“¾æ¥è„šæœ¬ &lt;code&gt;app.lds&lt;/code&gt; å¯¼å‡ºçš„ç¬¦å·ï¼‰&lt;/li&gt;&lt;li&gt;è°ƒç”¨ä¸»ç¨‹åºçš„ä¸»å‡½æ•° &lt;code&gt;bare_main&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h3 id=&#34;ç¼–è¯‘-1&#34;&gt;ç¼–è¯‘&lt;/h3&gt;&lt;p&gt;ç¼–è¯‘å„ä¸ªæºæ–‡ä»¶ï¼Œä½†æš‚æ—¶ä¸éœ€è¦é“¾æ¥ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-as -o app_startup.o app_startup.S&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-gcc -I . -Wall -fPIC -c -o app.o app.c&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-gcc -I . -Wall -fPIC -c -o liba.o liba.c&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-gcc -I . -Wall -fPIC -c -o libb.o libb.c&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-gcc -I . -Wall -fPIC -c -o libprint.o libprint.c&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-as -o put_char.o put_char.S&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨çœ‹ç¬¬äºŒæ¡å‘½ä»¤ï¼Œå³ç¼–è¯‘ &lt;code&gt;app.c&lt;/code&gt; çš„é‚£æ¡å‘½ä»¤ï¼Œä½ å¯èƒ½ä¼šæ„Ÿåˆ°ç–‘æƒ‘ï¼Œåœ¨ &lt;code&gt;app.c&lt;/code&gt; é‡Œæ—¢è°ƒç”¨äº†å‡½æ•° &lt;code&gt;add&lt;/code&gt;ã€&lt;code&gt;add10&lt;/code&gt;ï¼Œè¿˜è°ƒç”¨äº† &lt;code&gt;print_*&lt;/code&gt;ï¼Œä½†è¿™äº›å‡½æ•°éƒ½è¿˜æ²¡ç¼–è¯‘ï¼Œè€Œä¸”åœ¨ &lt;code&gt;app.c&lt;/code&gt; é‡Œä¹Ÿæ‰¾ä¸åˆ°ä»»ä½•è·Ÿ &lt;code&gt;liba.c&lt;/code&gt; å’Œ &lt;code&gt;libb.c&lt;/code&gt; è”ç³»çš„ä»£ç ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜èƒ½æˆåŠŸç¼–è¯‘å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;è¿™æ­£æ˜¯ GCC ç¼–è¯‘çš„å·¥ä½œåŸç†ï¼Œåœ¨ç¼–è¯‘ä¸€ä¸ªæºæ–‡ä»¶æ—¶ï¼Œå¦‚æœä»£ç é‡Œæœ‰è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œç¼–è¯‘å™¨å®é™…ä¸Šä¸ç®¡è¿™ä¸ªå¤–éƒ¨å‡½æ•°æ˜¯å¦å­˜åœ¨ï¼ˆæ˜¯å¦å·²ç»ç¼–è¯‘ï¼‰ï¼Œä¹Ÿä¸ç®¡å®ƒåœ¨å“ªé‡Œï¼Œä½ åªéœ€æä¾›è¿™ä¸ªå‡½æ•°çš„ç­¾åå³å¯ï¼ˆå‡½æ•°ç­¾åä½äº &lt;code&gt;libmath.h&lt;/code&gt; å’Œ &lt;code&gt;libprint.h&lt;/code&gt;ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå„ä¸ªæºæ–‡ä»¶å¯ä»¥å„è‡ªå•ç‹¬ç¼–è¯‘ï¼Œç”šè‡³å¤šä¸ªæºæ–‡ä»¶å¯ä»¥å¹¶è¡Œç¼–è¯‘çš„åŸå› ï¼ˆæƒ³ä¸€æƒ³å¹³æ—¶è¾“å…¥çš„ç±»ä¼¼ &lt;code&gt;$ make -j $(nproc)&lt;/code&gt; è¿™æ ·çš„å‘½ä»¤ï¼Œå®ƒè¡¨ç¤ºæœ‰å¤šæ¡è¿›ç¨‹å¹¶è¡Œç¼–è¯‘å“¦ï¼‰ã€‚&lt;/p&gt;&lt;h3 id=&#34;æ‰“åŒ…ç›®æ ‡æ–‡ä»¶&#34;&gt;æ‰“åŒ…ç›®æ ‡æ–‡ä»¶&lt;/h3&gt;&lt;p&gt;å¯ä»¥æ‰“åŒ…å¤šä¸ª &lt;em&gt;ç›®æ ‡æ–‡ä»¶&lt;/em&gt; ä»¥å½¢æˆä¸€ä¸ª &lt;em&gt;åº“&lt;/em&gt; æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿ä»¥åä½¿ç”¨ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢çš„å‘½ä»¤å°† &lt;code&gt;liba.o&lt;/code&gt; å’Œ &lt;code&gt;libb.o&lt;/code&gt; æ‰“åŒ…ä¸º &lt;code&gt;libmath.a&lt;/code&gt;ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-ar -crs libmath.a liba.o libb.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å‚æ•°ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;-c&lt;/code&gt; å¦‚æœé™æ€åº“æ–‡ä»¶å·²å­˜åœ¨ä¹Ÿä¸å‘å‡ºè­¦å‘Šæç¤ºã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;-r&lt;/code&gt; è¡¨ç¤ºæ›¿æ¢é™æ€åº“ä¸­å·²å­˜åœ¨çš„æºç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…æ’å…¥æ–°çš„æºç›®æ ‡æ–‡ä»¶ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;-s&lt;/code&gt; è¡¨ç¤ºä¸ºé™æ€åº“åˆ›å»ºç´¢å¼•ï¼Œç›¸å½“äºåˆ›å»ºå®Œé™æ€åº“ä¹‹åæ‰§è¡Œäº†ä¸€æ¬¡ &lt;code&gt;$ riscv64-elf-ranlib libmath.a&lt;/code&gt; å‘½ä»¤ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å‘½ä»¤è¿è¡Œä¹‹åå°†å¾—åˆ°åŒ…æ–‡ä»¶ &lt;code&gt;libmath.a&lt;/code&gt;ï¼ˆä¸€èˆ¬ç§°ä¸º &lt;em&gt;é™æ€åº“&lt;/em&gt;ï¼‰ã€‚ç¨‹åº &lt;code&gt;riscv64-elf-ar&lt;/code&gt; é™¤äº†å¯ä»¥åˆ›å»ºåŒ…æ–‡ä»¶ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹æˆ–è€…ä¿®æ”¹åŒ…æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸‹é¢çš„å‘½ä»¤ç”¨äºæŸ¥çœ‹åŒ…æ–‡ä»¶é‡Œå«æœ‰å“ªäº›ç›®æ ‡æ–‡ä»¶ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-ar -t libmath.a&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;liba.o&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;libb.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒ…æ–‡ä»¶ä¹Ÿèƒ½å¤Ÿä½¿ç”¨ &lt;code&gt;riscv64-elf-nm&lt;/code&gt; ç¨‹åºåˆ—å‡ºç¬¦å·åˆ—è¡¨ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-nm libmath.a&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;liba.o:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000000 T add&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;libb.o:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 U add&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000000 T add10&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ç„¶ä¹Ÿèƒ½ç”¨ &lt;code&gt;riscv64-elf-objdump&lt;/code&gt; åæ±‡ç¼–åŒ…æ–‡ä»¶ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-objdump -d libmath.a&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºï¼ˆéƒ¨åˆ†ï¼‰ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;In archive libmath.a:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;liba.o:     file format elf64-littleriscv&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Disassembly of section .text:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000000 &amp;lt;add&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   0:   1101                    addi    sp,sp,-32&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  26:   6105                    addi    sp,sp,32&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  28:   8082                    ret&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;libb.o:     file format elf64-littleriscv&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Disassembly of section .text:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000000 &amp;lt;add10&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   0:   1101                    addi    sp,sp,-32&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  26:   6105                    addi    sp,sp,32&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  28:   8082                    ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡åæ±‡ç¼–ä¼šå‘ç°ï¼ŒåŒ…æ–‡ä»¶ï¼ˆå³é™æ€åº“ï¼‰ä»…ä»…æ˜¯æŠŠåŸå…ˆçš„å¤šä¸ªç›®æ ‡æ–‡ä»¶ &lt;strong&gt;åŸæ ·&lt;/strong&gt; åˆå¹¶èµ·æ¥ï¼Œå…¶ä¸­çš„å†…å®¹å‡æœªæ”¹å˜ã€‚è¿™è·Ÿé“¾æ¥ç¨‹åºæŠŠå¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥èµ·æ¥çš„æƒ…å†µä¸åŒï¼Œé“¾æ¥ç¨‹åºä¼šä¿®æ”¹éƒ¨åˆ†å†…å®¹ï¼ˆä¸»è¦æ˜¯ä¼šè§£å†³å„ä¸ªç¬¦å·çš„åœ°å€ï¼Œæœ¬é¡¹ç›®çš„å…¶å®ƒæ–‡ç« ä¼šè®²è§£ï¼‰ã€‚&lt;/p&gt;&lt;h3 id=&#34;é“¾æ¥&#34;&gt;é“¾æ¥&lt;/h3&gt;&lt;p&gt;ç”±äºå½“å‰è¿™ä¸ªç¨‹åºæ˜¯ä¸€ä¸ªè£¸æœºç¨‹åºï¼Œè€Œä¸” QEMU RISC-V å¯¹ç¨‹åºçš„å…¥å£åœ°å€æœ‰è¦æ±‚ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨é»˜è®¤çš„é“¾æ¥è„šæœ¬æ¥é“¾æ¥ç›®æ ‡æ–‡ä»¶ï¼Œç›®å½• &lt;a href=&#34;./resources/bare-metal/&#34;&gt;resources/bare-metal&lt;/a&gt; é‡Œæœ‰é“¾æ¥è„šæœ¬ &lt;code&gt;app.lds&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;OUTPUT_ARCH(riscv)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ENTRY(_start)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;BASE_ADDRESS = 0x80000000;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;SECTIONS&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  . = BASE_ADDRESS;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .text : {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.text.entry)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.text .text.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .rodata : {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.rodata .rodata.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  . = ALIGN(4096);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .data : {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.sdata .sdata.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.data .data.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .bss :{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.sbss .sbss.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.bss .bss.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  . = ALIGN(8);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  /* a 4KB stack */&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  stack_bottom = .;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  . += 4096;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  stack_top = .;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰å…³é“¾æ¥è„šæœ¬çš„å…·ä½“å†…å®¹å¯ä»¥å‚é˜… &lt;a href=&#34;https://sourceware.org/binutils/docs/ld/Scripts.html&#34;&gt;Linker Scripts&lt;/a&gt; æˆ–è€… &lt;a href=&#34;https://blog.csdn.net/m0_47799526/article/details/108765403&#34;&gt;ä¸­æ–‡ç¿»è¯‘ç‰ˆ&lt;/a&gt; ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢å°† &lt;code&gt;app_startup.o&lt;/code&gt;ï¼Œ&lt;code&gt;app.o&lt;/code&gt;ï¼Œ&lt;code&gt;libmath.a&lt;/code&gt;ï¼Œ&lt;code&gt;libprint.o&lt;/code&gt; å’Œ &lt;code&gt;put_char.o&lt;/code&gt; é“¾æ¥èµ·æ¥ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-ld -T app.lds -o app.out app_startup.o app.o libmath.a libprint.o put_char.o&lt;/code&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-T app.lds&lt;/code&gt; è¡¨ç¤ºä½¿ç”¨æŒ‡å®šçš„é“¾æ¥è„šæœ¬ &lt;code&gt;app.lds&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-o app.out&lt;/code&gt; æŒ‡ç¤ºè¾“å‡ºçš„æ–‡ä»¶åã€‚&lt;/li&gt;&lt;li&gt;å‚æ•° &lt;code&gt;app_startup.o app.o libmath.a libprint.o put_char.o&lt;/code&gt; è¡¨ç¤ºå¾…é“¾æ¥çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆå‹æƒ…æç¤ºï¼šæ–‡ä»¶åˆ—è¡¨å°½é‡æŒ‰ç…§è¿™æ ·çš„é¡ºåºåˆ—å‡ºï¼šè¢«ä¾èµ–çš„æ–‡ä»¶æ’åœ¨åé¢ã€‚æœ‰æ—¶ç¼–è¯‘å™¨ä¼šå› ä¸ºé¡ºåºé—®é¢˜è€Œå‡ºç°è«åå…¶å¦™çš„é”™è¯¯ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é“¾æ¥å‘½ä»¤ä¸­çš„å‚æ•° &lt;code&gt;libmath.a&lt;/code&gt; æ˜¯é™æ€åº“æ–‡ä»¶ï¼Œå¯è§å…¶å®é™æ€åº“æ–‡ä»¶å¯ä»¥ç®€åŒ–é“¾æ¥å‘½ä»¤ï¼ˆå‡è®¾é™æ€åº“æ˜¯ç”±éå¸¸å¤šçš„ç›®æ ‡æ–‡ä»¶ç»„æˆçš„è¯ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å‘½ä»¤è¿è¡Œä¹‹åå¾—åˆ° ELF æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;è¿è¡Œ-1&#34;&gt;è¿è¡Œ&lt;/h3&gt;&lt;p&gt;ä¸‹é¢ä½¿ç”¨ QEMU çš„ &lt;em&gt;ç³»ç»Ÿæ¨¡å¼&lt;/em&gt; è¿è¡Œè¯¥æ–‡ä»¶ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ qemu-system-riscv64 &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -machine virt &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -nographic &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -bios none &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -kernel app.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æ— æ„å¤–ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æ­£ç¡®çš„è¾“å‡ºç»“æœï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Hello world!&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;8&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;13&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŒ‰ &lt;code&gt;Ctrl+a&lt;/code&gt;ï¼Œå†æŒ‰ &lt;code&gt;x&lt;/code&gt; ç»“æŸ QEMU æ¨¡æ‹Ÿç¨‹åºã€‚&lt;/p&gt;&lt;p&gt;ä¸‹ä¸€ç¯‡æ–‡ç«  &lt;a href=&#34;../build-risc-v-program-from-assembly-code/README.zh-Hans.md&#34;&gt;é€šè¿‡æ±‡ç¼–ä»£ç æ„å»º RISC-V ç¨‹åº&lt;/a&gt; æˆ‘ä»¬å°†ä¼šè®²è§£ RISC-V ç¨‹åºçš„ç»„æˆå’Œè¿è¡ŒåŸç†ã€‚&lt;/p&gt;</description>
     </item>
   
     <item>
       <title></title>
       <link>https://hemashushu.github.io/posts/2022-11-07-build-minimal-risc-v-program/readme/</link>
       <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
       
       <guid>https://hemashushu.github.io/posts/2022-11-07-build-minimal-risc-v-program/readme/</guid>
       <description>&lt;h1 id=&#34;building-risc-v-program-from-assembly-code&#34;&gt;Building RISC-V Program from Assembly Code&lt;/h1&gt;</description>
     </item>
   
     <item>
       <title></title>
       <link>https://hemashushu.github.io/posts/2022-11-07-build-minimal-risc-v-program/readme.zh-hans/</link>
       <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
       
       <guid>https://hemashushu.github.io/posts/2022-11-07-build-minimal-risc-v-program/readme.zh-hans/</guid>
       <description>&lt;h1 id=&#34;æ„å»ºæœ€å°çš„-risc-v-ç¨‹åº&#34;&gt;æ„å»ºæœ€å°çš„ RISC-V ç¨‹åº&lt;/h1&gt;&lt;p&gt;åœ¨&lt;a href=&#34;../risc-v-gcc-quick-start/README.zh-Hans.md&#34;&gt;ä¸Šä¸€ç¯‡æ–‡ç« &lt;/a&gt;æˆ‘ä»¬ç®€å•åœ°äº†è§£äº†äº¤å‰ç¼–è¯‘å·¥å…· RISC-V GCC çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚è¿™ç¯‡æ–‡ç« å°†ä¼šä»¥çº¯æ±‡ç¼–æ„å»ºä¸¤ä¸ªç¨‹åºï¼šä¸€ä¸ªæœ€å°çš„è£¸æœºç¨‹åºå’Œä¸€ä¸ªæœ€å°çš„ Linux åº”ç”¨ç¨‹åºã€‚ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦ç›´æ¥ä½¿ç”¨æ±‡ç¼–å†™ç¨‹åºï¼Œä½†é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥æ’é™¤ä¸ç›¸å…³çš„å†…å®¹ï¼Œä»¥äº†è§£ä¸€ä¸ª RISC-V ç¨‹åºçš„æœ€æ ¹æœ¬çš„ç»„æˆå’Œè¿è¡Œçš„åŸç†ã€‚&lt;/p&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E6%9C%80%E5%B0%8F%E7%9A%84%E8%A3%B8%E6%9C%BA%E7%A8%8B%E5%BA%8F&#34;&gt;æœ€å°çš„è£¸æœºç¨‹åº&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E6%BA%90%E4%BB%A3%E7%A0%81&#34;&gt;æºä»£ç &lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%B1%87%E7%BC%96&#34;&gt;æ±‡ç¼–&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6&#34;&gt;ç›®æ ‡æ–‡ä»¶&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B&#34;&gt;æ–‡ä»¶ç±»å‹&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%AC%A6%E5%8F%B7%E5%88%97%E8%A1%A8&#34;&gt;ç¬¦å·åˆ—è¡¨&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%AE%B5&#34;&gt;æ®µ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%AE%B5%E7%9A%84%E5%A4%A7%E5%B0%8F&#34;&gt;æ®µçš„å¤§å°&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%8F%8D%E6%B1%87%E7%BC%96&#34;&gt;åæ±‡ç¼–&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E9%93%BE%E6%8E%A5&#34;&gt;é“¾æ¥&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B-1&#34;&gt;æ–‡ä»¶ç±»å‹&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%AC%A6%E5%8F%B7%E5%88%97%E8%A1%A8-1&#34;&gt;ç¬¦å·åˆ—è¡¨&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%AE%B5-1&#34;&gt;æ®µ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#program-headers&#34;&gt;Program Headers&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%AE%B5%E5%A4%A7%E5%B0%8F&#34;&gt;æ®µå¤§å°&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%BF%90%E8%A1%8C&#34;&gt;ç¬¬ä¸€æ¬¡è¿è¡Œ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E9%93%BE%E6%8E%A5%E8%84%9A%E6%9C%AC&#34;&gt;é“¾æ¥è„šæœ¬&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%BF%90%E8%A1%8C&#34;&gt;ç¬¬äºŒæ¬¡è¿è¡Œ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%BB%99%E7%A8%8B%E5%BA%8F%E5%87%8F%E8%82%A5&#34;&gt;ç»™ç¨‹åºå‡è‚¥&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%AC%AC%E4%B8%89%E6%AC%A1%E8%BF%90%E8%A1%8C&#34;&gt;ç¬¬ä¸‰æ¬¡è¿è¡Œ&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E6%9C%80%E5%B0%8F%E7%9A%84-linux-%E7%A8%8B%E5%BA%8F&#34;&gt;æœ€å°çš„ Linux ç¨‹åº&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8&#34;&gt;ç³»ç»Ÿè°ƒç”¨&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E7%9A%84%E5%AE%9E%E7%8E%B0&#34;&gt;ç³»ç»Ÿè°ƒç”¨çš„å®ç°&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81&#34;&gt;ç¨‹åºçš„æºä»£ç &lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%BC%96%E8%AF%91&#34;&gt;ç¼–è¯‘&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%BF%90%E8%A1%8C&#34;&gt;è¿è¡Œ&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;!-- raw HTML omitted --&gt;&lt;h2 id=&#34;æœ€å°çš„è£¸æœºç¨‹åº&#34;&gt;æœ€å°çš„è£¸æœºç¨‹åº&lt;/h2&gt;&lt;p&gt;æœ¬ç« æ¼”ç¤ºçš„æ˜¯ä¸€ä¸ªæœ€ç»ˆåªæœ‰å¤§çº¦ 30 ä¸ªå­—èŠ‚çš„ RISC-V è£¸æœºç¨‹åºï¼Œè¯¥ç¨‹åºç”¨çº¯æ±‡ç¼–å†™ï¼ŒåŠŸèƒ½ä¹Ÿéå¸¸ç®€å•ï¼Œå°±æ˜¯å‘ä¸²å£æ‰“å°ä¸€ä¸ªå¤§å†™çš„å­—æ¯ &amp;ldquo;A&amp;rdquo;ï¼Œç„¶åè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ã€‚&lt;/p&gt;&lt;h3 id=&#34;æºä»£ç &#34;&gt;æºä»£ç &lt;/h3&gt;&lt;p&gt;æºä»£ç ä½äºç›®å½• &lt;a href=&#34;./resources/minimal-bare-metal/&#34;&gt;resouces/minimal-bare-metal&lt;/a&gt; ä¹‹ä¸‹çš„æ–‡ä»¶ &lt;code&gt;app.S&lt;/code&gt;ï¼ˆæ³¨æ„æ‰©å±•åä¸ºå¤§å†™çš„å­—æ¯ &lt;code&gt;S&lt;/code&gt;ï¼Œè·Ÿå°å†™ &lt;code&gt;s&lt;/code&gt; çš„åŒºåˆ«åœ¨äºå¤§å†™ &lt;code&gt;S&lt;/code&gt; è¡¨ç¤ºéœ€è¦é¢„å¤„ç†ï¼Œä¸€èˆ¬æˆ‘ä»¬æ‰‹å†™çš„æ±‡ç¼–æºä»£ç æ–‡ä»¶çš„æ‰©å±•åå»ºè®®ä½¿ç”¨å¤§å†™å­—æ¯ &lt;code&gt;S&lt;/code&gt;ï¼‰ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-s&#34; data-lang=&#34;s&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ VIRT_UART0, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x10000000&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.section .text.entry&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.globl _start&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.globl _print_a&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;_start&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    call _print_a&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;_loop&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    nop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    j _loop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;_print_a&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li s1, VIRT_UART0   &lt;span style=&#34;color:#75715e&#34;&gt;# set s1 = 0x1000_0000&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li s2, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x41&lt;/span&gt;         &lt;span style=&#34;color:#75715e&#34;&gt;# set s2 = 0x41&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sb s2, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;(s1)        &lt;span style=&#34;color:#75715e&#34;&gt;# store s2 (as byte) to memory[s1+0]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#75715e&#34;&gt;# address 0x1000_0000 is mapped to UART0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#75715e&#34;&gt;# checkout QEMU source https://github.com/qemu/qemu/blob/master/hw/riscv/virt.c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol&gt;&lt;li&gt;ç¨‹åºçš„ç¬¬ 1 è¡Œç”¨äºæŒ‡å®šæ¥ä¸‹æ¥çš„æ±‡ç¼–çš„ç»“æœæ”¾åœ¨ç›®æ ‡æ–‡ä»¶çš„å“ªä¸ªæ®µã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ±‡ç¼–ä»£ç ç»è¿‡æ±‡ç¼–ä¹‹åä¼šç”Ÿæˆä¸€ç³»åˆ—å¹³é“ºçš„ã€æ— ç»“æ„çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯ç±»ä¼¼ &amp;ldquo;101000110010&amp;hellip;&amp;rdquo; è¿™æ ·é•¿é•¿çš„ä¸€ä¸²äºŒè¿›åˆ¶æ•°å­—ï¼Œä¸ºäº†ä¾¿äºé˜…è¯»ï¼Œæœ‰æ—¶ä¹Ÿä¼šä»¥åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œæ¯”å¦‚ &amp;ldquo;A3 20 65 66 &amp;hellip;&amp;quot;ï¼Œæ— è®ºå“ªç§è¡¨ç¤ºå½¢å¼ï¼Œæœ¬è´¨éƒ½æ˜¯ä¸€æ ·çš„ã€‚è€Œæ±‡ç¼–ä»£ç åˆ™å¤§çº¦ç›¸å½“äºè¿™äº›äºŒè¿›åˆ¶æ•°æ®çš„æ–‡æœ¬æ ¼å¼ï¼Œå¾ˆå¤šæ±‡ç¼–è¯­å¥è·Ÿæœºå™¨æŒ‡ä»¤æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œæ±‡ç¼–å™¨çš„ä»»åŠ¡å¤§è‡´ä¸Šæ˜¯å°† &amp;ldquo;æ–‡æœ¬æ ¼å¼çš„æŒ‡ä»¤å’Œæ•°æ®&amp;rdquo; ç¿»è¯‘æˆ &amp;ldquo;äºŒè¿›åˆ¶æ ¼å¼çš„æŒ‡ä»¤å’Œæ•°æ®&amp;rdquo;ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/assembler.png&#34; alt=&#34;assembler&#34;&gt;&lt;/p&gt;&lt;p&gt;è¿™äº›æ•°æ®ä¸­æœ‰äº›æ˜¯ï¼ˆäºŒè¿›åˆ¶å½¢å¼ï¼‰æœºå™¨æŒ‡ä»¤ï¼Œæœ‰äº›æ˜¯ç¨‹åºä¸­çš„è¯¸å¦‚æ•´æ•°å¸¸é‡ã€å­—ç¬¦ä¸²å¸¸é‡ç­‰ï¼Œæ±‡ç¼–å™¨æ ¹æ®æ•°æ®çš„æ€§è´¨åˆ†æ®µå‚¨å­˜åœ¨æ±‡ç¼–å™¨çš„è¾“å‡ºæ–‡ä»¶ï¼ˆç§°ä¸º &lt;em&gt;ç›®æ ‡æ–‡ä»¶&lt;/em&gt;ï¼‰å½“ä¸­ã€‚ä¸€ä¸ªå…¸å‹çš„ç›®æ ‡æ–‡ä»¶æœ‰ &lt;code&gt;.text&lt;/code&gt;, &lt;code&gt;.rodata&lt;/code&gt;, &lt;code&gt;.data&lt;/code&gt;, &lt;code&gt;.bss&lt;/code&gt; ç­‰æ®µï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æŒ‡ä»¤åºåˆ—ã€åªè¯»æ•°æ®ï¼ˆæ¯”å¦‚æ•°å­—å’Œå­—ç¬¦ä¸²å¸¸é‡ï¼‰ã€æ•°æ®ï¼ˆå…¨å±€å˜é‡ï¼‰ã€æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼ˆæˆ–è€…åˆå§‹å€¼ä¸º 0 çš„å…¨å±€å˜é‡ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/object-file.png&#34; alt=&#34;object file&#34;&gt;&lt;/p&gt;&lt;p&gt;ä¸ºäº†ç»†åŒ–ç®¡ç†ï¼Œæ¯ä¸ªæ®µåˆå¯ä»¥ç»†åˆ†ä¸ºå¤šä¸ªå­æ®µï¼Œå­æ®µçš„åå­—å¯ä»¥éšæ„å‘½åï¼Œä¸è¿‡æœ‰äº›æ˜¯çº¦å®šä¿—ç§°çš„ï¼ˆä»¥åçš„æ–‡ç« ä¼šè®²è§£ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸Šé¢ç¤ºä¾‹ç¨‹åºä¸­çš„ &lt;code&gt;.text.entry&lt;/code&gt; è¡¨ç¤º &lt;code&gt;.text&lt;/code&gt; æ®µé‡Œé¢çš„ä¸€ä¸ªå«åš &lt;code&gt;.entry&lt;/code&gt; çš„å­æ®µï¼Œè¯¥åå­—æ˜¯æˆ‘éšæ„èµ·çš„ã€‚&lt;/p&gt;&lt;ol start=&#34;2&#34;&gt;&lt;li&gt;&lt;p&gt;æ¥ä¸‹æ¥çš„ä¸¤å¥ &lt;code&gt;.globl&lt;/code&gt; è¡¨ç¤ºå¯¼å‡ºä¸¤ä¸ª &lt;em&gt;ç¬¦å·&lt;/em&gt;ï¼Œ&lt;code&gt;.globl&lt;/code&gt; å…³é”®å­—åé¢è·Ÿç€çš„æ˜¯æ ‡ç­¾çš„åç§°ï¼Œä¸‹é¢ä¼šè®²è§£ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;_start&lt;/code&gt; æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œæ ‡ç­¾å®è´¨ä¸Šæ˜¯ä¸€ä¸ªåœ°å€å€¼ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ­£å¦‚ä¸Šé¢çš„ç¬¬ 1 æ®µæ‰€è¯´ï¼Œç›®æ ‡æ–‡ä»¶æ˜¯ä¸€è¿ä¸²äºŒè¿›åˆ¶æ•°æ®ï¼Œè™½ç„¶äººç±»æ— æ³•ç›´æ¥é˜…è¯»ï¼Œä½†æˆ‘ä»¬çŸ¥é“å…¶å®æ¯ä¸ªæ•°å­—éƒ½æœ‰å…·ä½“å«ä¹‰çš„ï¼Œå› æ­¤æˆ‘ä»¬ä»¥ &lt;em&gt;å­—èŠ‚&lt;/em&gt; ä¸ºå•ä½ï¼Œç»™æ®µé‡Œé¢çš„æ•°æ®åŠ ä¸Šä¸€è¿ä¸²å‡æƒ³çš„åºå·ï¼Œè¿™ä¸ªåºå·å°±æ˜¯ &lt;em&gt;åœ°å€&lt;/em&gt;ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥ç”¨åœ°å€æ¥å®šä½æ¯ä¸€ä¸ªæ•°æ®äº†ã€‚&lt;/p&gt;&lt;p&gt;ä½†æœ‰æ—¶ç›´æ¥ç”¨æ•°å­—åœ°å€ä¸å¤Ÿç›´è§‚ï¼Œæ‰€ä»¥åˆæœ‰äº† &lt;em&gt;æ ‡ç­¾&lt;/em&gt;ã€‚æˆ‘ä»¬ç»™æŸäº›ç‰¹æ®Šçš„åœ°å€åŠ ä¸Šæ ‡ç­¾ï¼Œæ¯”å¦‚åœ¨ä¸Šé¢çš„ç¨‹åºå½“ä¸­ï¼Œç»™ &lt;code&gt;0x0008&lt;/code&gt; åŠ ä¸Šåä¸º &lt;code&gt;_loop&lt;/code&gt; çš„æ ‡ç­¾ï¼Œç»™ &lt;code&gt;0x0010&lt;/code&gt; åŠ ä¸Šåä¸º &lt;code&gt;_print_a&lt;/code&gt; æ ‡ç­¾ï¼Œè¿™æ ·æ¯å½“ç¨‹åºéœ€æ±‚è·³è½¬åˆ°è¿™ä¸¤ä¸ªä½ç½®æ—¶ï¼Œå°±ä¸ç”¨å†™ &lt;code&gt;0x0008&lt;/code&gt; å’Œ &lt;code&gt;0x0010&lt;/code&gt;ï¼Œè€Œæ˜¯å†™æˆ &lt;code&gt;_loop&lt;/code&gt; å’Œ &lt;code&gt;_print_a&lt;/code&gt;ï¼Œæ˜¾ç„¶ç”¨æ ‡ç­¾æ¥è¡¨ç¤ºä¸€ä¸ªåœ°å€æ›´ç›´è§‚ã€‚&lt;/p&gt;&lt;p&gt;æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä¹¦å†™æ±‡ç¼–æ–‡æœ¬æ—¶ï¼Œå…¶å®è¿˜ä¸çŸ¥é“æ¯ä¸ªæŒ‡ä»¤æœ€åè¢«ç¼–è¯‘ä¹‹åçš„åœ°å€ï¼Œæ‰€ä»¥éœ€è¦ç”¨æ ‡ç­¾æ¥ä»£è¡¨ç¨‹åºå½“ä¸­çš„ä¸€ä¸ªä½ç½®ã€‚&lt;/p&gt;&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œæœ‰ä¸¤ç§æƒ…å†µéœ€è¦ç”¨åˆ°æ ‡ç­¾ï¼š&lt;/p&gt;&lt;p&gt;a. ç”¨äºæ„å»ºä¸€ä¸ªå‡½æ•°ï¼Œé€šå¸¸ä¸€ä¸ªå‡½æ•°ç”± &amp;ldquo;ä¸€ä¸ªæ ‡ç­¾&amp;rdquo; + &amp;ldquo;ä¸€ç³»åˆ—æŒ‡ä»¤&amp;rdquo; + &amp;ldquo;ä¸€ä¸ªè¿”å›æŒ‡ä»¤&amp;rdquo; ç»„æˆï¼Œæ­¤æ—¶æ ‡ç­¾çš„åç§°å°±æ˜¯å‡½æ•°çš„åç§°ã€‚b. ç”¨äºæ„å»ºæµç¨‹æ§åˆ¶ç»“æ„ï¼Œæ¯”å¦‚æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥ç­‰ï¼Œå…¶å®éƒ½æ˜¯é€šè¿‡ &amp;ldquo;æ ‡ç­¾&amp;rdquo; + &amp;ldquo;è·³è½¬æŒ‡ä»¤&amp;rdquo; ç»„æˆã€‚&lt;/p&gt;&lt;ol start=&#34;4&#34;&gt;&lt;li&gt;&lt;code&gt;_loop&lt;/code&gt; æ ‡ç­¾ä»¥åŠå®ƒåé¢çš„ä¸¤ä¸ªæŒ‡ä»¤ç”¨äºå½¢æˆäº†ä¸€ä¸ªæ— é™å¾ªç¯ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ— é™å¾ªç¯å‘¢ï¼Ÿè¿™éœ€è¦ä»æœºå™¨æ˜¯å¦‚ä½•æ‰§è¡ŒæŒ‡ä»¤åºåˆ—è¯´èµ·ã€‚ä»å¤„ç†å™¨çš„è§’åº¦æ¥çœ‹ï¼Œæœºå™¨æŒ‡ä»¤åºåˆ—æ˜¯æ²¡æœ‰å‡½æ•°æ¦‚å¿µï¼Œè¿è¡Œç¨‹åºçš„æœ¬è´¨æ˜¯å°†ç¨‹åºçš„ä¸€æ¡é•¿é•¿çš„äºŒè¿›åˆ¶æŒ‡ä»¤åºåˆ—åŠ è½½è¿›å†…å­˜ï¼Œç„¶åä»ç¬¬ä¸€ä¸ªæŒ‡ä»¤å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¸€ä¸ªæŒ‡ä»¤å°±æŒ‡å‘ä¸‹ä¸€ä¸ªæŒ‡ä»¤ï¼Œå‡å¦‚ç¨‹åºå½“ä¸­æ²¡æœ‰è·³è½¬æŒ‡ä»¤çš„è¯ï¼Œåˆ™ä¼šä¸€ç›´æ‰§è¡Œåˆ°æœ€åä¸€ä¸ªæŒ‡ä»¤ã€‚å‡å¦‚æœ€åä¸€ä¸ªæŒ‡ä»¤åé¢è¿˜æœ‰å†…å­˜ç©ºé—´ï¼Œåˆ™ä¼šä¸€ç›´æ‰§è¡Œåˆ°å†…å­˜çš„å°½å¤´ï¼ˆå°½ç®¡è¿™äº›ç©ºé—´é‡Œä¸æ˜¯æœ‰æ•ˆçš„æŒ‡ä»¤ï¼Œåªè¦ä¸å‡ºé”™åˆ™å¤„ç†å™¨ä»ç„¶ä¼šæ‰§è¡Œï¼‰ã€‚å¤„ç†å™¨å°±åƒä¸€ä¸ªè’™ç€çœ¼ç›æ‚ç€è€³æœµçš„å›ºæ‰§å¸æœºï¼Œåªè¦è·¯å’Œæ±½æ²¹è¿˜æœ‰ï¼Œåªè¦æ²¡æ’ä¸Šéšœç¢ç‰©ï¼Œä»–å°±ä¸€ç›´é©±ä½¿ç€è½¦å‰è¿›ã€‚&lt;/p&gt;&lt;p&gt;æ˜¾ç„¶ä»å¤„ç†å™¨æˆ–è€…æŒ‡ä»¤åºåˆ—çš„è§’åº¦æ¥çœ‹ï¼Œç»“æ„ä¹‹é—´ã€å‡½æ•°ä¹‹é—´æ ¹æœ¬æ²¡æœ‰è¾¹ç•Œã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦çº¦å®šï¼šä¸€ä¸ªå‡½æ•°ä»¥æŸä¸ªåœ°å€å¼€å§‹ï¼Œè¿™ä¸ªåœ°å€éœ€è¦åŠ ä¸Šæ ‡ç­¾ï¼ˆä¸€èˆ¬æ ‡ç­¾åå°±æ˜¯å‡½æ•°åï¼‰ï¼Œç„¶åä»¥ä¸€ä¸ªè¿”å›æŒ‡ä»¤ï¼ˆ&lt;code&gt;ret&lt;/code&gt; æŒ‡ä»¤ï¼‰ä»¥æ­¤è¡¨ç¤ºå‡½æ•°ç»“æŸã€‚&lt;/p&gt;&lt;p&gt;ç„¶åå›è¿‡å¤´æ¥çœ‹å‡½æ•° &lt;code&gt;_start&lt;/code&gt;ï¼Œå®ƒçš„å·¥ä½œæ˜¯è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•° &lt;code&gt;_print_a&lt;/code&gt;ï¼Œè°ƒç”¨å®Œæ¯•ä¹‹åï¼Œç¨‹åºçš„æ‰€æœ‰ä»»åŠ¡å°±å…¨éƒ¨å®Œæˆäº†ã€‚ä¸è¿‡ &lt;code&gt;_start&lt;/code&gt; å‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ï¼Œæ˜¯ä¸€åˆ‡çš„å¼€ç«¯ï¼Œæ˜¾ç„¶å®ƒæ²¡æœ‰è°ƒç”¨è€…ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æ³•åœ¨è¯¥å‡½æ•°çš„å·¥ä½œå®Œæˆä¹‹åä½¿ç”¨ &lt;code&gt;ret&lt;/code&gt; æŒ‡ä»¤è¿”å›ã€‚ä¸ºäº†é˜²æ­¢å¤„ç†å™¨åœ¨æ‰§è¡Œå®Œ &lt;code&gt;_start&lt;/code&gt; å‡½æ•°ä¹‹åç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåªå¥½åœ¨å‡½æ•°çš„æœ«å°¾å¤„è®¾äº†ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œè®©å¤„ç†å™¨åœ¨è¿™é‡ŒåŸåœ°æ‰“è½¬ï¼ˆè™½ç„¶è¿™ä¸ªæ–¹æ³•ä¼¼ä¹ä¸æ€ä¹ˆä¼˜é›…ï¼‰ã€‚&lt;/p&gt;&lt;ol start=&#34;5&#34;&gt;&lt;li&gt;&lt;code&gt;_print_a&lt;/code&gt; æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„å‡½æ•°çš„åç§°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨æ˜¯æŠŠ byte ç±»å‹çš„æ•´æ•° &lt;code&gt;0x41&lt;/code&gt;ï¼ˆå³å¤§å†™å­—æ¯ &lt;code&gt;A&lt;/code&gt; å¯¹åº”çš„ ASCII å·ç ï¼‰å†™å…¥å†…å­˜åœ°å€ &lt;code&gt;0x1000_0000&lt;/code&gt;ï¼Œè¿™ä¸ªå†…å­˜åœ°å€è¢«æ˜ å°„åˆ° UART ç«¯å£ï¼ˆç±»ä¼¼ä¸²å£æ§åˆ¶å°ï¼Œå³ Serial Consoleï¼‰ï¼ŒQEMU çš„ UART è¢«é‡å®šå‘åˆ°è™šæ‹Ÿç»ˆç«¯ï¼Œæ‰€ä»¥å®é™…ä¸Šå°±æ˜¯å‘è™šæ‹Ÿç»ˆç«¯è¾“å‡ºäº†ä¸€ä¸ªå¤§å†™å­—æ¯ &lt;code&gt;A&lt;/code&gt;ï¼Œ&lt;code&gt;_print_a&lt;/code&gt; å‡½æ•°çš„æœ€åä¸€å¥æ˜¯ &lt;code&gt;ret&lt;/code&gt; æŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯è¿”å›åˆ°è°ƒç”¨å‡½æ•°æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;&lt;p&gt;æ±‡ç¼–æºä»£ç å½“ä¸­ &lt;code&gt;#&lt;/code&gt; ç¬¦å·ä»¥åŠå®ƒåé¢çš„æ–‡æœ¬è¡¨ç¤ºæ³¨é‡Šã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&#34;æ±‡ç¼–&#34;&gt;æ±‡ç¼–&lt;/h3&gt;&lt;p&gt;ä¸‹é¢ä½¿ç”¨ RISC-V GCC æ±‡ç¼–å™¨ &lt;code&gt;riscv64-elf-as&lt;/code&gt; ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-as -g -o app.o app.S&lt;/code&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-g&lt;/code&gt; è¡¨ç¤ºåŒæ—¶ç”Ÿæˆä¾› GDB ä½¿ç”¨çš„é¢å¤–è°ƒè¯•ä¿¡æ¯è°ƒè¯•ä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;å‚æ•° &lt;code&gt;-o app.o&lt;/code&gt; ç”¨äºæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ï¼ˆæ³¨æ„ï¼Œåœ¨é˜…è¯»å’Œç†è§£è¿™æ¡å‘½ä»¤æ—¶ï¼Œéœ€è¦æŠŠè¿™ä¸ªå‚æ•°å’Œå€¼çš„ç»„åˆè§†ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œåé¢çš„ &lt;code&gt;a.S&lt;/code&gt; ä¸å±äºè¿™ä¸ªå‚æ•°çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;å‚æ•° &lt;code&gt;a.S&lt;/code&gt; è¡¨ç¤ºæºæ–‡ä»¶çš„åç§°è·¯å¾„ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;å›  Linux å‘è¡Œç‰ˆçš„ä¸åŒï¼ŒRISC-V GCC å·¥å…·é“¾å½“ä¸­çš„å„ä¸ªå·¥å…·çš„åç§°å‰ç¼€å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œæ¯”å¦‚ &lt;code&gt;riscv64-elf-*&lt;/code&gt; ä¼šè¢«å‘½åä¸º &lt;code&gt;riscv64-unknown-elf-*&lt;/code&gt;ã€‚å¦å¤–æ³¨æ„åŒºåˆ† &lt;code&gt;riscv64-elf-*&lt;/code&gt; å’Œ &lt;code&gt;riscv64-linux-gnu-*&lt;/code&gt;ï¼Œå‰è€…ç”¨äºç¼–è¯‘ &amp;ldquo;è£¸æœº&amp;rdquo; ç¨‹åºï¼Œåè€…ç”¨äºç¼–è¯‘åœ¨ Linux ç¯å¢ƒä¸­è¿è¡Œçš„ç¨‹åºã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;ç„¶åå°†ä¼šå¾—åˆ°æ–‡ä»¶ &lt;code&gt;app.o&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;ç›®æ ‡æ–‡ä»¶&#34;&gt;ç›®æ ‡æ–‡ä»¶&lt;/h3&gt;&lt;p&gt;ä¸‹é¢æ£€æŸ¥ç›®æ ‡æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚&lt;/p&gt;&lt;h4 id=&#34;æ–‡ä»¶ç±»å‹&#34;&gt;æ–‡ä»¶ç±»å‹&lt;/h4&gt;&lt;p&gt;å…ˆæ£€æŸ¥æ–‡ä»¶ç±»å‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ file app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app.o: ELF 64-bit LSB relocatable, UCB RISC-V, double-float ABI, version 1 (SYSV), with debug_info, not stripped&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯è§æ±‡ç¼–å™¨è¾“å‡ºçš„æ˜¯ä¸€ä¸ª ELF æ ¼å¼çš„ &lt;em&gt;å¯é‡å®šä½æ–‡ä»¶&lt;/em&gt;ï¼Œä¹Ÿå°±æ˜¯å¹³å¸¸è¯´çš„ &lt;em&gt;ç›®æ ‡æ–‡ä»¶&lt;/em&gt;ï¼Œå®ƒè¿˜ä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€‚æœ‰å…³ ELF æ ¼å¼çš„ 3 ä¸­ç±»å‹ï¼Œå¯ä»¥å‚é˜…ä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href=&#34;../risc-v-gcc-base/README.zh-Hans.md&#34;&gt;RISC-V GCC åŸºç¡€&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h4 id=&#34;ç¬¦å·åˆ—è¡¨&#34;&gt;ç¬¦å·åˆ—è¡¨&lt;/h4&gt;&lt;p&gt;æ­£å¦‚å‰é¢ç« èŠ‚æ‰€è¿°ï¼Œæ±‡ç¼–ä»£ç é‡Œä¼šæœ‰è¡¨ç¤ºåœ°å€çš„æ ‡ç­¾ï¼Œè¿™äº›æ ‡ç­¾ç»è¿‡ &lt;code&gt;.globl&lt;/code&gt; å¯¼å‡ºï¼Œå°±å½¢æˆå¯ä»¥ä¾›å¤–éƒ¨æŸ¥çœ‹çš„ &lt;code&gt;ç¬¦å·&lt;/code&gt;ï¼ˆä¸è¿‡å¹¶éæ‰€æœ‰ç¬¦å·éƒ½æ˜¯æ ‡ç­¾ï¼‰ï¼Œå¯ä»¥ç²—ç•¥åœ°æŠŠç¬¦å·ç†è§£ä¸ºå‡½æ•°åç§°æˆ–è€…å…¨å±€å˜é‡åç§°ã€‚&lt;/p&gt;&lt;p&gt;ä½¿ç”¨å·¥å…· &lt;code&gt;riscv64-elf-nm&lt;/code&gt; å¯ä»¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„å¯¼å‡ºç¬¦å·åˆ—è¡¨ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-nm app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000008 t _loop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000010 T _print_a&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000000 T _start&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å·¦è¾¹ä¸€åˆ—æ˜¯å„ä¸ªç¬¦å·çš„è™šæ‹Ÿåœ°å€ï¼Œå³è¾¹ä¸€åˆ—æ˜¯ç¬¦å·çš„åç§°ï¼Œä¸­é—´ä¸€åˆ—æ˜¯ç¬¦å·ç±»å‹çš„ä»£å·ï¼Œéƒ¨åˆ†ä»£å·çš„å«ä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;A: Global absolute symbol.&lt;/li&gt;&lt;li&gt;a: Local absolute symbol.&lt;/li&gt;&lt;li&gt;B: Global bss symbol.&lt;/li&gt;&lt;li&gt;b: Local bss symbol.&lt;/li&gt;&lt;li&gt;D: Global data symbol.&lt;/li&gt;&lt;li&gt;d: Local data symbol.&lt;/li&gt;&lt;li&gt;T: Global text symbol.&lt;/li&gt;&lt;li&gt;t: Local text symbol.&lt;/li&gt;&lt;li&gt;U: Undefined symbol.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç¬¦å·ç±»å‹ä»£å·å½“ä¸­ï¼Œå¤§å†™çš„è¡¨ç¤ºæ˜¯å¯¼å‡ºçš„ï¼ˆä¾›å¤–éƒ¨ä½¿ç”¨çš„ï¼‰ï¼Œå°å†™çš„è¡¨ç¤ºå±€éƒ¨çš„ï¼ˆä¾›å†…éƒ¨ä½¿ç”¨çš„ï¼‰ã€‚è¯¦ç»†çš„åˆ—è¡¨å¯å‚é˜… &lt;a href=&#34;https://sourceware.org/binutils/docs/binutils/index.html&#34;&gt;GNU Binary Utilities Document&lt;/a&gt; å½“ä¸­çš„ &lt;a href=&#34;https://sourceware.org/binutils/docs/binutils/nm.html&#34;&gt;nm&lt;/a&gt; ä¸€ç« ã€‚&lt;/p&gt;&lt;p&gt;ç±»å‹ &lt;code&gt;U&lt;/code&gt; æ¯”è¾ƒç‰¹æ®Šï¼Œè¡¨ç¤ºæœªå®šä¹‰çš„ç¬¦å·ã€‚æ¯”å¦‚åœ¨ä¸€ä¸ªæºä»£ç æ–‡ä»¶é‡Œï¼Œè°ƒç”¨äº†ä¸€ä¸ªå¤–éƒ¨å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå¤–éƒ¨å‡½æ•°çš„åç§°å°±æ˜¯ä¸€ä¸ªæœªå®šä¹‰çš„ç¬¦å·ã€‚å¯è§è¿™é‡Œçš„ &amp;ldquo;æœªå®šä¹‰&amp;rdquo; æ˜¯ç›¸å¯¹å½“å‰æºä»£ç æ–‡ä»¶è€Œè¨€çš„ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;GCC å·¥å…·é“¾é‡Œå¾ˆå¤šç¨‹åºä¼šæä¾›ç›¸ä¼¼çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åˆ—ç¬¦å·è¡¨çš„ç¨‹åº &lt;code&gt;nm app.o&lt;/code&gt;ï¼Œå…¶å®ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;code&gt;objdump -t app.o&lt;/code&gt; åˆ—å‡ºï¼Œè¿˜å¯ä»¥ä½¿ç”¨ &lt;code&gt;readelf --syms app.o&lt;/code&gt; åˆ—å‡ºã€‚åé¢è¿˜ä¼šçœ‹åˆ°æ›´å¤šè¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬æ ¹æ®è‡ªå·±çš„å–œå¥½å’Œä¹ æƒ¯é€‰æ‹©å³å¯ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h4 id=&#34;æ®µ&#34;&gt;æ®µ&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;riscv64-elf-objdump -h&lt;/code&gt; å¯ä»¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„æ®µä¿¡æ¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-objdump -h app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ï¼ˆéƒ¨åˆ†ï¼‰å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Idx Name          Size      VMA               LMA               File off  Algn&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  0 .text         00000020  0000000000000000  0000000000000000  00000040  2**2&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  1 .data         00000000  0000000000000000  0000000000000000  00000060  2**0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                  CONTENTS, ALLOC, LOAD, DATA&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  2 .bss          00000000  0000000000000000  0000000000000000  00000060  2**0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                  ALLOC&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;p&gt;å¦‚æœä½¿ç”¨ &lt;code&gt;-x&lt;/code&gt; å‚æ•°ï¼Œå°†ä¼šçœ‹åˆ°æ‰€æœ‰çš„æ®µï¼ŒåŒ…æ‹¬è°ƒè¯•ä¿¡æ¯çš„æ®µï¼Œä¸è¿‡ä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒè¿™äº›æ®µçš„å†…å®¹ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;.text&lt;/code&gt;, &lt;code&gt;.data&lt;/code&gt; å’Œ &lt;code&gt;.bss&lt;/code&gt; æ˜¯æ®µçš„åç§°ï¼Œ&lt;code&gt;VMA&lt;/code&gt; å’Œ &lt;code&gt;LMA&lt;/code&gt; åˆ†åˆ«è¡¨ç¤ºè™šæ‹Ÿå†…å­˜åœ°å€å’ŒåŠ è½½åœ°å€ï¼Œ&lt;code&gt;ALLOC, LOAD, READONLY, CODE&lt;/code&gt; ç­‰æ˜¯æ®µçš„æ ‡è®°ï¼Œç¨‹åºåŠ è½½å™¨ä¼šæ ¹æ®è¯¥æ ‡è®°æ¥å†³å®šå¤„ç†è¯¥æ®µçš„æ–¹å¼ã€‚&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ &lt;code&gt;ALLOC&lt;/code&gt; è¡¨ç¤ºç¨‹åºåŠ è½½å™¨éœ€è¦åˆ†é…ç©ºé—´ç»™è¯¥æ®µï¼Œ&lt;code&gt;LOAD&lt;/code&gt; è¡¨ç¤ºè¯¥æ®µéœ€è¦ä»æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œ&lt;code&gt;READONLY&lt;/code&gt; è¡¨ç¤ºè¯¥æ®µçš„å†…å®¹ä¸èƒ½è¢«å­è¿›ç¨‹ä¿®æ”¹ï¼Œ&lt;code&gt;CODE&lt;/code&gt; è¡¨ç¤ºè¯¥æ®µæ˜¯å¯æ‰§è¡Œä»£ç ï¼Œ&lt;code&gt;DATA&lt;/code&gt; è¡¨ç¤ºè¯¥æ®µæ˜¯æ•°æ®æ®µã€‚å®Œæ•´çš„æ ‡è®°åˆ—è¡¨å¯ä»¥å‚é˜… &lt;a href=&#34;https://sourceware.org/gdb/onlinedocs/gdb/Files.html&#34;&gt;GDB - section-flag&lt;/a&gt;ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;é™¤äº† &lt;code&gt;riscv64-elf-objdump -h&lt;/code&gt;ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;code&gt;riscv64-elf-readelf -S app.o&lt;/code&gt; åˆ—å‡ºç›®æ ‡æ–‡ä»¶çš„æ®µä¿¡æ¯ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;ELF çš„æ®µï¼ˆsectionï¼‰æœ‰ä¸¤ä¸ªè§†å›¾ï¼šä¸€ä¸ªæ˜¯ä»æ±‡ç¼–å™¨å’Œé“¾æ¥å™¨ç­‰å·¥å…·çœ‹åˆ°çš„ section è§†å›¾ï¼ˆä¸Šé¢çœ‹åˆ°çš„éƒ½æ˜¯è¿™ç§è§†å›¾ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ä»ç¨‹åºåŠ è½½å™¨çœ‹åˆ°çš„ segment è§†å›¾ï¼ˆä¹Ÿç§°ä¸º program è§†å›¾ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;section è§†å›¾åœ¨ &amp;ldquo;section headers&amp;rdquo; é‡Œåˆ—å‡ºï¼Œsegment è§†å›¾åœ¨ &amp;ldquo;program headers&amp;rdquo; é‡Œåˆ—å‡ºï¼›section è§†å›¾è·Ÿ section åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸€å¯¹åº”ï¼Œè€Œ segment è§†å›¾åˆ™è·Ÿ section å­˜åœ¨ä¸€å¯¹å¤šçš„æ˜ å°„å…³ç³»ï¼Œæ¯”å¦‚ &lt;code&gt;.text&lt;/code&gt; å’Œ &lt;code&gt;.data&lt;/code&gt; æ®µå¸¸å¸¸å¯¹è¢«æ˜ å°„åˆ°åŒä¸€ä¸ª segmentã€‚&lt;/p&gt;&lt;p&gt;ä½¿ç”¨å‘½ä»¤ &lt;code&gt;riscv64-elf-readelf -l app.o&lt;/code&gt; å³å¯åˆ—å‡º &amp;ldquo;program headers&amp;rdquo;ï¼Œä¸è¿‡ç”±äºç›®å‰çš„ &lt;code&gt;app.o&lt;/code&gt; è¿˜ä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰€ä»¥å®ƒçš„ &amp;ldquo;program headers&amp;rdquo; æ˜¯ç©ºçš„ã€‚å®Œæ•´çš„ ELF æ–‡ä»¶çš„ç»“æ„ä¿¡æ¯å¯ä»¥å‚é˜… &lt;a href=&#34;https://en.wikipedia.org/wiki/Executable_and_Linkable_Format&#34;&gt;ELF Format wiki&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h4 id=&#34;æ®µçš„å¤§å°&#34;&gt;æ®µçš„å¤§å°&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;riscv64-elf-size&lt;/code&gt; å¯ä»¥æŸ¥çœ‹å„ä¸ªæ®µçš„å¤§å°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-size app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   text    data     bss     dec     hex filename&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     32       0       0      32      20 app.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åæ±‡ç¼–&#34;&gt;åæ±‡ç¼–&lt;/h3&gt;&lt;p&gt;ä½ å¯èƒ½ä¼šç–‘é—®ï¼Œæˆ‘ä»¬åˆšåˆšè¿›è¡Œäº†æ±‡ç¼–ï¼Œä¸ºä»€ä¹ˆè¿˜è¦åæ±‡ç¼–ï¼Ÿåæ±‡ç¼–çš„ç»“æœä¸å°±æ˜¯æˆ‘ä»¬æ‰‹å†™çš„æ±‡ç¼–ä»£ç å—ï¼Ÿ&lt;/p&gt;&lt;p&gt;æ˜¯çš„ï¼Œå¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡Œ &lt;em&gt;åæ±‡ç¼–&lt;/em&gt; å°†ä¼šå¾—åˆ°æ±‡ç¼–ä»£ç ï¼Œä¸è¿‡ç»è¿‡åæ±‡ç¼–å¾—å‡ºçš„æ±‡ç¼–ä»£ç è·Ÿæˆ‘ä»¬æ‰‹å†™çš„ä¸å®Œå…¨ä¸€æ ·ï¼Œé‚£æ˜¯å› ä¸ºæ‰‹å†™çš„æ±‡ç¼–ä»£ç æœ‰ä¸€éƒ¨åˆ†æ˜¯ &lt;code&gt;ä¼ªæŒ‡ä»¤&lt;/code&gt;ï¼ˆå³ç”±å¤šä¸ªçœŸå®æŒ‡ä»¤ç»„æˆçš„è™šæ‹ŸæŒ‡ä»¤ï¼‰ï¼Œé€šè¿‡åæ±‡ç¼–èƒ½å¾—åˆ°çœŸå®çš„æŒ‡ä»¤ï¼›å¦å¤–è¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯æ±‡ç¼–æŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹æ±‡ç¼–å™¨çš„æŒ‡ä»¤ï¼Œè¿™éƒ¨åˆ†æŒ‡ä»¤å¯èƒ½ä¼šæ”¹å˜æ±‡ç¼–çš„è¡Œä¸ºï¼Œä¹Ÿå¯èƒ½ä¼šäº§ç”Ÿç›¸å½“å¤šçš„æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;å†è€…åæ±‡ç¼–å·¥å…·ä¸€èˆ¬è¿˜ä¼šæ˜¾ç¤ºå„ä¸ªæŒ‡ä»¤çš„åœ°å€ï¼Œè¿™æœ‰å¸®åŠ©æˆ‘ä»¬åˆ†æå’Œè°ƒè¯•ç¨‹åºã€‚&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-objdump -d app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Disassembly of section .text:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000000 &amp;lt;_start&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   0:   00000097                auipc   ra,0x0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   4:   000080e7                jalr    ra # 0 &amp;lt;_start&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000008 &amp;lt;_loop&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   8:   00000013                nop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   c:   ffdff06f                j       8 &amp;lt;_loop&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0000000000000010 &amp;lt;_print_a&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  10:   100004b7                lui     s1,0x10000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  14:   04100913                li      s2,65&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  18:   01248023                sb      s2,0(s1) # 10000000 &amp;lt;_print_a+0xffffff0&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  1c:   00008067                ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„å‚æ•° &lt;code&gt;-d&lt;/code&gt; ä»…åæ±‡ç¼– &lt;code&gt;.text&lt;/code&gt; æ®µï¼Œå¦‚æœä½ æƒ³æŸ¥çœ‹æ‰€æœ‰æ®µçš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;-D&lt;/code&gt; å‚æ•°ä»£æ›¿ &lt;code&gt;-d&lt;/code&gt;ï¼Œä¸è¿‡ä¸€èˆ¬ä¸ç”¨å…³å¿ƒå…¶å®ƒæ®µçš„å†…å®¹ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢åˆ†æå…¶ä¸­çš„ç¬¬ 2 ä¸ªæŒ‡ä»¤ &lt;code&gt;0000_80e7&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;000000000000  00001 000 00001 1100111&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;____________  _____     _____ _______&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|offset[11:0] rs=1      rd=1  jalr&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è§£ç å¾—å‡ºï¼š&lt;code&gt;jalr ra, 0(ra)&lt;/code&gt;ï¼Œç»“åˆä¸Šä¸€æ¡æŒ‡ä»¤ &lt;code&gt;auipc ra,0x0&lt;/code&gt; æ¥çœ‹ï¼Œè¿™ä¸¤æ¡æŒ‡ä»¤å¹¶ä¸èƒ½å®ç°è·³è½¬åˆ° &lt;code&gt;_print_a&lt;/code&gt; å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçš„ &lt;code&gt;0&lt;/code&gt; æ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚è¿™æ—¶ GCC ç¼–è¯‘å™¨ï¼Œä¹Ÿæ˜¯ç›®å‰å¤§éƒ¨åˆ†ç¼–è¯‘å™¨çš„åŸç†ï¼Œå³åœ¨ç¼–è¯‘é˜¶æ®µï¼Œæ‰€æœ‰æ¶‰åŠå‡½æ•°åœ°å€ã€å…¨å±€å˜é‡åœ°å€çš„åœ°æ–¹ï¼Œéƒ½ç”¨ &lt;code&gt;0&lt;/code&gt; ä»£æ›¿ï¼ŒåŒæ—¶ä¼šåšä¸€å¼ éœ€è¦é‡å®šä½çš„ç¬¦å·åˆ—è¡¨ã€‚ä»…åœ¨é“¾æ¥é˜¶æ®µï¼Œæ‰ä¼šæŠŠçœŸå®çš„åœ°å€å¡«ä¸Šã€‚ï¼ˆå…·ä½“æ­¥éª¤å’ŒåŸç†åœ¨åç»­çš„æ–‡ç« é‡Œä¼šè®²è§£ï¼‰&lt;/p&gt;&lt;h3 id=&#34;é“¾æ¥&#34;&gt;é“¾æ¥&lt;/h3&gt;&lt;p&gt;ç”±ä¸Šä¸€èŠ‚å¯çŸ¥ï¼Œå› ä¸ºç›®æ ‡æ–‡ä»¶å½“ä¸­çš„æ‰€æœ‰ç¬¦å·çš„åœ°å€éƒ½æ˜¯ç”¨ &lt;code&gt;0&lt;/code&gt; é¡¶æ›¿çš„ï¼Œæ‰€ä»¥ &lt;em&gt;ç›®æ ‡æ–‡ä»¶&lt;/em&gt; æ˜¯æ²¡æ³•è¿è¡Œçš„ï¼Œè¿˜éœ€è¦æŠŠç¬¦å·çš„çœŸå®åœ°å€å¡«ä¸Šï¼Œåº”ç”¨ç¨‹åºæ‰èƒ½è¿è¡Œï¼Œè€Œè¿™è¿™æ­£æ˜¯é“¾æ¥å™¨çš„å·¥ä½œã€‚&lt;/p&gt;&lt;p&gt;é“¾æ¥å™¨è¿˜æœ‰å¦å¤–ä¸€é¡¹å·¥ä½œï¼Œå°±æ˜¯å¦‚æœå­˜åœ¨å¤šä¸ª &lt;em&gt;ç›®æ ‡æ–‡ä»¶&lt;/em&gt;ï¼Œé‚£ä¹ˆå®ƒè¿˜éœ€è¦æŠŠè¿™äº›æ–‡ä»¶åˆå¹¶åœ¨ä¸€èµ·ã€‚é‚£ä¹ˆå®ƒæ˜¯æ€æ ·åˆå¹¶çš„å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çŸ¥é“ç›®æ ‡æ–‡ä»¶é‡Œå­˜åœ¨å¤šä¸ª â€œæ®µâ€ï¼Œåœ¨åˆå¹¶æ—¶é»˜è®¤ä¼šå°†ç›¸åŒåç§°çš„æ®µåˆå¹¶æˆä¸€ä¸ªæ®µã€‚æ¯”å¦‚å‡è®¾ç°æœ‰ä¸¤ä¸ªç›®æ ‡æ–‡ä»¶ &lt;code&gt;a.o&lt;/code&gt; å’Œ &lt;code&gt;b.o&lt;/code&gt;ã€‚åœ¨é“¾æ¥æ—¶ï¼Œ&lt;code&gt;a.o&lt;/code&gt; çš„ &lt;code&gt;.text&lt;/code&gt; æ®µå°†ä¼šå’Œ &lt;code&gt;b.o&lt;/code&gt; çš„ &lt;code&gt;.text&lt;/code&gt; æ®µåˆå¹¶ï¼Œ&lt;code&gt;a.o&lt;/code&gt; çš„ &lt;code&gt;.data&lt;/code&gt; æ®µå’Œ &lt;code&gt;b.o&lt;/code&gt; çš„ &lt;code&gt;.data&lt;/code&gt; æ®µåˆå¹¶ï¼Œæœ€åå†å°†åˆå¹¶åçš„å„ä¸ªæ®µè¿æ¥èµ·æ¥ã€‚&lt;/p&gt;&lt;p&gt;å…·ä½“çš„åˆå¹¶æ–¹æ¡ˆæ˜¯ç”±ä¸€ä¸ªé“¾æ¥å™¨çš„è„šæœ¬æ§åˆ¶çš„ï¼Œè¿™ä¸ªé»˜è®¤è„šæœ¬å¯ä»¥é€šè¿‡å‘½ä»¤ &lt;code&gt;$ riscv64-elf-ld --verbose&lt;/code&gt; æŸ¥çœ‹ï¼Œè„šæœ¬çš„å…·ä½“å«ä¹‰å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://sourceware.org/binutils/docs/ld/index.html&#34;&gt;LD çš„æ–‡æ¡£&lt;/a&gt; å½“ä¸­çš„ &lt;a href=&#34;https://sourceware.org/binutils/docs/ld/Scripts.html&#34;&gt;3 Linker Scripts&lt;/a&gt; ä¸€ç« ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª &lt;a href=&#34;https://blog.csdn.net/m0_47799526/article/details/108765403&#34;&gt;ä¸­æ–‡ç¿»è¯‘ç‰ˆ&lt;/a&gt; ä¹Ÿå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚&lt;/p&gt;&lt;p&gt;æœ‰æ—¶ç›®æ ‡æ–‡ä»¶å¯èƒ½æ˜¯ç¬¬ä¸‰æ–¹æä¾›çš„åº“ï¼Œæ¯”å¦‚ C çš„æ•°å­¦åº“ &lt;code&gt;/usr/lib/libm.so&lt;/code&gt;ï¼Œæ‰€ä»¥é“¾æ¥æ—¶åˆæœ‰é™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥ä¹‹åˆ†ï¼Œåç»­çš„æ–‡ç« ä¼šè¯¦ç»†è®²è§£ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢æ˜¯é“¾æ¥å‘½ä»¤ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-ld -o app.out app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢ç¨‹åºè¿è¡Œä¹‹åå¾—åˆ°æ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶&lt;/h3&gt;&lt;p&gt;é“¾æ¥å™¨çš„è¾“å‡ºç»“æœæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸‹é¢æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;h4 id=&#34;æ–‡ä»¶ç±»å‹-1&#34;&gt;æ–‡ä»¶ç±»å‹&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;file&lt;/code&gt; å·¥å…·æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ file app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app.out: ELF 64-bit LSB executable, UCB RISC-V, double-float ABI, version 1 (SYSV), statically linked, with debug_info, not stripped&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯¹æ¯”ä¹‹å‰çš„ &lt;code&gt;app.o&lt;/code&gt; çš„ä¼šå‘ç°æ–‡ä»¶ç±»å‹å·²ç»ç”± &lt;code&gt;ELF relocatable&lt;/code&gt; å˜æˆ &lt;code&gt;ELF executable&lt;/code&gt;ã€‚ä½¿ç”¨ &lt;code&gt;riscv64-elf-readelf -h&lt;/code&gt; åŒæ ·å¯ä»¥æŸ¥çœ‹ ELF æ ¼å¼çš„å¤´ä¿¡æ¯ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-readelf -h app.o&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-readelf -h app.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt; Type:                              REL (Relocatable file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt; Entry point address:               0x0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt; Start of program headers:          0 (bytes into file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt; Number of program headers:         0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Type:                              EXEC (Executable file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Entry point address:               0x100b0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Start of program headers:          64 (bytes into file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Number of program headers:         2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;ç¬¦å·åˆ—è¡¨-1&#34;&gt;ç¬¦å·åˆ—è¡¨&lt;/h4&gt;&lt;p&gt;ç„¶åå†çœ‹çœ‹å¯¼å‡ºç¬¦å·è¡¨ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-nm app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000110d0 T __BSS_END__&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000110cc T __bss_start&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000110cc T __DATA_BEGIN__&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000110cc T _edata&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000110d0 T _end&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000118cc A __global_pointer$&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000100b4 t _loop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000100bc T _print_a&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000110cc T __SDATA_BEGIN__&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000100b0 T _start&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘ç°å¤šå‡ºäº†å‡ ä¸ªç¬¦å·ï¼Œæ¯”å¦‚ &lt;code&gt;__DATA_BEGIN&lt;/code&gt;ï¼Œ&lt;code&gt;__bss_start&lt;/code&gt; ç­‰ï¼Œè¿™äº›ç¬¦å·æ¥è‡ªé“¾æ¥è„šæœ¬ã€‚&lt;/p&gt;&lt;h4 id=&#34;æ®µ-1&#34;&gt;æ®µ&lt;/h4&gt;&lt;p&gt;ç„¶åå†çœ‹æ®µä¿¡æ¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-objdump -h app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Idx Name          Size      VMA               LMA               File off  Algn&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  0 .text         0000001c  00000000000100b0  00000000000100b0  000000b0  2**2&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                  CONTENTS, ALLOC, LOAD, READONLY, CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘ç° &lt;code&gt;.data&lt;/code&gt; å’Œ &lt;code&gt;.bss&lt;/code&gt; æ®µä¸è§äº†ï¼Œé‚£æ˜¯å› ä¸ºå®ƒä»¬åŸæœ¬å°±æ˜¯æ— å†…å®¹çš„ï¼Œé•¿åº¦ä¸º 0ï¼Œæ‰€ä»¥åœ¨æœ€åè¾“å‡ºæ–‡ä»¶é‡Œè¢« &amp;ldquo;ä¼˜åŒ–&amp;rdquo;ï¼ˆå³è¢«ç§»é™¤ï¼‰äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;code&gt;.text&lt;/code&gt; çš„é•¿åº¦ä¸å˜ï¼Œè€Œ &lt;code&gt;VMA&lt;/code&gt; ï¼ˆè™šæ‹Ÿå†…å­˜åœ°å€ï¼‰å’Œ &lt;code&gt;LMA&lt;/code&gt; ï¼ˆåŠ è½½å†…å­˜åœ°å€ï¼‰çš„å€¼éƒ½å˜ä¸º &lt;code&gt;0x1_00b0&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h4 id=&#34;program-headers&#34;&gt;Program Headers&lt;/h4&gt;&lt;p&gt;å› ä¸º &lt;code&gt;app.out&lt;/code&gt; å·²ç»æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰€ä»¥ç°åœ¨å¯ä»¥æŸ¥çœ‹ &amp;ldquo;program headers&amp;rdquo; äº†ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-readelf -l app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Elf file type is EXEC (Executable file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Entry point 0x100b0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;There are 2 program headers, starting at offset 64&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Program Headers:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Type           Offset             VirtAddr           PhysAddr&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 FileSiz            MemSiz              Flags  Align&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  RISCV_ATTRIBUT 0x00000000000000cc 0x0000000000000000 0x0000000000000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 0x0000000000000043 0x0000000000000000  R      0x1&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  LOAD           0x0000000000000000 0x0000000000010000 0x0000000000010000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 0x00000000000000cc 0x00000000000000cc  R E    0x1000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Section to Segment mapping:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Segment Sections...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   00     .riscv.attributes&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   01     .text&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;ldquo;program headers&amp;rdquo; ä¸»è¦ç”¨äºæŒ‡ç¤ºç¨‹åºåŠ è½½å™¨å¦‚ä½•åŠ è½½ç¨‹åºï¼ˆåˆ°å†…å­˜ï¼‰ï¼Œç”±ä¸Šé¢çš„ç»“æœå¯è§ç¨‹åºä¼šè¢«åŠ è½½åˆ° &lt;code&gt;0x1_0000&lt;/code&gt;ï¼Œæ€»å…±åŠ è½½ &lt;code&gt;0xcc&lt;/code&gt; ä¸ªå­—èŠ‚ã€‚åˆå› ä¸ºç¨‹åºçš„å…¥å£ä½äºåœ°å€ &lt;code&gt;0x1_00b0&lt;/code&gt;ï¼Œæ‰€ä»¥å®é™…æŒ‡ä»¤çš„å¤§å°ä¸º &lt;code&gt;0xcc - 0xb0 = 0x1c&lt;/code&gt;ï¼Œè¿™ä¸ªå¤§å°è·Ÿ &amp;ldquo;section headers&amp;rdquo; åˆ—å‡ºçš„ &lt;code&gt;.text&lt;/code&gt; æ®µçš„å¤§å°æ˜¯ä¸€è‡´çš„ã€‚&lt;/p&gt;&lt;h4 id=&#34;æ®µå¤§å°&#34;&gt;æ®µå¤§å°&lt;/h4&gt;&lt;p&gt;ç„¶åå†æ¬¡æŸ¥çœ‹å„ä¸ªæ®µçš„å¤§å°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-size app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   text    data     bss     dec     hex filename&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     28       0       0      28      1c app.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯¹æ¯”é“¾æ¥ä¹‹å‰çš„ &lt;code&gt;app.o&lt;/code&gt;ï¼Œå‘ç°ä»£ç æ®µï¼ˆå³ &lt;code&gt;.text&lt;/code&gt;ï¼‰å±…ç„¶å‡å°‘äº† 4 ä¸ªå­—èŠ‚ï¼Œä¸‹é¢é€šè¿‡åæ±‡ç¼–ä¾¿çŸ¥é“å…¶ä¸­çš„åŸå› ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-objdump -d app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Disassembly of section .text:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000100b0 &amp;lt;_start&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100b0:       00c000ef                jal     ra,100bc &amp;lt;_print_a&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000100b4 &amp;lt;_loop&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100b4:       00000013                nop&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100b8:       ffdff06f                j       100b4 &amp;lt;_loop&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000000100bc &amp;lt;_print_a&amp;gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100bc:       100004b7                lui     s1,0x10000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100c0:       04100913                li      s2,65&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100c4:       01248023                sb      s2,0(s1) # 10000000 &amp;lt;__global_pointer$+0xffee734&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   100c8:       00008067                ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»åæ±‡ç¼–çš„ç»“æœå‘ç°ä¸¤å¤„ä¸åŒï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æŒ‡ä»¤çš„åœ°å€ä» 0x1_00b0 å¼€å§‹ï¼ˆåŸå…ˆä» 0 å¼€å§‹ï¼‰ï¼›&lt;/li&gt;&lt;li&gt;&lt;code&gt;call _print_a&lt;/code&gt; è¯­å¥ç”± 2 ä¸ªæŒ‡ä»¤ &lt;code&gt;auipc&lt;/code&gt; å’Œ &lt;code&gt;jalr&lt;/code&gt; è½¬æ¢ä¸º 1 ä¸ªæŒ‡ä»¤ &lt;code&gt;jal&lt;/code&gt;ï¼Œä¸”ç›®æ ‡åœ°å€è¢«å¡«ä¸ŠçœŸå®çš„åœ°å€ï¼ŒRISC-V ä¸€æ¡æŒ‡ä»¤ï¼ˆä¸ç®¡æ˜¯ 32 ä½è¿˜æ˜¯ 64 ä½ï¼‰çš„é•¿åº¦ä¸º 4 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å°‘äº†ä¸€æ¡æŒ‡ä»¤åˆšå¥½å°±å°‘äº† 4 ä¸ªå­—èŠ‚ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç°åœ¨åˆ†ææŒ‡ä»¤ &lt;code&gt;00c000ef&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0    0000000110 0    00000000 00001 1101111&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;---- ---------- ---- -------- ----- -------&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[20] [10:1]     [11] [19:12]  rd=1  jal&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è§£ç å¾—å‡ºï¼š&lt;code&gt;jal ra, 0b1100&lt;/code&gt;ï¼Œå…¶ä¸­ &lt;code&gt;0b1100&lt;/code&gt; æ˜¯åœ°å€åç§»å€¼ï¼Œä¸‹é¢æ¥ç®—ç®—å®ƒè¡¨ç¤ºçš„ç»å¯¹åœ°å€ï¼šå½“å‰æŒ‡ä»¤åœ°å€ä¸º &lt;code&gt;0x1_00b0&lt;/code&gt;ï¼Œå³åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œ&lt;code&gt;PC&lt;/code&gt; å¯„å­˜å™¨çš„å€¼ä¸º &lt;code&gt;0x1_00b0&lt;/code&gt;ï¼ŒåŠ ä¸Šåç§»å€¼ &lt;code&gt;0b1100&lt;/code&gt; å¾—å‡º &lt;code&gt;0x100bc&lt;/code&gt;ï¼Œè¿™æ­£å¥½æ˜¯å‡½æ•° &lt;code&gt;_print_a&lt;/code&gt; çš„åœ°å€ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;åœ¨æ•°å­—ç”µè·¯é‡Œå¯„å­˜å™¨ &lt;code&gt;PC&lt;/code&gt; çš„å€¼ä¸»è¦æœ‰ 3 ä¸ªæ¥æºï¼šä¸€ä¸ªæ˜¯æŒ‡ä»¤è¢«è·å–ï¼ˆå³ fetchï¼‰ä¹‹åï¼ŒPC çš„å½“å‰å€¼åŠ ä¸Šäº†æ•°å€¼ &lt;code&gt;4&lt;/code&gt; ä¹‹åçš„æ•°å€¼ï¼›å¦ä¸€ä¸ªæ˜¯å½“å‰çš„ PC å€¼åŠ ä¸Šè·³è½¬æŒ‡ä»¤å½“ä¸­çš„ç«‹å³æ•°ï¼›æœ€åä¸€ä¸ªæ˜¯ï¼ˆjalr æŒ‡ä»¤ï¼‰å½“å‰ PC å€¼åŠ ä¸Šè·³è½¬æŒ‡ä»¤çš„ç«‹å³æ•°ï¼Œå†åŠ ä¸Šç›®æ ‡å¯„å­˜å™¨çš„å€¼ã€‚PC çš„ä¸‹ä¸€ä¸ªå€¼ä¼šæ ¹æ®æŒ‡ä»¤çš„ä¸åŒè€Œç”± &lt;em&gt;å¤ç”¨å™¨&lt;/em&gt; é‡‡ç”¨è¿™ 3 ä¸ªæ¥æºå½“ä¸­çš„ä¸€ä¸ªã€‚å¯¹äºä¸Šé¢çš„ &lt;code&gt;jal&lt;/code&gt; æŒ‡ä»¤ï¼Œé‡‡ç”¨çš„æ˜¯ç¬¬ 2 ç§æ¥æºã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&#34;ç¬¬ä¸€æ¬¡è¿è¡Œ&#34;&gt;ç¬¬ä¸€æ¬¡è¿è¡Œ&lt;/h3&gt;&lt;p&gt;ä¸Šä¸€æ­¥å¾—åˆ° &lt;code&gt;app.out&lt;/code&gt; æ˜¯ä¸€ä¸ª ELF æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸è¿‡å¦‚æœä½ å½“å‰æ“ä½œçš„è®¡ç®—æœºæ˜¯ x86ï¼ˆç°åœ¨ä¸€èˆ¬æŒ‡ AMD64 æˆ–è€… x86-64ï¼‰æˆ–è€… ARM æ¶æ„çš„ï¼Œæ˜¯æ— æ³•ç›´æ¥æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶çš„ï¼Œå› ä¸ºè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„ç›®æ ‡å¹³å°æ˜¯ RISC-V æ¶æ„ã€‚æ²³é©¬èœ€é»å½“å‰çš„è®¡ç®—æœºæ˜¯ x86 æ¶æ„ï¼Œç›´æ¥æ‰§è¡Œä¹‹åå‡ºç°äº†å¦‚ä¸‹æç¤ºä¿¡æ¯ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ./app.out&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Segmentation fault (core dumped)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä¸çŸ¥é“åœ¨ä½ çš„è®¡ç®—æœºä¸Šè¿è¡Œä¹‹åä¼šå‡ºç°ä»€ä¹ˆä¿¡æ¯ï¼Œä¸è¿‡å¾ˆæ˜æ˜¾ x86 CPU æ— æ³•æ­£ç¡®ç†è§£ RISC-V çš„æŒ‡ä»¤ï¼Œç»è¿‡ä¸€ç•ªæŒ£æ‰ä¹‹åä¼°è®¡éƒ½ä¼šä»¥å¤±è´¥å‘Šç»ˆï¼ˆæ¯”å¦‚ä¸Šé¢æ˜¾ç¤ºçš„æ˜¯ &lt;em&gt;æ®µå¤±è´¥&lt;/em&gt; é”™è¯¯ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢ä½¿ç”¨æ¨¡æ‹Ÿå™¨ QEMU RISC-V æ¥è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ï¼Œ&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ qemu-system-riscv64 &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -machine virt &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -nographic &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -bios none &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -kernel app.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ¬¡ä¸ä¼šæ˜¾ç¤º &lt;em&gt;æ®µå¤±è´¥&lt;/em&gt; é”™è¯¯äº†ï¼Œä½†æ˜¯ç­‰äº†åŠå¤©éƒ½æ²¡ç­‰åˆ°ç¨‹åºç»“æŸï¼Œä¹Ÿæ²¡çœ‹åˆ°å¤§å†™å­—æ¯ â€œAâ€ï¼Œæ˜¾ç„¶åº”ç”¨ç¨‹åºä»ç„¶æ²¡æœ‰è¢«æ­£ç¡®æ‰§è¡Œã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;æŒ‰ &lt;code&gt;Ctrl+a, x&lt;/code&gt;ï¼ˆå³å…ˆæŒ‰ä¸‹ &lt;code&gt;Ctrl+a&lt;/code&gt;ï¼Œç„¶åå†å•ç‹¬æŒ‰ä¸‹ &lt;code&gt;x&lt;/code&gt; é”®ï¼‰å¯ç»“æŸ QEMUï¼Œè¿™ä¸ªç»„åˆé”®æˆ‘ä¼šåå¤æç¤ºï¼Œå…å¾—ä½ è·Ÿç¬¬ä¸€æ¬¡é€€å‡º VIM ä¸€æ ·æ‰‹å¿™è„šä¹±ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;é€šè¿‡åç»­çš„æ–‡ç« çš„ GDB è°ƒè¯•å¯çŸ¥ï¼ŒQEMU RISC-V virt ä¼šå‡è®¾å†…æ ¸ç¨‹åºçš„å¼€å§‹ä½ç½®åœ¨å†…å­˜çš„ &lt;code&gt;0x8000_0000&lt;/code&gt;ï¼Œè€Œæˆ‘ä»¬çš„ç¨‹åºè¢«åŠ è½½åˆ° &lt;code&gt;0x0001_00b0&lt;/code&gt;ï¼Œå› æ­¤ç¨‹åºæ ¹æœ¬æ²¡æœ‰è¢«æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;è¿™é‡Œçš„ &lt;code&gt;0x8000_0000&lt;/code&gt; æ˜¯ä¸€ä¸ªæ˜ å°„åœ°å€ï¼Œå¹¶ä¸æ˜¯è¯´è™šæ‹ŸæœºçœŸçš„æœ‰è¿™ä¹ˆå¤§çš„å†…å­˜ï¼ˆå®é™…ä¸Šé»˜è®¤ QEMU RISC-V è™šæ‹Ÿæœºåªæœ‰ 128MB å†…å­˜ï¼‰ï¼Œè¿™ä¸ªåœ°å€è¢«æ˜ å°„åˆ°å†…å­˜ RAM çš„å¼€å§‹ä½ç½®ï¼Œå¯ä»¥ä» &lt;a href=&#34;https://github.com/qemu/qemu/blob/master/hw/riscv/virt.c&#34;&gt;QEMU RISC-V virt çš„æºä»£ç &lt;/a&gt; æ‰¾åˆ°æ˜ å°„å…³ç³»ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; MemMapEntry virt_memmap[] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_MROM] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;         {     &lt;span style=&#34;color:#ae81ff&#34;&gt;0x1000&lt;/span&gt;,        &lt;span style=&#34;color:#ae81ff&#34;&gt;0xf000&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_UART0] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;        { &lt;span style=&#34;color:#ae81ff&#34;&gt;0x10000000&lt;/span&gt;,         &lt;span style=&#34;color:#ae81ff&#34;&gt;0x100&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_FLASH] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;        { &lt;span style=&#34;color:#ae81ff&#34;&gt;0x20000000&lt;/span&gt;,     &lt;span style=&#34;color:#ae81ff&#34;&gt;0x4000000&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [VIRT_DRAM] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;         { &lt;span style=&#34;color:#ae81ff&#34;&gt;0x80000000&lt;/span&gt;,           &lt;span style=&#34;color:#ae81ff&#34;&gt;0x0&lt;/span&gt; },&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;p&gt;æœ‰å…³ QEMU RISC-V çš„ä½¿ç”¨åŠç¨‹åºè°ƒè¯•æ–¹æ³•ï¼Œä¼šåœ¨åç»­çš„æ–‡ç« ä¸­è®²è§£ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&#34;é“¾æ¥è„šæœ¬&#34;&gt;é“¾æ¥è„šæœ¬&lt;/h3&gt;&lt;p&gt;é‚£ä¹ˆæ€æ ·æ‰èƒ½æŠŠç¨‹åºåŠ è½½åˆ°æŒ‡å®šçš„ä½ç½®å‘¢ï¼Ÿè¿™æ—¶å€™å°±éœ€è¦å®šåˆ¶çš„ &lt;em&gt;é“¾æ¥è„šæœ¬&lt;/em&gt; äº†ã€‚é“¾æ¥è„šæœ¬å¯ä»¥è®©é“¾æ¥å™¨æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚äº§ç”Ÿè¾“å‡ºæ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå°±å¯ä»¥æŒ‡å®šç¨‹åºçš„åŠ è½½åˆ°å†…å­˜åçš„ä½ç½®ã€‚&lt;/p&gt;&lt;p&gt;ç›®å½• &lt;a href=&#34;./resources/&#34;&gt;resources&lt;/a&gt; é‡Œæœ‰ä¸€ä¸ªé“¾æ¥å™¨è„šæœ¬æ–‡ä»¶ &lt;code&gt;app.lds&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;OUTPUT_ARCH(riscv)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ENTRY(_start)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;BASE_ADDRESS = 0x80000000;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;SECTIONS&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  . = BASE_ADDRESS;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .text : {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.text.entry)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.text .text.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .rodata : {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.rodata .rodata.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .data : {&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.sdata .sdata.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.data .data.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  .bss :{&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.sbss .sbss.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    *(.bss .bss.*)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨é“¾æ¥æ—¶æŒ‡å®šé“¾æ¥è„šæœ¬ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-ld -T app.lds -o app.out app.o&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­å‚æ•° &lt;code&gt;-T app.lds&lt;/code&gt; ç”¨äºæŒ‡å®šé“¾æ¥è„šæœ¬ã€‚&lt;/p&gt;&lt;p&gt;ç°åœ¨å¾—åˆ°äº†æ–°çš„æ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ï¼Œä½¿ç”¨å‘½ä»¤ &lt;code&gt;$ riscv64-elf-objdump -h app.out&lt;/code&gt; æŸ¥çœ‹æ®µä¿¡æ¯ï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Idx Name          Size      VMA               LMA               File off  Algn&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  0 .text         0000001c  0000000080000000  0000000080000000  00001000  2**2&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                  CONTENTS, ALLOC, LOAD, READONLY, CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯è§ä»£ç æ®µ &lt;code&gt;.text&lt;/code&gt; çš„åŠ è½½åœ°å€å·²ç»å˜ä¸º &lt;code&gt;0x8000_0000&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å†çœ‹çœ‹ &amp;ldquo;program headers&amp;rdquo;ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-readelf -l app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Elf file type is EXEC (Executable file)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Entry point 0x80000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;There are 2 program headers, starting at offset 64&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Program Headers:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Type           Offset             VirtAddr           PhysAddr&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 FileSiz            MemSiz              Flags  Align&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  RISCV_ATTRIBUT 0x000000000000101c 0x0000000000000000 0x0000000000000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 0x0000000000000043 0x0000000000000000  R      0x1&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  LOAD           0x0000000000001000 0x0000000080000000 0x0000000080000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 0x000000000000001c 0x000000000000001c  R E    0x1000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Section to Segment mapping:&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Segment Sections...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   00     .riscv.attributes&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   01     .text&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»ä¸Šé¢çš„ä¿¡æ¯å¯è§ç¨‹åºçš„å…¥å£ä»¥åŠè™šæ‹Ÿå†…å­˜åœ°å€å‡ä¸º &lt;code&gt;0x80000000&lt;/code&gt;ï¼ŒåŠ è½½çš„å¤§å°ä¸º &lt;code&gt;0x1c&lt;/code&gt; å­—èŠ‚ï¼Œåˆšå¥½å°±æ˜¯ä»£ç æ®µçš„å¤§å°ã€‚&lt;/p&gt;&lt;h3 id=&#34;ç¬¬äºŒæ¬¡è¿è¡Œ&#34;&gt;ç¬¬äºŒæ¬¡è¿è¡Œ&lt;/h3&gt;&lt;p&gt;ä¸‹é¢æ‰§è¡Œæ–°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ qemu-system-riscv64 &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -machine virt &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -nographic &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -bios none &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -kernel app.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æ— æ„å¤–ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°åœ¨ç»ˆç«¯è¾“å‡ºå¤§å†™å­—æ¯ â€œAâ€ã€‚å†å‹æƒ…æç¤ºä¸€ä¸‹ï¼ŒæŒ‰ &lt;code&gt;Ctrl+x, a&lt;/code&gt; ç»ˆæ­¢ QEMUã€‚&lt;/p&gt;&lt;h3 id=&#34;ç»™ç¨‹åºå‡è‚¥&#34;&gt;ç»™ç¨‹åºå‡è‚¥&lt;/h3&gt;&lt;p&gt;ç°åœ¨çº¯æ±‡ç¼–å†™çš„ RISC-V ç¨‹åºå°±å·²ç»å®Œæˆäº†ï¼Œå…ˆçœ‹çœ‹ç¨‹åºçš„å¤§å°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ ls -lh&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rw-r--r-- 1 yang yang  311 Oct 21 15:27 app.lds&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rw-r--r-- 1 yang yang 3.2K Oct 21 11:05 app.o&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rwxr-xr-x 1 yang yang 5.6K Oct 21 15:27 app.out&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rw-r--r-- 1 yang yang  442 Oct 21 06:57 app.S&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘ç°äº†å—ï¼Ÿå¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt; å±…ç„¶æœ‰ &lt;code&gt;5.6KB&lt;/code&gt;ï¼Œå®ƒæ˜¯å¦‚æ­¤å·¨å¤§ï¼ä¸æ˜¯è¯´åªæœ‰ 30 å·¦å³å­—èŠ‚çš„å—ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥ç»™ç¨‹åºå‡å‡è‚¥å§ã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆéœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆ &lt;code&gt;app.out&lt;/code&gt; æ–‡ä»¶ä¼šé‚£ä¹ˆå¤§ï¼Œæ˜æ˜å½“å‰çš„åº”ç”¨ç¨‹åºéå¸¸ç®€å•ï¼Œç¼–è¯‘ä¹‹åçš„æŒ‡ä»¤åºåˆ—åªæœ‰ &lt;code&gt;0x1c&lt;/code&gt;ï¼ˆå³åè¿›åˆ¶çš„ &lt;code&gt;28&lt;/code&gt;ï¼‰ ä¸ªå­—èŠ‚ã€‚é‚£æ˜¯å› ä¸º ELF æ–‡ä»¶æ ¼å¼æœ‰å›ºå®šçš„ç»“æ„ï¼Œè¿™äº›ç»“æ„ä¼šå ç”¨ä¸€å®šçš„ç©ºé—´ï¼Œå¦å¤– ELF æ–‡ä»¶é‡Œè¿˜åŒ…å«ç”¨äºç¨‹åºè°ƒè¯•çš„ä¿¡æ¯ã€‚ä½¿ç”¨å·¥å…· &lt;code&gt;riscv64-elf-objcopy&lt;/code&gt; å¯ä»¥æŠŠè¿™äº›ä¿¡æ¯é€šé€šå»æ‰ï¼Œåªå‰©ä¸‹è·Ÿé“¾æ¥è„šæœ¬æè¿°ä¸€è‡´çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯è¯´ &lt;code&gt;.text&lt;/code&gt;ï¼Œ&lt;code&gt;.rodata&lt;/code&gt; å’Œ &lt;code&gt;.data&lt;/code&gt; ç­‰æ®µçš„ä¿¡æ¯ä¼šè¢«ä¿ç•™ï¼‰ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-elf-objcopy -S -O binary app.out app.bin&lt;/code&gt;&lt;/p&gt;&lt;p&gt;å‚æ•° &lt;code&gt;-S&lt;/code&gt; è¡¨ç¤ºç§»é™¤æ‰€æœ‰å¤šä½™çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è°ƒè¯•ä¿¡æ¯ï¼‰ï¼Œ&lt;code&gt;-O binary&lt;/code&gt; è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ï¼Œ &lt;code&gt;app.out&lt;/code&gt; å’Œ &lt;code&gt;app.bin&lt;/code&gt; åˆ†åˆ«è¡¨ç¤ºè¾“å…¥å’Œè¾“å‡ºçš„æ–‡ä»¶åã€‚&lt;/p&gt;&lt;p&gt;æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šäº§ç”Ÿä¸€ä¸ªåä¸º &lt;code&gt;app.bin&lt;/code&gt; çš„æ–‡ä»¶ï¼Œä¸‹é¢æ£€æŸ¥å®ƒçš„å¤§å°ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ls -l app.bin&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rwxr-xr-x 1 yang yang 28 Oct 21 15:34 app.bin&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœç„¶åªå‰©ä¸‹ &lt;code&gt;28&lt;/code&gt; ä¸ªå­—èŠ‚ï¼Œä½¿ç”¨ &lt;code&gt;xxd&lt;/code&gt; å·¥å…·å¯ä»¥è‚‰çœ¼æŸ¥çœ‹å®ƒçš„å†…å®¹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ xxd app.bin&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000000: ef00 c000 1300 0000 6ff0 dfff b704 0010  ........o.......&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;00000010: 1309 1004 2380 2401 6780 0000            ....#.$.g...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä½ çš„è®°å¿†å¥½çš„è¯ï¼Œå¯èƒ½ä¼šå¯¹ä¸Šé¢ä¸€æ®µæ•°å­—æœ‰ä¸€ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼Œå®ƒæ­£æ˜¯ä¸Šé¢ç« èŠ‚åæ±‡ç¼–å¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt; ä»£ç æ®µæ—¶çš„å†…å®¹ï¼Œæ¯”å¦‚å¼€å¤´çš„ 4 ä¸ªå­—èŠ‚ &lt;code&gt;ef 00 c0 00&lt;/code&gt;ï¼Œå› ä¸ºç£ç›˜å‚¨å­˜é‡‡ç”¨ &lt;em&gt;å°ç«¯åº&lt;/em&gt; çš„ç¼˜æ•…ï¼Œæˆ‘ä»¬éœ€è¦å°†å­—èŠ‚çš„é¡ºåºåè½¬ï¼Œå¾—åˆ° &lt;code&gt;00 c0 00 ef&lt;/code&gt;ï¼Œè¿™æ­£æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ &lt;code&gt;jal ra,100bc&lt;/code&gt; çš„æœºå™¨ç  &lt;code&gt;0x00c000ef&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;ç¬¬ä¸‰æ¬¡è¿è¡Œ&#34;&gt;ç¬¬ä¸‰æ¬¡è¿è¡Œ&lt;/h3&gt;&lt;p&gt;ä¸‹é¢å°è¯•ç”¨ QEMU è¿è¡Œå®ƒï¼Œä¸è¿‡å› ä¸º &lt;code&gt;app.bin&lt;/code&gt; é™¤äº†æœºå™¨æŒ‡ä»¤ï¼Œå…¶ä½™çš„æ‰€æœ‰ä¿¡æ¯éƒ½è¢«ç§»é™¤äº†ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æŒ‡å®šç¨‹åºåŠ è½½åˆ°å†…å­˜çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´å†ä¹Ÿä¸èƒ½ç›´æ¥æŠŠ &lt;code&gt;app.bin&lt;/code&gt; ä½œä¸º &lt;code&gt;-kernel&lt;/code&gt; å‚æ•°ä¼ ç»™ QEMUï¼Œè½¬è€Œéœ€è¦ä½¿ç”¨å‚æ•° &lt;code&gt;-device loader,file=FILENAME,addr=ADDRESS&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ qemu-system-riscv64 &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -machine virt &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -nographic &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -bios none &lt;span style=&#34;color:#ae81ff&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;    -device loader,file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;app.bin,addr&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;0x80000000&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æ— æ„å¤–ï¼Œä¸Šé¢çš„å‘½ä»¤ä¹Ÿèƒ½è¾“å‡ºæ­£ç¡®çš„ç»“æœï¼ŒåŒæ ·æŒ‰ &lt;code&gt;Ctrl+a, x&lt;/code&gt; é€€å‡º QEMUã€‚&lt;/p&gt;&lt;h2 id=&#34;æœ€å°çš„-linux-ç¨‹åº&#34;&gt;æœ€å°çš„ Linux ç¨‹åº&lt;/h2&gt;&lt;p&gt;æœ¬ç« è¦å®ç°ä¸€ä¸ªæœ€å°çš„ Linux ç¨‹åºï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å‘æ§åˆ¶å°æ‰“å°ä¸€è¡Œ &amp;ldquo;Hello world!\n&amp;rdquo; æ–‡æœ¬ã€‚è·Ÿä¹‹å‰çš„ &amp;ldquo;Hello world&amp;rdquo; ç¨‹åºä¸åŒçš„æ˜¯ï¼Œå®ƒä¸éœ€è¦æ ‡å‡†åº“çš„æ”¯æŒï¼Œè€Œæ˜¯ç›´æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œå…¶æ¬¡å®ƒç”¨æ±‡ç¼–ä¹¦å†™&lt;/p&gt;&lt;h3 id=&#34;ç³»ç»Ÿè°ƒç”¨&#34;&gt;ç³»ç»Ÿè°ƒç”¨&lt;/h3&gt;&lt;p&gt;Linux ç¨‹åºä¹Ÿå°±æ˜¯å¹³å¸¸æˆ‘ä»¬æ‰€æ¥è§¦åˆ°çš„æ™®é€šç¨‹åºï¼Œè·Ÿä¸Šé¢çš„è£¸æœºç¨‹åºä¸åŒçš„æ˜¯ï¼Œæ™®é€šç¨‹åºè¿è¡Œäºè®¡ç®—æœºçš„ &lt;code&gt;ç”¨æˆ·æ¨¡å¼&lt;/code&gt;ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹åº”ç”¨ç¨‹åºæ˜¯æ— æ³•ç›´æ¥è·Ÿç¡¬ä»¶æ‰“äº¤é“çš„ï¼ŒåŒ…æ‹¬æ— æ³•è®¿é—®ä»»æ„ä½ç½®çš„å†…å­˜ï¼Œæ— æ³•è®¿é—® CPU å½“ä¸­éƒ¨åˆ†éœ€è¦ç‰¹æƒçš„å¯„å­˜å™¨ï¼Œä¹Ÿæ— æ³•æ‰§è¡Œéœ€è¦ç‰¹æƒçš„æŒ‡ä»¤ï¼ˆè£¸æœºç¨‹åºé€šå¸¸è¿è¡Œäº &lt;code&gt;æœºå™¨æ¨¡å¼&lt;/code&gt; æˆ–è€… &lt;code&gt;ç›‘ç®¡æ¨¡å¼&lt;/code&gt;ï¼Œå®ƒå¯ä»¥ç›´æ¥è®¿é—®è®¡ç®—æœºçš„æ‰€æœ‰èµ„æºï¼‰ã€‚æ‰€ä»¥å³ä½¿æ˜¯å‘ä¸²å£æ§åˆ¶å°æ‰“å°ä¸€è¡Œ &amp;ldquo;Hello World!&amp;rdquo; å­—ç¬¦ä¸²ä¹Ÿæ˜¯åŠä¸åˆ°çš„ã€‚&lt;/p&gt;&lt;p&gt;æ™®é€šçš„åº”ç”¨ç¨‹åºåªèƒ½å°†è‡ªå·±çš„éœ€æ±‚å‘æ“ä½œç³»ç»Ÿå€¾è¯‰ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£å…·ä½“çš„å·¥ä½œï¼Œç„¶åå†æŠŠç»“æœè¿”å›ç»™åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º &lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt;ã€‚å¦‚æœä»åº”ç”¨ç¨‹åºè§’åº¦æ¥çœ‹æ“ä½œç³»ç»Ÿçš„è¯ï¼Œå®ƒæ—¢æ˜¯åº”ç”¨ç¨‹åºçš„ç®¡ç†è€…ï¼ŒåŒæ—¶ä¹Ÿæ˜¯åº”ç”¨ç¨‹åºçš„æ‰“å·¥äººï¼ˆæ˜¯çš„ï¼Œåœ¨è®¡ç®—æœºçš„ä¸–ç•Œé‡Œå°±æ˜¯å­˜åœ¨è¿™ç§å¥‡æ€ªçš„è§’è‰²ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸è¿‡å¹³å¸¸æˆ‘ä»¬å†™åº”ç”¨ç¨‹åºå¾ˆå°‘ä¼šç›´æ¥è¿›è¡Œ &lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt;ï¼ˆ&lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt; çš„å…·ä½“è¡¨ç°å½¢å¼ä¹Ÿæ˜¯ &lt;em&gt;å‡½æ•°è°ƒç”¨&lt;/em&gt;ï¼‰ï¼Œå› ä¸ºè¿™äº›å‡½æ•°æ¯”è¾ƒåŸå§‹ï¼Œè°ƒç”¨èµ·æ¥ä¸å¤Ÿæ–¹ä¾¿ï¼Œå†è€…ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿè°ƒç”¨æ˜¯ä¸åŒçš„ã€‚å› æ­¤æ ‡å‡†åº“ï¼ˆlibcï¼‰æŠŠç³»ç»Ÿè°ƒç”¨è¿›è¡Œå°è£…ï¼ŒåŒæ—¶ä¸ºä¸åŒçš„å¹³å°æä¾›ä¸åŒçš„å®ç°ï¼Œæœ€åæ‰“åŒ…æˆå„ç§æ–¹ä¾¿çš„å‡½æ•°ä»¥ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚&lt;/p&gt;&lt;h3 id=&#34;ç³»ç»Ÿè°ƒç”¨çš„å®ç°&#34;&gt;ç³»ç»Ÿè°ƒç”¨çš„å®ç°&lt;/h3&gt;&lt;p&gt;RISC-V Linux çš„ç³»ç»Ÿè°ƒç”¨å®ç°å¾ˆç®€å•ï¼Œå¤§æ¦‚ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ¯ä¸ªç³»ç»Ÿè°ƒç”¨ï¼ˆä½ å¯ä»¥ç²—ç•¥ç†è§£ä¸º &lt;em&gt;å‡½æ•°&lt;/em&gt;ï¼‰éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼Œæ¯”å¦‚ &lt;code&gt;write&lt;/code&gt; å‡½æ•°çš„ç¼–å·æ˜¯ &lt;code&gt;0x40&lt;/code&gt;ï¼Œ&lt;code&gt;exit&lt;/code&gt; å‡½æ•°çš„ç¼–å·æ˜¯ &lt;code&gt;0x5d&lt;/code&gt;ï¼ŒæŠŠè¿™ä¸ªç¼–å·å‚¨å­˜åœ¨å¯„å­˜å™¨ &lt;code&gt;a7&lt;/code&gt; é‡Œã€‚&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;&lt;p&gt;ç³»ç»Ÿè°ƒç”¨çš„ç¼–å·å¯ä»¥æŸ¥é˜… &lt;a href=&#34;https://github.com/riscv-collab/riscv-gnu-toolchain/blob/master/linux-headers/include/asm-generic/unistd.h&#34;&gt;RISC-V GCC Linux headers - unistd.h&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;ol start=&#34;2&#34;&gt;&lt;li&gt;&lt;p&gt;æŠŠå‡½æ•°çš„å‚æ•°çš„å€¼åˆ†åˆ«å‚¨å­˜åœ¨å¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt;ã€&lt;code&gt;a1&lt;/code&gt; &amp;hellip; é‡Œã€‚&lt;/p&gt;&lt;p&gt;æ¯ä¸ªç³»ç»Ÿè°ƒç”¨çš„å‚æ•°æƒ…å†µå¯ä»¥æŸ¥çœ‹å®ƒçš„å‡½æ•°ç­¾åï¼Œæ¯”å¦‚ &lt;code&gt;write&lt;/code&gt; å‡½æ•°çš„ç­¾åæ˜¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;ssize_t write(int fd, const void *buf, size_t count);&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ä»ç­¾åå¯çŸ¥å®ƒæœ‰ 3 ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼ˆç¼–å·ï¼‰ã€å†…å®¹ï¼ˆå³ç¼“å­˜ï¼‰çš„å¼€å§‹ä½ç½®ã€å†…å®¹çš„é•¿åº¦ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼‰ï¼ŒæŠŠè¿™ä¸‰ä¸ªå‚æ•°å€¼åˆ†åˆ«å‚¨å­˜åœ¨å¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt;, &lt;code&gt;a1&lt;/code&gt; å’Œ &lt;code&gt;a3&lt;/code&gt; é‡Œã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;&lt;p&gt;ç³»ç»Ÿè°ƒç”¨çš„ç­¾åå¯ä»¥ä½¿ç”¨å‘½ä»¤ &lt;code&gt;$ man 2 SYSCALL_NAME&lt;/code&gt; æŸ¥çœ‹ï¼Œæ³¨æ„éœ€è¦åœ¨ &lt;code&gt;man&lt;/code&gt; åé¢æ·»åŠ æ•°å­— &lt;code&gt;2&lt;/code&gt;ï¼Œè¡¨ç¤ºæŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨çš„è¯´æ˜ã€‚ä¸æ·»åŠ æˆ–è€…æ·»åŠ æ•°å­— &lt;code&gt;1&lt;/code&gt; çš„è¯æ˜¾ç¤ºçš„æ˜¯ &lt;code&gt;write&lt;/code&gt; å‘½ä»¤çš„è¯´æ˜ã€‚é¡ºä¾¿ä¸€æï¼Œæ•°å­— &lt;code&gt;3&lt;/code&gt; è¡¨ç¤ºæŸ¥çœ‹æ ‡å‡†åº“çš„å‡½æ•° &lt;code&gt;write&lt;/code&gt;ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;ol start=&#34;3&#34;&gt;&lt;li&gt;æ‰§è¡Œ &lt;code&gt;ecall&lt;/code&gt; æŒ‡ä»¤ã€‚è¯¥æŒ‡ä»¤ä¼šå¼•èµ·ä¸€ä¸ªä¸­æ–­ï¼Œè®¡ç®—æœºçš„æ§åˆ¶æƒç”±åº”ç”¨ç¨‹åºè½¬ç»™æ“ä½œç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿæ•è·åˆ°è¿™ä¸ªä¸­æ–­å¹¶ç†è§£å…¶ç›®çš„ï¼Œæœ€åæŠŠç»“æœå‚¨å­˜åˆ°å¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt;ï¼Œç„¶åæŠŠè®¡ç®—æœºæ§åˆ¶æƒäº¤ç»™åº”ç”¨ç¨‹åºã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h3 id=&#34;ç¨‹åºçš„æºä»£ç &#34;&gt;ç¨‹åºçš„æºä»£ç &lt;/h3&gt;&lt;p&gt;æºä»£ç ä½äºç›®å½• &lt;a href=&#34;./resources/minimal-hello-world/&#34;&gt;resouces/minimal-hello-world&lt;/a&gt; ä¹‹ä¸‹çš„æ–‡ä»¶ &lt;code&gt;app.S&lt;/code&gt;ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-s&#34; data-lang=&#34;s&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ SYSCALL_WRITE, &lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ SYSCALL_EXIT, &lt;span style=&#34;color:#ae81ff&#34;&gt;93&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ STDOUT_FD, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.section .text&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.globl _start&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;_start&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# ssize_t write(int fd, const void *buf, size_t count);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    addi a7, zero, SYSCALL_WRITE&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    addi a0, zero, STDOUT_FD&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    la a1, hello_world&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    addi a2, zero, &lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# the length of &amp;#34;Hello world!\n&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ecall&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# void exit(int status)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    addi a7, zero, SYSCALL_EXIT&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    addi a0, zero, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ecall&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.section .rodata&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hello_world&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    .ascii &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello world!\n&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢çš„æ±‡ç¼–ä»£ç ç›¸å½“äºå¦‚ä¸‹çš„ C ä»£ç ï¼ˆæºä»£ç æ–‡ä»¶ &lt;code&gt;app.c&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(){&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;buf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello world!&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    write(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, buf, &lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç¼–è¯‘&#34;&gt;ç¼–è¯‘&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-linux-gnu-as -o app.o app.S&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-linux-gnu-gcc -nostdlib -static -o app.out app.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢çš„é“¾æ¥å‘½ä»¤ä¸­çš„å‚æ•° &lt;code&gt;-nostdlib&lt;/code&gt; è¡¨ç¤ºä¸éœ€è¦æ ‡å‡†åº“ã€‚ä½œä¸ºå¯¹æ¯”ï¼Œä¸‹é¢ä¹Ÿç¼–è¯‘ C ç‰ˆæœ¬çš„ç¨‹åºï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ riscv64-linux-gnu-gcc -static -o app-std.out app.c&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ç„¶åå¯¹æ¯”æ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt; å’Œ &lt;code&gt;app-std.out&lt;/code&gt; çš„å¤§å°ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ ls -lh&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rwxr-xr-x 1 yang yang 1.6K Oct 25 05:30 app.out&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-rwxr-xr-x 1 yang yang 644K Oct 25 05:34 app-std.out&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯è§æ±‡ç¼–ç‰ˆæœ¬çš„åªæœ‰ 2KB ä¸åˆ°ï¼Œè€Œæ ‡å‡†ç‰ˆæœ¬çš„æœ‰ 644KBï¼ˆå½“ç„¶ä½¿ç”¨é™æ€é“¾æ¥ä¹Ÿæ˜¯å¯¼è‡´ä½“ç§¯è¾ƒå¤§çš„åŸå› ä¹‹ä¸€ï¼‰&lt;/p&gt;&lt;h3 id=&#34;è¿è¡Œ&#34;&gt;è¿è¡Œ&lt;/h3&gt;&lt;p&gt;&lt;code&gt;$ qemu-riscv64 app.out&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å…¥çš„ç»“æœæ˜¯ä¸€è¡Œæ–‡æœ¬ &amp;ldquo;Hello world!&amp;quot;ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹ä¸€ç¯‡æ–‡ç«  &lt;a href=&#34;../qemu-and-opensbi-and-debug/README.zh-Hans.md&#34;&gt;QEMUã€OpenSBI åŠè£¸æœºç¨‹åºçš„è°ƒè¯•&lt;/a&gt; æˆ‘ä»¬å°†ä¼šè¯¦ç»†è®²è§£ QEMU çš„ä½¿ç”¨æ–¹æ³•ï¼ŒOpenSBI çš„ä½œç”¨ä»¥åŠè°ƒè¯•è£¸æœºç¨‹åºçš„æ–¹æ³•ã€‚&lt;/p&gt;</description>
     </item>
   
     <item>
       <title></title>
       <link>https://hemashushu.github.io/posts/2022-11-08-qemu-and-debug/readme.zh-hans/</link>
       <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
       
       <guid>https://hemashushu.github.io/posts/2022-11-08-qemu-and-debug/readme.zh-hans/</guid>
       <description>&lt;h1 id=&#34;qemu-æ¨¡æ‹Ÿå™¨åŠç¨‹åºçš„è°ƒè¯•&#34;&gt;QEMU æ¨¡æ‹Ÿå™¨åŠç¨‹åºçš„è°ƒè¯•&lt;/h1&gt;&lt;p&gt;åœ¨&lt;a href=&#34;../build-risc-v-program-from-assembly-code/README.zh-Hans.md&#34;&gt;ä¸Šä¸€ç¯‡æ–‡ç« &lt;/a&gt;æˆ‘ä»¬äº†è§£äº†ä¸€ä¸ª RISC-V ç¨‹åºçš„ç»„æˆå’Œè¿è¡ŒåŸç†ï¼Œå…¶ä¸­ç¨‹åºéƒ½æ˜¯åœ¨ QEMU é‡Œè¿è¡Œçš„ï¼Œè¿™ç¯‡æ–‡ç« å°†ä¼šè®²è§£ QEMU çš„è¯¦ç»†ä½¿ç”¨æ–¹æ³•ï¼ŒOpenSBI çš„ä½œç”¨ï¼Œä»¥åŠé€šè¿‡ QEMU è°ƒè¯•è£¸æœºç¨‹åºçš„æ–¹æ³•ã€‚&lt;/p&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#qemu-%E5%85%A8%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%BC%8F&#34;&gt;QEMU å…¨ç³»ç»Ÿæ¨¡å¼&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%8E%9F%E7%90%86&#34;&gt;è¿è¡Œç¨‹åºçš„åŸç†&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E5%8A%A0%E8%BD%BD%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F&#34;&gt;åŠ è½½åº”ç”¨ç¨‹åº&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#risc-v-%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%89%B9%E6%9D%83%E7%BA%A7%E5%88%AB&#34;&gt;RISC-V ç³»ç»Ÿçš„ç‰¹æƒçº§åˆ«&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#qemu-%E5%85%B6%E5%AE%83%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0&#34;&gt;QEMU å…¶å®ƒå¸¸ç”¨å‚æ•°&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E7%9C%9F%E5%AE%9E-risc-v-%E7%A1%AC%E4%BB%B6&#34;&gt;çœŸå® RISC-V ç¡¬ä»¶&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#opensbi&#34;&gt;OpenSBI&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#%E8%B0%83%E7%94%A8-sbi-%E6%9C%8D%E5%8A%A1&#34;&gt;è°ƒç”¨ SBI æœåŠ¡&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%A3%B8%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%B0%83%E8%AF%95&#34;&gt;è£¸æœºç¨‹åºçš„è°ƒè¯•&lt;/a&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;#gdb-%E7%9A%84%E8%B0%83%E8%AF%95%E6%96%B9%E5%BC%8F&#34;&gt;GDB çš„è°ƒè¯•æ–¹å¼&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;#%E8%B0%83%E8%AF%95%E8%A3%B8%E6%9C%BA%E7%A8%8B%E5%BA%8F&#34;&gt;è°ƒè¯•è£¸æœºç¨‹åº&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;!-- raw HTML omitted --&gt;&lt;h2 id=&#34;qemu-å…¨ç³»ç»Ÿæ¨¡å¼&#34;&gt;QEMU å…¨ç³»ç»Ÿæ¨¡å¼&lt;/h2&gt;&lt;p&gt;å‰é¢çš„æ–‡ç« æåˆ°ï¼ŒQEMU æœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼šä¸€ç§æ˜¯ &lt;em&gt;å…¨ç³»ç»Ÿæ¨¡å¼&lt;/em&gt;ï¼Œæ­¤æ—¶ QEMU ä¼šæ¨¡æ‹Ÿä¸€æ•´å¥—è®¡ç®—æœºç¡¬ä»¶ï¼ŒåŒ…æ‹¬ CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œæ¥å£ã€USB æ¥å£ç­‰ç»„ä»¶ï¼›å¦å¤–ä¸€ç§æ˜¯ &lt;em&gt;ç”¨æˆ·æ¨¡å¼&lt;/em&gt;ï¼Œç”¨äºç›´æ¥è¿è¡Œç›®æ ‡æ¶æ„ä¸º RISC-V çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;å› ä¸º &lt;em&gt;ç”¨æˆ·æ¨¡å¼&lt;/em&gt; åœ¨æœ¬é¡¹ç›®é‡Œä½¿ç”¨çš„åœºåˆå¾ˆå°‘ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸»è¦è®²è§£ &lt;em&gt;å…¨ç³»ç»Ÿæ¨¡å¼&lt;/em&gt;ï¼Œå³ç¨‹åº &lt;code&gt;qemu-system-riscv64&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;è¿è¡Œç¨‹åºçš„åŸç†&#34;&gt;è¿è¡Œç¨‹åºçš„åŸç†&lt;/h3&gt;&lt;p&gt;ä½¿ç”¨ QEMU çš„å…¨ç³»ç»Ÿæ¨¡å¼è¿è¡Œä¸€ä¸ªè£¸æœºç¨‹åºï¼ˆä»¥ä¸‹å«åº”ç”¨ç¨‹åºï¼‰çš„å¤§æ¦‚è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æŠŠåº”ç”¨ç¨‹åºçš„å†…å®¹ï¼ˆ&lt;code&gt;.text&lt;/code&gt; å’Œ &lt;code&gt;.data&lt;/code&gt; ç­‰ï¼‰ä¼ ç»™ QEMUï¼›&lt;/li&gt;&lt;li&gt;QEMU ä¼šæŠŠç¨‹åºçš„å†…å®¹åŠ è½½è¿›è™šæ‹Ÿæœºçš„å†…å­˜é‡Œï¼›&lt;/li&gt;&lt;li&gt;ä»åº”ç”¨ç¨‹åºçš„æŒ‡ä»¤åºåˆ—çš„ç¬¬ä¸€ä¸ªï¼ˆæˆ–è€…æŒ‡å®šå…¥å£åœ°å€çš„ï¼‰æŒ‡ä»¤å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;QEMU æœ‰ä¸€å°æ®µå›ºå®šçš„ç¨‹åºï¼ˆ&lt;em&gt;ROM&lt;/em&gt;ï¼‰ï¼Œç¨‹åºå½“ä¸­çš„éƒ¨åˆ†æ•°å€¼æ˜¯ QEMU åŠ¨æ€ç”Ÿæˆçš„ï¼Œå…·ä½“ç”Ÿæˆè¿‡ç¨‹å¯ä»¥å‚é˜… QEMU æºç  &lt;a href=&#34;https://github.com/Xilinx/qemu/blob/master/hw/riscv/boot.c&#34;&gt;/hw/riscv/boot.c&lt;/a&gt;ã€‚è¯¥ ROM çš„åœ°å€æ˜¯ &lt;code&gt;0x1000&lt;/code&gt;ï¼Œä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1000:     auipc   t0,0x0          # t0 = $pc + sign_extend(immediate) &amp;lt;&amp;lt; 12&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       t0 == 0x1000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1004:     addi    a2,t0,40        # a2 = t0 + 0x28&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       a2 == 0x1028&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    # 0x1028 æ˜¯ç»“æ„ä½“ fw_dynamic_info çš„å†…å®¹çš„åœ°å€&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1008:     csrr    a0,mhartid      # Hart ID Register (mhartid)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       å³è¿è¡Œå½“å‰ä»£ç çš„ç¡¬ä»¶çº¿ç¨‹ï¼ˆå³ CPU æ ¸ï¼‰çš„ IDï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       æ‰€æœ‰ CPU æ ¸éƒ½ä¼šè¿è¡Œè¿™æ®µç¨‹åºï¼Œæ‰€ä»¥ a0 çš„å€¼ä¼šå›  CPU æ ¸è€Œä¸åŒï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       å¯¹äºç¬¬ä¸€ä¸ª CPU æ ¸ï¼Œå…¶ id ä¸º 0ã€‚&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x100c:     ld      a1,32(t0)       # a1 = t0[0x20]&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       memory[0x1020] == 0x80000000ï¼Œæ‰€ä»¥ a1 == 0x87000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1010:     ld      t0,24(t0)       # t0 = t0[0x18]&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #       memory[0x1018] == 0x80000000ï¼Œæ‰€ä»¥ t0 == 0x80000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1014:     jr      t0              # è·³è½¬åˆ° 0x80000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1018:     .2byte  0x0             # start_addr, 0x80000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x101a:     .2byte  0x8000          #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x101c:     .2byte  0x0             #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x101e:     .2byte  0x0             #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                    #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1020:     .2byte  0x0             # fdt_laddr, 0x87000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1022:     .2byte  0x87e0          #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1024:     .2byte  0x0             #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1026:     .2byte  0x0             #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;...&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x1038:     .2byte  0x0             # fw_dyn, 0x86000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x103a:     .2byte  0x8600          #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x103c:     .2byte  0x0             #&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x103e:     .2byte  0x0             #&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŒ‡ä»¤åé¢å·²åŠ äº†æ³¨é‡Šï¼Œç®€å•æ¥è¯´ï¼Œè¿™æ®µç¨‹åºä¸»è¦å®ç°äº†ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è®¾ç½®å¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt; çš„å€¼ä¸º CPU æ ¸çš„ idï¼›&lt;/li&gt;&lt;li&gt;è®¾ç½®å¯„å­˜å™¨ &lt;code&gt;a1&lt;/code&gt; å’Œ &lt;code&gt;a2&lt;/code&gt; çš„å€¼ï¼Œæš‚æ—¶å¯å¿½ç•¥ï¼›&lt;/li&gt;&lt;li&gt;ç„¶åè·³è½¬åˆ° &lt;code&gt;0x80000000&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ˜¾ç„¶åªè¦åº”ç”¨ç¨‹åºçš„èµ·å§‹åœ°å€ä¸º &lt;code&gt;0x80000000&lt;/code&gt;ï¼ŒQEMU å°±èƒ½è¿è¡Œåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;&lt;h3 id=&#34;åŠ è½½åº”ç”¨ç¨‹åº&#34;&gt;åŠ è½½åº”ç”¨ç¨‹åº&lt;/h3&gt;&lt;p&gt;å°†åº”ç”¨ç¨‹åºä¼ ç»™ QEMU ç¨‹åºæœ‰ 3 ä¸ªå‚æ•°éƒ½å¯ä»¥å®ç°ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;é€šè¿‡ &lt;code&gt;-bios&lt;/code&gt; å‚æ•°ä¼ é€’ï¼›&lt;/li&gt;&lt;li&gt;é€šè¿‡ &lt;code&gt;-kernel&lt;/code&gt; å‚æ•°ä¼ é€’ï¼›&lt;/li&gt;&lt;li&gt;é€šè¿‡ &lt;code&gt;-device loader&lt;/code&gt; å‚æ•°ä¼ é€’ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è™½ç„¶è¿™ 3 ä¸ªå‚æ•°çš„å«ä¹‰ä¸ç›¸åŒï¼Œä¸è¿‡å¯¹äºä¸€ä¸ªç®€å•çš„è£¸æœºç¨‹åºæ¥è¯´ï¼Œå´éƒ½æ˜¯å¯è¡Œçš„åŠ è½½æ–¹æ³•ã€‚&lt;/p&gt;&lt;p&gt;åœ¨æœ¬æ–‡çš„å­ç›®å½• &lt;a href=&#34;resources/hello-uart/&#34;&gt;resources/hello-uart&lt;/a&gt; é‡Œæœ‰ä¸€ä¸ªç®€å•çš„è£¸æœºç¨‹åºï¼Œç¨‹åºçš„åŠŸèƒ½æ˜¯å‘ä¸²å£æ§åˆ¶å°æ‰“å°ä¸€è¡Œ &amp;ldquo;Hello UART!&amp;rdquo; æ–‡æœ¬ã€‚é¦–å…ˆç¼–è¯‘è¯¥ç¨‹åºï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-as -g -o app.o app.S&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-ld -T app.lds -o app.out app.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨å¾—åˆ°ä¸€ä¸ª ELF æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ã€‚ä¸‹é¢çš„ 3 ä¸ªå‘½ä»¤è¡Œéƒ½å¯ä»¥æ­£ç¡®è¿è¡Œè¯¥ç¨‹åºï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;qemu-system-riscv64 -machine virt -nographic -bios app.out&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;qemu-system-riscv64 -machine virt -nographic -bios none -kernel app.out&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;qemu-system-riscv64 -machine virt -nographic -bios none -device loader,file=app.out&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä¸­çš„å‚æ•°ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;-machine virt&lt;/code&gt; ç”¨äºæŒ‡å®šæ¿å­ï¼ˆboardï¼‰çš„ç±»å‹ï¼Œè·Ÿ x86 çš„æˆç†Ÿç¡¬ä»¶ç¯å¢ƒä¸åŒï¼ŒRISC-V çš„ CPU é€šå¸¸æ˜¯è·Ÿ PCB æ¿å­å›ºå®šæ­é…ï¼ˆä¹Ÿå°±æ˜¯è¯´ä½ ä¸èƒ½åƒ x86 é‚£æ ·åˆ†åˆ«è´­ä¹° CPU å’Œä¸»æ¿ç„¶åå†ç»„è£…åœ¨ä¸€èµ·ï¼‰ï¼Œè€Œå„ä¸ªæ¿å­é…ç½®çš„å¤–è®¾ä¹Ÿå¾ˆä¸ç›¸åŒã€‚è¿˜æœ‰ä¸€éƒ¨åˆ† RISC-V ç³»ç»Ÿæ˜¯ä»¥ MCUï¼ˆæˆ–è€… SoCï¼‰çš„å½¢å¼å­˜åœ¨ã€‚æ€»ä¹‹å„ä¸ª RISC-V ç³»ç»Ÿçš„ç¡¬ä»¶ç›¸å·®è¾ƒå¤§ï¼Œæ‰€ä»¥åœ¨è™šæ‹Ÿä¸€ä¸ª RISC-V ç³»ç»Ÿæ—¶ï¼ŒQEMU éœ€è¦ä½ æŒ‡å®šä½ æ‰€éœ€è¦çš„æ¿å­ç±»å‹ã€‚ä¸€èˆ¬æ¥è¯´å¦‚æœæƒ³è™šæ‹Ÿè·Ÿ MCU ç±»ä¼¼çš„ç³»ç»Ÿï¼Œå¯ä»¥é€‰æ‹© &lt;code&gt;sifive_e&lt;/code&gt;ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«çš„éœ€æ±‚ï¼Œåªæƒ³è™šæ‹Ÿä¸€å°æ™®é€šçš„ RISC-Vï¼Œå¯ä»¥é€‰æ‹© &lt;code&gt;virt&lt;/code&gt;ã€‚QEMU æ”¯æŒçš„æ¿å­ç±»å‹å¯ä»¥ä½¿ç”¨å‘½ä»¤ &lt;code&gt;$ qemu-system-riscv64 -machine help&lt;/code&gt; åˆ—å‡ºã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;-nographic&lt;/code&gt; ç¦ç”¨å›¾å½¢è¾“å‡ºï¼Œç›¸å½“äºä¸€å°æ²¡æœ‰é›†æˆæ˜¾å¡ï¼Œä¹Ÿæ²¡æœ‰æ ¸æ˜¾ï¼ŒåŒæ—¶æŠŠæ˜¾å¡æ‹”æ‰ä¹‹åçš„æ¡Œé¢ç”µè„‘ï¼Œç³»ç»Ÿäº§ç”Ÿçš„æ–‡å­—ä¿¡æ¯åªèƒ½é€šè¿‡ä¸²å£æ§åˆ¶å°ï¼ˆSerial Consoleï¼Œ Serial Monitorï¼‰è¾“å‡ºï¼Œå¯¹äº QEMU æ¥è¯´ï¼Œä¸²å£æ§åˆ¶å°è¾“å‡ºçš„æ–‡å­—æœ€ç»ˆä¼šé‡å®šå‘åˆ°è¿è¡Œ QEMU ç¨‹åºçš„è™šæ‹Ÿç»ˆç«¯ï¼ˆTerminalï¼‰ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;æ³¨æ„ &lt;code&gt;-display none&lt;/code&gt; è·Ÿ &lt;code&gt;-nographic&lt;/code&gt; ä¸åŒï¼Œå‰è€…åœ¨è™šæ‹Ÿç³»ç»Ÿé‡Œä»ç„¶å­˜åœ¨æ˜¾å¡ï¼ˆå½“ç„¶æ˜¯è™šæ‹Ÿçš„æ˜¾å¡ï¼‰ï¼Œåªæ˜¯ç›¸å½“äºæŠŠæ˜¾ç¤ºå™¨å…³æ‰äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿäº§ç”Ÿçš„å›¾åƒæˆ–æ–‡å­—ä¿¡æ¯ä»ç„¶ä¼šç…§æ—§è¾“å‡ºåˆ°è™šæ‹Ÿæ˜¾å¡ï¼Œä½†å› ä¸ºä½ æŠŠæ˜¾ç¤ºå™¨å…³æ‰äº†ï¼Œæ‰€ä»¥ä»€ä¹ˆä¿¡æ¯éƒ½çœ‹ä¸åˆ°ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;QEMU çš„å‚æ•°è¯´æ˜ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ &lt;code&gt;$ man qemu-system-riscv64&lt;/code&gt; æŸ¥çœ‹ã€‚&lt;/p&gt;&lt;p&gt;æ³¨æ„åœ¨ä¸Šé¢çš„ 3 ä¸ªå‘½ä»¤çš„åä¸¤ä¸ªå‘½ä»¤ä¸­ï¼Œéœ€è¦æŒ‡å®š &lt;code&gt;-bios none&lt;/code&gt;ï¼Œå¦‚æœä¸æŒ‡å®šè¯¥å‚æ•°ï¼ŒQEMU ä¼šä½¿ç”¨é»˜è®¤çš„å‚æ•° &lt;code&gt;-bios default&lt;/code&gt;ï¼Œå®ƒä¼šä½¿ç”¨å†…ç½®çš„ OpenSBI ä½œä¸ºå›ºä»¶ï¼Œè¯¥å›ºä»¶çš„èµ·å§‹åœ°å€ä¹Ÿæ˜¯ &lt;code&gt;0x8000_0000&lt;/code&gt;ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ— æ³•åŠ è½½åŒæ ·åœ°å€çš„åº”ç”¨ç¨‹åº &lt;code&gt;app.out&lt;/code&gt;ã€‚å¯¹äº QEMU RISC-V ç³»ç»Ÿçš„å‚æ•°è¯´æ˜ï¼Œå¯ä»¥å‚é˜… &lt;a href=&#34;https://www.qemu.org/docs/master/system/target-riscv.html&#34;&gt;QEMU RISC-V System emulator&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;QEMU é™¤äº†å¯ä»¥åŠ è½½ ELF æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿˜å¯ä»¥åŠ è½½ä¸å¸¦ä»»ä½•è°ƒè¯•ä¿¡æ¯å’Œå…ƒä¿¡æ¯çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå³åªä¿ç•™å¯æ‰§è¡Œæ–‡ä»¶å½“ä¸­çš„ &lt;code&gt;.text&lt;/code&gt;, &lt;code&gt;.rodata&lt;/code&gt;, &lt;code&gt;.data&lt;/code&gt;, &lt;code&gt;.bss&lt;/code&gt; ç­‰å¿…è¦ &lt;code&gt;æ®µ&lt;/code&gt;ï¼‰ï¼Œé€šè¿‡å‘½ä»¤ &lt;code&gt;$ riscv64-elf-objcopy -S -O binary app.out app.bin&lt;/code&gt; å¯ä»¥å¾—åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶ &lt;code&gt;app.bin&lt;/code&gt;ã€‚æ‰€ä»¥ä¸Šé¢çš„ 3 ä¸ªå‘½ä»¤è¿˜èƒ½å¤Ÿè¿™æ ·å†™ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;qemu-system-riscv64 -machine virt -nographic -bios app.bin&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;qemu-system-riscv64 -machine virt -nographic -bios none -kernel app.bin&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;qemu-system-riscv64 -machine virt -nographic -bios none -device loader,file=app.bin,addr=0x80000000&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ³¨æ„ç¬¬ 3 ä¸ªå‘½ä»¤çš„ &lt;code&gt;-device&lt;/code&gt; å‚æ•°å€¼åé¢æ¯”ä¹‹å‰çš„ç‰ˆæœ¬æ–°å¢äº† &lt;code&gt;addr=0x80000000&lt;/code&gt;ï¼Œè¿™ä¸ªå€¼ç”¨äºæŒ‡å®šäºŒè¿›åˆ¶å†…å®¹åŠ è½½åˆ°å†…å­˜çš„å“ªä¸ªä½ç½®ã€‚å¯¹äº ELF æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶æ¥è¯´æ˜¯ä¸éœ€è¦è¿™ä¸ªå‚æ•°å€¼çš„ï¼Œä½†äºŒè¿›åˆ¶æ–‡ä»¶ä¸åŒ…å«ç‰©ç†å†…å­˜ä½ç½®å’Œè™šæ‹Ÿå†…å­˜ä½ç½®ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦é¢å¤–æŒ‡å‡ºã€‚&lt;/p&gt;&lt;p&gt;æ—¢ç„¶ &lt;code&gt;-bios&lt;/code&gt;ã€&lt;code&gt;-kernel&lt;/code&gt; å’Œ &lt;code&gt;-device loader&lt;/code&gt; éƒ½ç”¨äºåŠ è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦åˆ†åˆ«è®¾ç½® 3 ä¸ªå‚æ•°å‘¢ï¼ŸåŸå› éœ€è¦ä» RISC-V ç³»ç»Ÿçš„ç‰¹æƒçº§åˆ«ä»¥åŠç³»ç»Ÿçš„å¯åŠ¨è¿‡ç¨‹è®²èµ·ã€‚&lt;/p&gt;&lt;h3 id=&#34;risc-v-ç³»ç»Ÿçš„ç‰¹æƒçº§åˆ«&#34;&gt;RISC-V ç³»ç»Ÿçš„ç‰¹æƒçº§åˆ«&lt;/h3&gt;&lt;p&gt;RISC-V ç³»ç»Ÿçš„ç‰¹æƒçº§åˆ«ä¸€èˆ¬æœ‰ 3 å±‚ï¼Œä»åº•å±‚åˆ°é¡¶å±‚åˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æœºå™¨æ¨¡å¼ï¼ˆMachine, M-Modeï¼‰&lt;/li&gt;&lt;li&gt;ç›‘ç£æ¨¡å¼ (Supervisorï¼ŒS-Mode)&lt;/li&gt;&lt;li&gt;ç”¨æˆ·/åº”ç”¨æ¨¡å¼ (User/Application, U-Mode)&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;&lt;p&gt;å±‚çº§çš„é…ç½®å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œå¯¹äºç®€å•çš„ RISC-V CPUï¼Œæ¯”å¦‚ MCUï¼Œå¯ä»¥åªæœ‰ M-Mode ä¸€ç§çº§åˆ«ã€‚ç¨å¾®å¼ºå¤§ä¸€ç‚¹çš„å¯ä»¥åªæœ‰ M-Mode å’Œ U-Modeã€‚å¯¹äºæ”¯æŒè™šæ‹ŸåŒ–æŠ€æœ¯çš„ CPUï¼Œåœ¨ç¬¬ 1 å’Œ 2 çº§ä¹‹é—´è¿˜å¯ä»¥æœ‰ &lt;em&gt;è™šæ‹Ÿç›‘ç£æ¨¡å¼&lt;/em&gt; (Hypervisor, H-Mode)&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;ä»åº•å±‚åˆ°é¡¶å±‚ï¼Œæ¯ä¸€å±‚éƒ½åœ¨ç®¡ç†å’Œå°å¿ƒç¿¼ç¿¼åœ°å‘µæŠ¤ä¸‹ä¸€å±‚çš„ç¨‹åºï¼ŒåŒæ—¶åˆæœ‰æ±‚å¿…åº”ï¼Œä¸ºä¸‹ä¸€å±‚çš„ç¨‹åºæ‰§è¡Œé‚£äº›æ¯ç‡¥æ— å‘³çš„æ“ä½œã€‚ä¸ºäº†å®ç°è¿™ç§æƒé™ç»“æ„ï¼Œä½å±‚éƒ½ä¼šæ¯”é«˜å±‚æ‹¥æœ‰æ›´å¤§çš„æƒé™ï¼ˆå…·ä½“è¡¨ç°ä¸ºï¼šèƒ½æ‰§è¡Œæ›´å¤šçš„æŒ‡ä»¤ï¼Œèƒ½è®¿é—®æ›´å¤šçš„èµ„æºï¼‰ï¼Œå¤„äºé«˜å±‚çš„ç¨‹åºå¦‚æœæƒ³æ‰§è¡Œæ›´é«˜æƒé™çš„æ“ä½œï¼Œåªèƒ½é€šè¿‡ &lt;code&gt;ecall&lt;/code&gt; æŒ‡ä»¤å‘å®ƒçš„ä½ä¸€å±‚è¯·æ±‚ã€‚æ¯ä¸¤å±‚ä¹‹é—´éƒ½æœ‰è§„å®šçš„äº¤æµæ¥å£ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;U-Mode å’Œ S-Mode ä¹‹é—´çš„äº¤æµæ¥å£å« ABIï¼ˆApplication binary interfaceï¼‰ï¼ŒABI å¯ä»¥ç²—ç•¥ç†è§£ä¸ºåœ¨æ±‡ç¼–è¯­è¨€å±‚é¢çš„ APIã€‚ABI ä¹Ÿå¯ä»¥ç§°ä¸º &lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt;ï¼ˆSyscallï¼‰ã€‚&lt;/li&gt;&lt;li&gt;S-Mode å’Œ M-Mode ä¹‹é—´çš„äº¤æµæ¥å£åœ¨ RISC-V ç³»ç»Ÿé‡Œå«åš SBIï¼ˆSupervisor Binary Interfaceï¼‰ï¼ŒSBI åœ¨è¡¨ç°å½¢å¼ä¸Šè·Ÿ ABI æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡å®ƒå¤„äºçš„å±‚çº§ä¸åŒè€Œå®šäº†ä¸€ä¸ªæ–°çš„åç§°ï¼Œå…·ä½“çš„å†…å®¹å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://github.com/riscv-non-isa/riscv-sbi-doc/releases&#34;&gt;SBI è§„èŒƒ&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img src=&#34;images/riscv-privileged.png&#34; alt=&#34;riscv privileged&#34;&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¹³å¸¸æ¥è§¦çš„æ™®é€šåº”ç”¨ç¨‹åºè¿è¡Œåœ¨ U-Modeï¼Œè€Œæ“ä½œç³»ç»Ÿçš„å†…æ ¸åˆ™è¿è¡Œåœ¨ S-Modeï¼Œé€šå¸¸ç³»ç»Ÿå¼•å¯¼ç¨‹åºï¼ˆBootloaderï¼‰ä¹Ÿæ˜¯è¿è¡Œåœ¨ S-Modeã€‚è€Œè¿è¡Œäºæœºå™¨æ¨¡å¼çš„ç¨‹åºç”¨äºå°è£…ä¸€äº›æ¯”è¾ƒåº•å±‚çš„ç¡¬ä»¶æ“ä½œï¼Œæ¯”å¦‚æš‚åœæˆ–è€…æ¢å¤ CPU æŸä¸ªæ ¸ï¼ŒåŒæ—¶ç”¨äºæ•æ‰å’Œå¤„ç†æ“ä½œç³»ç»Ÿå†…æ ¸å¼•èµ·çš„å¼‚å¸¸ï¼Œæ¯”å¦‚å†…æ ¸å´©æºƒï¼ˆå³ &lt;em&gt;kernel panic&lt;/em&gt;ï¼Œæœ‰äº›æ•™ç¨‹ç¿»è¯‘ä¸º &lt;em&gt;å†…æ ¸ææ…Œ&lt;/em&gt; å®é™…ä¸Šæ˜¯é”™è¯¯çš„ï¼‰ä¹‹åå‘å±å¹•æ˜¾ç¤ºä¸€äº›æç¤ºä¿¡æ¯ã€‚è¿è¡Œäº M-Mode çš„ç¨‹åºä¹Ÿç§°ä¸º &lt;em&gt;ç›‘ç£æ¨¡å¼æ‰§è¡Œç¯å¢ƒ&lt;/em&gt;ï¼ˆSupervisor Execution Environmentï¼ŒSEEï¼‰ï¼Œç›®å‰æœ‰å‡ ä¸ªè¿è¡Œäº M-Mode çš„ç¨‹åºï¼Œæ¯”å¦‚ &lt;a href=&#34;https://github.com/riscv-software-src/opensbi&#34;&gt;OpenSBI&lt;/a&gt; ä»¥åŠ &lt;a href=&#34;https://github.com/rustsbi/rustsbi&#34;&gt;RustSBI&lt;/a&gt;ï¼Œè¿™äº›ç¨‹åºæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º &lt;em&gt;å›ºä»¶&lt;/em&gt;ï¼ˆFirmwareï¼‰ã€‚&lt;/p&gt;&lt;p&gt;QEMU çš„å‚æ•° &lt;code&gt;-bios&lt;/code&gt; ä¸€èˆ¬ç”¨äºä¼ å…¥è¯¸å¦‚ OpenSBI ç­‰å›ºä»¶ï¼Œè€Œå‚æ•° &lt;code&gt;-kernel&lt;/code&gt; åˆ™ç”¨äºä¼ å…¥ Bootloader æˆ–è€…æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œ&lt;code&gt;-kernel&lt;/code&gt; æ”¯æŒä¼ å…¥å‹ç¼©æ–‡ä»¶ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;å½“å‚æ•° &lt;code&gt;-kernel&lt;/code&gt; ä¼ å…¥çš„æ˜¯ Linux å†…æ ¸æ˜ åƒæ—¶ï¼Œé€šå¸¸è¿˜ä¼šæ­é… &lt;code&gt;-append&lt;/code&gt; å‚æ•°ç”¨äºæŒ‡å®šå†…æ ¸çš„å‘½ä»¤è¡Œå‚æ•°ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&#34;qemu-å…¶å®ƒå¸¸ç”¨å‚æ•°&#34;&gt;QEMU å…¶å®ƒå¸¸ç”¨å‚æ•°&lt;/h3&gt;&lt;p&gt;QEMU è¿˜æœ‰å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;-smp&lt;/code&gt; æŒ‡å®š CPU çš„æ ¸æ•°é‡ï¼Œé»˜è®¤çš„æ ¸æ˜¯ 1ï¼Œå¦‚æœæƒ³æ¨¡æ‹Ÿå¤šæ ¸çš„ç³»ç»Ÿï¼Œå¯¹äº RISC-V æ¿å­ &lt;code&gt;virt&lt;/code&gt; æœ€å¤šå¯ä»¥æŒ‡å®š 8 ä¸ªæ ¸ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;-m&lt;/code&gt; æŒ‡å®šå†…å­˜çš„å®¹é‡ï¼Œé»˜è®¤æ˜¯ 128 MBï¼Œå¦‚æœè¦è¿è¡Œä¸€ä¸ªå®Œæ•´çš„ Linux ç³»ç»Ÿï¼Œå»ºè®®å– 2 GB ä»¥ä¸Šï¼Œæ¯”å¦‚ &lt;code&gt;-m 2G&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ›´å¤šå‚æ•°å¯ä»¥å‚é˜… &lt;a href=&#34;https://www.qemu.org/docs/master/system/riscv/virt.html&#34;&gt;QEMU - Generic Virtual Platform (virt)&lt;/a&gt;ï¼Œæˆ–è€…æŸ¥çœ‹å®Œæ•´çš„å‚æ•° &lt;a href=&#34;https://www.qemu.org/docs/master/system/qemu-manpage.html&#34;&gt;QEMU User Documentation&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–è¿˜æœ‰å‡ ä¸ªå¸¸ç”¨çš„è®¾å¤‡ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å—è®¾å¤‡ï¼Œå³è™šæ‹Ÿç£ç›˜ï¼Œä½¿ç”¨ä¸¤ä¸ªå‚æ•°å®Œæˆï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-device virtio-blk-device,drive=ID_NAME&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-drive file=IMAGE_FILE_NAME,format=raw,if=none,id=ID_NAME&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ &lt;code&gt;IMAGE_FILE_NAME&lt;/code&gt; æ˜¯ç£ç›˜æ˜ åƒæ–‡ä»¶çš„è·¯å¾„ï¼Œ&lt;code&gt;format&lt;/code&gt; æ˜¯æ˜ åƒçš„æ ¼å¼ï¼Œä¸€èˆ¬æœ‰ &lt;code&gt;raw&lt;/code&gt; å’Œ &lt;code&gt;qcow2&lt;/code&gt; ä¸¤ç§ã€‚&lt;code&gt;if&lt;/code&gt; ç”¨äºæŒ‡å®šæ¥å£ç±»å‹ï¼Œå¯é€‰çš„å€¼æœ‰ &lt;code&gt;ide&lt;/code&gt;, &lt;code&gt;scsi&lt;/code&gt;, &lt;code&gt;sd&lt;/code&gt;, &lt;code&gt;pflash&lt;/code&gt;, &lt;code&gt;virtio&lt;/code&gt; å’Œ &lt;code&gt;none&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;&lt;p&gt;æœ‰æ—¶ä¹Ÿå¯ä»¥ç®€å†™ä¸ºï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-drive file=IMAGE_FILE_NAME,if=virtio&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰å…³è™šæ‹Ÿç£ç›˜çš„è¯¦ç»†ä¿¡æ¯å¯ä»¥å‚é˜… &lt;a href=&#34;https://www.qemu.org/docs/master/system/images.html&#34;&gt;QEMU Disk Images&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.qemu.org/docs/master/system/qemu-manpage.html#hxtool-1&#34;&gt;QEMU Block device options&lt;/a&gt;ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç½‘ç»œæ¥å£ï¼Œå³è™šæ‹Ÿç½‘å¡ï¼Œä½¿ç”¨ä¸¤ä¸ªå‚æ•°å®Œæˆï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-device virtio-net-device,netdev=ID_NAME&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-netdev user,id=ID_NAME&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨è¿™ç§æ–¹å¼ä¸»æœºï¼ˆhostï¼‰å’Œè™šæ‹Ÿæœºï¼ˆguestï¼‰éƒ½ä¸ç”¨é¢å¤–çš„è®¾ç½®ï¼Œåœ¨è™šæ‹Ÿæœºé‡Œç›´æ¥é€šè¿‡ NAT å¯ä»¥è®¿é—®ä¸»æœºåŠå¤–éƒ¨ç½‘ç»œã€‚ä¸è¿‡å¦‚æœæƒ³åœ¨è™šæ‹Ÿæœºé‡Œç›‘å¬æŸä¸ªç«¯å£ï¼Œè®©ä¸»æœºæˆ–è€…å¤–éƒ¨ç½‘ç»œè®¿é—®ï¼Œåˆ™æ¯”è¾ƒæ–¹ä¾¿çš„æ–¹æ³•æ˜¯ç”¨ç«¯å£æ˜ å°„ï¼Œåªéœ€åœ¨ &lt;code&gt;-netdev&lt;/code&gt; åé¢æ·»åŠ æ˜ å°„çš„ç«¯å£åˆ—è¡¨å³å¯ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;-netdev user,id=net,hostfwd=tcp::2222-:22,hostfwd=tcp::12345-:1234&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢ä¼šæŠŠè™šæ‹Ÿæœºçš„ SSH server ç«¯å£ &lt;code&gt;22&lt;/code&gt; å’Œ GDB Server ç«¯å£ &lt;code&gt;1234&lt;/code&gt; åˆ†åˆ«æ˜ å°„åˆ° &lt;code&gt;2222&lt;/code&gt; å’Œ &lt;code&gt;12345&lt;/code&gt;ï¼Œè¿™æ ·ä¸€æ¥ï¼Œè®¿é—®ä¸»æœºçš„ &lt;code&gt;2222&lt;/code&gt; ç«¯å£å°±ä¼šé‡å®šå‘åˆ°è™šæ‹Ÿæœºçš„ &lt;code&gt;22&lt;/code&gt; ç«¯å£ï¼Œå› æ­¤ä½¿ç”¨ SSH ç™»å½•è™šæ‹Ÿæœºçš„å‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ ssh -p 2222 USER_NAME@localhost&lt;/code&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ–‡ä»¶æ˜ å°„ï¼Œå³æŠŠä¸»æœºçš„æŸä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•æ˜ å°„è¿›è™šæ‹Ÿæœºé‡Œï¼Œä½¿ç”¨ä¸¤ä¸ªå‚æ•°å®Œæˆï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-device virtio-9p-pci,fsdev=ID_NAME,mount_tag=sf_tag&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-fsdev local,id=ID_NAME,path=/path/to/your/host/dir,security_model=mapped-file&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨è™šæ‹Ÿæœºé‡Œï¼Œä½¿ç”¨ &lt;code&gt;mount&lt;/code&gt; å‘½ä»¤æŒ‚è½½ä¹‹åå°±å¯ä»¥è®¿é—®ä¸»æœºçš„ç›®å½•äº†ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ sudo mkdir -p /mnt/host&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ sudo mount -t 9p sf_tag /mnt/host&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;éšæœºäº§ç”Ÿå™¨ï¼Œä½¿ç”¨ä¸¤ä¸ªå‚æ•°å®Œæˆï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-device virtio-rng-device,rng=ID_NAME&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-object rng-random,filename=/dev/urandom,id=ID_NAME&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;QEMU è¿˜æœ‰å¾ˆå¤šä½¿ç”¨æŠ€å·§ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å‚é˜… &lt;a href=&#34;https://wiki.archlinux.org/title/QEMU&#34;&gt;QEMU - Arch Linux Wiki&lt;/a&gt; å’Œ &lt;a href=&#34;https://wiki.gentoo.org/wiki/QEMU/Options&#34;&gt;QEMU Options - Gentoo Wiki&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;çœŸå®-risc-v-ç¡¬ä»¶&#34;&gt;çœŸå® RISC-V ç¡¬ä»¶&lt;/h3&gt;&lt;p&gt;æœ¬é¡¹ç›®ä¸»è¦ä½¿ç”¨ QEMU RISC-V æ¥è¿è¡Œä¸€ä¸ª Linux å¼€å‘ç¯å¢ƒï¼Œæˆ–è€…ç”¨ &lt;em&gt;å…¨ç³»ç»Ÿæ¨¡å¼&lt;/em&gt; æ¥è¿è¡Œè£¸æœºç¨‹åºï¼Œè€Œæ¯”è¾ƒå°‘ä½¿ç”¨çœŸå®çš„ RISC-V ç¡¬ä»¶æ¥è¿è¡Œå’Œæµ‹è¯•ï¼Œä¸»è¦æ˜¯å› ä¸ºä½¿ç”¨è™šæ‹Ÿæœºæ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;/p&gt;&lt;p&gt;å¦ä¸€ä¸ªåŸå› æ˜¯ç›®å‰ï¼ˆæˆªè‡³ 2022 å¹´ç§‹ï¼‰RISC-V çš„ç¡¬ä»¶ç¯å¢ƒè¿˜ä¸å¤ªæˆç†Ÿç¨³å®šã€‚RISC-V èŠ¯ç‰‡ç›®å‰ä¸»è¦æœ‰ç›®æ ‡ä¸ºé«˜æ€§èƒ½çš„æ¡Œé¢å’ŒæœåŠ¡å™¨èŠ¯ç‰‡ï¼Œä»¥åŠç›®æ ‡ä¸ºåµŒå…¥å¼è®¾å¤‡çš„ MCUã€‚é«˜æ€§èƒ½èŠ¯ç‰‡ä»·æ ¼æ¯”è¾ƒæ˜‚è´µï¼ŒåŒæ—¶è½¯ä»¶ç¯å¢ƒè¿˜ä¸å¤ªå®Œæ•´ï¼ˆä¸»è¦ä¾èµ–ç§»æ¤ Linux ç³»ç»Ÿç°æœ‰çš„è½¯ä»¶ï¼Œå®¢è§‚æ¥è¯´è¿™éœ€è¦ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ï¼‰ã€‚è‡³äº MCU æœ¬åº”æ˜¯ RISC-V è¾ƒå¥½çš„åº”ç”¨åœºæ™¯ï¼Œè€Œç°å®æƒ…å†µå´æ˜¯ä¸€è¨€éš¾å°½ã€‚å¤§éƒ¨åˆ†èŠ¯ç‰‡ä»¥åŠå¼€å‘æ¿çš„å¼€å‘æ–‡æ¡£éå¸¸ä¸å®Œæ•´ï¼Œæ‰€ç”¨çš„å·¥å…·äº”èŠ±å…«é—¨æ¬ ç¼ºä¸€è‡´æ€§ï¼Œå·¥å…·æ™®éç¼ºä¹å¹¿æ³›æ€§çš„æµ‹è¯•ï¼Œä¸”ç»´æŠ¤æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­ï¼Œå¯¹ç‰‡ä¸Šè°ƒè¯•ï¼ˆ&lt;em&gt;On Chip Debug&lt;/em&gt;ï¼‰åŠŸèƒ½çš„æ”¯æŒä¸è¶³ã€‚å› æ­¤æ²³é©¬èœ€é»å½“å‰æ¯”è¾ƒæ¨èä½¿ç”¨è™šæ‹Ÿæœºæ¥è¿è¡Œã€æµ‹è¯•å’Œè°ƒè¯• RISC-V ç¨‹åºã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;å¦‚æœæƒ³è¦è´­ä¹°å¼€å‘æ¿ï¼ˆ&lt;code&gt;Dev-Kit&lt;/code&gt;ï¼‰ï¼Œå»ºè®®å°½é‡é€‰æ‹©èŠ¯ç‰‡å‚å•†è‡ªå·±æ¨å‡ºçš„ï¼ŒåŒæ—¶æ£€æŸ¥å®ƒçš„æ–‡æ¡£æ˜¯å¦é½å…¨ï¼Œå·¥å…·æœ‰æ— æŒç»­ç»´æŠ¤å’Œæ›´æ–°ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œè¿˜è¦æŸ¥çœ‹å®ƒæ˜¯å¦æ”¯æŒè°ƒè¯•åŠŸèƒ½ã€‚è‡³äºç¬¬ä¸‰æ–¹å‡ºå“çš„å¼€å‘æ¿ï¼Œé™¤éå…¶ç¡¬ä»¶åŸç†å›¾å·²å¼€æºè€Œä¸”ä½ å¾ˆç†Ÿæ‚‰ç›¸å…³é›¶éƒ¨ä»¶ï¼Œå¦åˆ™åº”è¯¥å°½é‡é¿å…ï¼ˆå°½ç®¡æœ‰æ—¶ç¬¬ä¸‰æ–¹çš„ä»·æ ¼ä¼šä¾¿å®œå¾ˆå¤šï¼‰ã€‚å½“ç„¶å¦‚æœä½ å·²ç»å……åˆ†æŒæ¡äº†èŠ¯ç‰‡çš„ç‰¹æ€§ï¼Œå…¶å®ä¹Ÿå¯ä»¥è‡ªå·±åˆ¶ä½œå¼€å‘æ¿ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 id=&#34;opensbi&#34;&gt;OpenSBI&lt;/h2&gt;&lt;p&gt;å½“ä½¿ç”¨ QEMU æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„ Linux ç³»ç»Ÿæ—¶ï¼Œé€šå¸¸ä½¿ç”¨ OpenSBI ä½œä¸º &lt;code&gt;-bios&lt;/code&gt;ï¼Œä½¿ç”¨ &lt;a href=&#34;https://www.denx.de/wiki/U-Boot&#34;&gt;U-Boot&lt;/a&gt; ä½œä¸º &lt;code&gt;-kernel&lt;/code&gt;ï¼Œç„¶åå°†åŒ…å«æœ‰ Linux å†…æ ¸ã€æ ¹æ–‡ä»¶ç³»ç»Ÿã€åŸºç¡€è½¯ä»¶çš„ç£ç›˜æ˜ åƒä½œä¸º &lt;em&gt;å—è®¾å¤‡&lt;/em&gt; ä¼ ç»™ QEMUã€‚&lt;/p&gt;&lt;p&gt;U-Boot æ˜¯ä¸€ä¸ª Bootloaderï¼Œå…¶ä½œç”¨æ˜¯ä»ç£ç›˜åŠ è½½å†…æ ¸é•œåƒï¼Œç„¶åè·³è½¬åˆ°å†…æ ¸çš„å…¥å£ï¼Œå†…æ ¸å¯åŠ¨å Bootloader çš„ä»»åŠ¡ä¹Ÿå°±ç»“æŸäº†ï¼Œè¿™é‡Œä¸å±•å¼€è®²è¿°ã€‚è€Œ OpenSBI åˆ™ä¸åŒï¼Œå®ƒä¼šå¯¹ä¸Šä¸€å±‚çš„ç¨‹åºï¼ˆä¹Ÿå°±æ˜¯å†…æ ¸ï¼‰æä¾›éƒ¨åˆ†ç¡¬ä»¶åŠŸèƒ½çš„è°ƒç”¨æœåŠ¡ï¼ŒåŒæ—¶ä¹Ÿä¼šæ•æ‰ä¸Šä¸€å±‚ç¨‹åºçš„å¼‚å¸¸ï¼Œåœ¨å†…æ ¸è¿è¡ŒæœŸé—´ï¼ŒOpenSBI å°†ä¸€ç›´é©»ç•™åœ¨å†…å­˜ä¸­ã€‚ä¸‹å›¾æ˜¯è¿™å‡ ä¸ªç¨‹åºçš„å¯åŠ¨é¡ºåºï¼š&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/boot-sequence.png&#34; alt=&#34;boot sequence&#34;&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;æ³¨æ„ OpenSBI å’Œ Bootloader éƒ½æ˜¯ç”± ROM/QEMU åŠ è½½çš„ï¼ŒOpenSBI å¹¶æ²¡æœ‰åŠ è½½ Bootloader çš„åŠŸèƒ½ã€‚å†…æ ¸å€’æ˜¯ç”± Bootloader åŠ è½½çš„ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒç®€å•çš„ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥ä¸éœ€è¦ Bootloaderï¼Œè€Œæ˜¯ç”± OpenSBI ç›´æ¥è·³è½¬åˆ°å†…æ ¸ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;OpenSBI åœ¨è·³è½¬åˆ° Bootloader æ—¶ï¼Œéœ€è¦çŸ¥é“ Bootloader çš„å…¥å£ï¼ˆå³åœ°å€ï¼‰ï¼Œå› æ­¤ OpenSBI æœ‰ 3 ç§æ–¹å¼è·³è½¬æ–¹å¼ï¼Œå¯¹åº”ç¼–è¯‘å®ƒä¹‹åå¾—åˆ°çš„ 3 ä¸ªä¸åŒ Firmwareï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;fw_jump.binOpenSBI ç›´æ¥æŠŠ Bootloader çš„å…¥å£åœ°å€ç¡¬ç¼–ç åˆ°ç¨‹åºé‡Œï¼Œå› æ­¤ Bootloader å¿…é¡»æ ¹æ® OpenSBI æŒ‡å®šçš„åœ°å€åŠ è½½è¿›å†…å­˜ã€‚è·³è½¬åœ°å€çš„æ•°å€¼ä¼šæ ¹æ®å…·ä½“çš„å¹³å°è€Œæœ‰æ‰€ä¸åŒï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šï¼Œé»˜è®¤çš„æ˜¯ &lt;code&gt;0x80400000&lt;/code&gt;ï¼ˆ32-bit ç³»ç»Ÿï¼‰æˆ–è€… &lt;code&gt;0x80200000&lt;/code&gt;ï¼ˆ64-bit ç³»ç»Ÿï¼‰ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹ OpenSBI çš„æºä»£ç  &lt;a href=&#34;https://github.com/riscv-software-src/opensbi/blob/master/platform/generic/objects.mk&#34;&gt;/platform/generic/objects.mk&lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;fw_dynamic.binROM/QEMU åœ¨åŠ è½½ Bootloader æ—¶ï¼ŒæŠŠå…¥å£åœ°å€å†™åœ¨ç»“æ„ä½“ &lt;code&gt;fw_dynamic_info&lt;/code&gt; é‡Œï¼Œç„¶åæŠŠè¯¥ç»“æ„ä½“çš„åœ°å€ï¼ˆå³æŒ‡é’ˆï¼‰é€šè¿‡å¯„å­˜å™¨ &lt;code&gt;a2&lt;/code&gt; ä¼ é€’ç»™ OpenSBIã€‚åœ¨æœ¬ç¯‡æ–‡ç« é¡¶éƒ¨çš„é‚£æ®µ ROM ä»£ç é‡Œæœ‰å±•ç¤ºè¯¥è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;fw_payload.binæŠŠ OpenSBI å’Œ Bootloader æ‰“åŒ…ä¸ºä¸€ä¸ªç¨‹åºï¼Œè¿™ç§è·³è½¬æ–¹å¼å®ç°èµ·æ¥å¾ˆç®€å•ã€‚ä¸è¿‡æ— è®ºæ˜¯ OpenSBI æ›´æ–°è¿˜æ˜¯ Bootloader æ›´æ–°ï¼Œéƒ½éœ€è¦é‡æ–°æ‰“åŒ…ã€‚ä¸€èˆ¬ç”¨äº OpenSBIã€Bootloader å’Œå†…æ ¸éƒ½ä¸éœ€è¦æ›´æ–°çš„å¾®å‹è®¾å¤‡ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨å¯åŠ¨ &lt;code&gt;qemu-system-riscv64&lt;/code&gt; ç¨‹åºæ—¶ï¼Œå¦‚æœå¿½ç•¥ &lt;code&gt;-bios&lt;/code&gt; å‚æ•°ï¼Œåˆ™ä¼šä½¿ç”¨å†…ç½®çš„ fw_dynamic.binã€‚å…³äº OpenSBI çš„æ›´å¤šä»‹ç»ï¼Œå¯ä»¥å‚é˜… &lt;a href=&#34;https://riscv.org/wp-content/uploads/2019/06/13.30-RISCV_OpenSBI_Deep_Dive_v5.pdf&#34;&gt;OpenSBI Deep Dive&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h3 id=&#34;è°ƒç”¨-sbi-æœåŠ¡&#34;&gt;è°ƒç”¨ SBI æœåŠ¡&lt;/h3&gt;&lt;p&gt;åœ¨ Bootloader æˆ–è€…å†…æ ¸é‡Œè°ƒç”¨ SBI çš„æœåŠ¡ï¼Œè·Ÿåœ¨åº”ç”¨ç¨‹åºé‡Œå‘å†…æ ¸å‘èµ· &lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt; çš„æ–¹å¼éå¸¸ç›¸ä¼¼ã€‚æ ¹æ® &lt;a href=&#34;https://github.com/riscv-non-isa/riscv-sbi-doc/releases&#34;&gt;SBI è§„èŒƒ&lt;/a&gt; çš„è¯´æ˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;SBI æœåŠ¡è¢«åˆ†ä¸º &lt;code&gt;Base&lt;/code&gt;, &lt;code&gt;Timer&lt;/code&gt; ç­‰ 7 ä¸ªç±»åˆ«ï¼Œåœ¨è§„èŒƒé‡Œç§°ä¸º &lt;code&gt;extension&lt;/code&gt;ï¼Œæ¯ä¸ª &lt;code&gt;extension&lt;/code&gt; éƒ½æœ‰ä¸€ä¸ª IDï¼Œå« &lt;code&gt;eid&lt;/code&gt;ï¼Œæ¯”å¦‚ &lt;code&gt;Base Extension&lt;/code&gt; çš„ &lt;code&gt;eid&lt;/code&gt; æ˜¯ &lt;code&gt;0x10&lt;/code&gt;ï¼Œ&lt;code&gt;Timer Extension&lt;/code&gt; çš„æ˜¯ &lt;code&gt;0x54494D45&lt;/code&gt;ï¼›&lt;/li&gt;&lt;li&gt;æ¯ä¸ª &lt;code&gt;extension&lt;/code&gt; é‡Œæœ‰ä¸€ç³»åˆ—å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª IDï¼Œå« &lt;code&gt;fid&lt;/code&gt;ï¼Œæ¯”å¦‚ &lt;code&gt;Base Extension&lt;/code&gt; é‡Œçš„å‡½æ•° &lt;code&gt;sbi_get_spec_version&lt;/code&gt; çš„ &lt;code&gt;fid&lt;/code&gt; æ˜¯ &lt;code&gt;0x0&lt;/code&gt;ï¼Œ&lt;code&gt;sbi_get_impl_id&lt;/code&gt; çš„æ˜¯ &lt;code&gt;0x1&lt;/code&gt;ï¼›&lt;/li&gt;&lt;li&gt;è°ƒç”¨ SBI æœåŠ¡æ—¶ï¼Œå°† &lt;code&gt;eid&lt;/code&gt; ä¼ å…¥å¯„å­˜å™¨ &lt;code&gt;a7&lt;/code&gt;ï¼Œå°† &lt;code&gt;fid&lt;/code&gt; ä¼ å…¥å¯„å­˜å™¨ &lt;code&gt;a6&lt;/code&gt;ï¼Œå°†å‚æ•°ä¼ å…¥å¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt; åˆ° &lt;code&gt;a5&lt;/code&gt;ï¼Œç„¶åæ‰§è¡Œ &lt;code&gt;ecall&lt;/code&gt; æŒ‡ä»¤ã€‚&lt;/li&gt;&lt;li&gt;SBI æœåŠ¡å°†ç»“æœé€šè¿‡å¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt; å’Œ &lt;code&gt;a1&lt;/code&gt; è¿”å›ï¼Œå…¶ä¸­ &lt;code&gt;a0&lt;/code&gt; æ˜¯é”™è¯¯ä»£ç ï¼Œå¦‚æœå‡½æ•°æˆåŠŸï¼Œåˆ™é”™è¯¯ä»£ç æ˜¯ &lt;code&gt;0&lt;/code&gt;ï¼Œè€Œ &lt;code&gt;a1&lt;/code&gt; åˆ™æ˜¯æˆ‘ä»¬çœŸæ­£éœ€è¦çš„è¿”å›å€¼ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;å®Œæ•´çš„ &lt;code&gt;eid&lt;/code&gt; å’Œ &lt;code&gt;fid&lt;/code&gt; ä¹Ÿå¯ä»¥ä» OpenSBI æºä»£ç  &lt;a href=&#34;https://github.com/riscv-software-src/opensbi/blob/master/include/sbi/sbi_ecall_interface.h&#34;&gt;/include/sbi/sbi_ecall_interface.h&lt;/a&gt; è·å¾—ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;åœ¨æœ¬æ–‡çš„å­ç›®å½• [resources/hello-sbi] é‡Œæœ‰ä¸€ä¸ªç®€å•çš„è°ƒç”¨ SBI æœåŠ¡çš„ç¤ºä¾‹ç¨‹åºï¼Œå…¶ä½œç”¨æ˜¯ä¾æ¬¡è°ƒç”¨ &lt;code&gt;sbi_get_spec_version&lt;/code&gt; å’Œ &lt;code&gt;sbi_get_impl_id&lt;/code&gt; å‡½æ•°ï¼Œå³è·å–å½“å‰ç³»ç»Ÿçš„ SBI è§„èŒƒç‰ˆæœ¬å·ä»¥åŠ SBI æœåŠ¡ç¨‹åºçš„å®ç°è€…ä»£å·ï¼ˆæ¯”å¦‚ 0 ä»£è¡¨ &lt;em&gt;Berkeley Boot Loader (BBL)&lt;/em&gt;ï¼Œ1 ä»£è¡¨ &lt;em&gt;OpenSBI&lt;/em&gt;ï¼Œ4 ä»£è¡¨ &lt;em&gt;RustSBI&lt;/em&gt;ï¼‰ï¼Œç„¶åå°†ç»“æœè¾“å‡ºåˆ°ä¸²å£æ§åˆ¶å°ã€‚&lt;/p&gt;&lt;p&gt;ç¨‹åºæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä»…å±•ç¤ºå…³é”®çš„éƒ¨åˆ† &lt;code&gt;sbi-base.S&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-s&#34; data-lang=&#34;s&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ sbi_base_eid, &lt;span style=&#34;color:#ae81ff&#34;&gt;0x10&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ sbi_get_sbi_spec_version_fid, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.equ sbi_get_sbi_impl_id_fid, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sbi_get_spec_version&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li      a7, sbi_base_eid&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li      a6, sbi_get_sbi_spec_version_fid&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ecall&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    mv      a0, a1&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sbi_get_impl_id&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li      a7, sbi_base_eid&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    li      a6, sbi_get_sbi_impl_id_fid&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ecall&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    mv      a0, a1&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ret&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŸºæœ¬ä¸Šå°±æ˜¯è®¾ç½®å¯„å­˜å™¨ &lt;code&gt;a7&lt;/code&gt;, &lt;code&gt;a6&lt;/code&gt; çš„å€¼ï¼Œç„¶åæ‰§è¡Œ &lt;code&gt;ecall&lt;/code&gt; æŒ‡ä»¤ï¼Œå¯¹äºè¿”å›å€¼ï¼Œä¸ºäº†ç®€åŒ–ç¨‹åºï¼Œè¿™é‡Œåªè·å– &lt;code&gt;a1&lt;/code&gt; çš„å€¼ï¼Œæ‰€ä»¥ä½¿ç”¨æŒ‡ä»¤ &lt;code&gt;mv a0, a1&lt;/code&gt; æŠŠå¯„å­˜å™¨ &lt;code&gt;a0&lt;/code&gt; åŸæ¥çš„å€¼ç”¨ &lt;code&gt;a1&lt;/code&gt; çš„å€¼è¦†ç›–äº†ã€‚è¿™æ · C è¯­è¨€å°±å¯ä»¥åƒè°ƒç”¨æ™®é€šå‡½æ•°ä¸€æ ·åªè¿”å›ä¸€ä¸ª int ç±»å‹çš„å€¼ã€‚&lt;/p&gt;&lt;p&gt;å­ç›®å½•é‡Œæœ‰ä¸€ä¸ª Bash è„šæœ¬ &lt;code&gt;run.sh&lt;/code&gt; å®ç°æ‰€æœ‰çš„ç¼–è¯‘ã€é“¾æ¥å’Œè¿è¡Œå·¥ä½œï¼Œæ‰§è¡Œ &lt;code&gt;run.sh&lt;/code&gt;ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ ./run.sh&lt;/code&gt;&lt;/p&gt;&lt;p&gt;è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;OpenSBI v1.0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   ____                    _____ ____ _____&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  / __ \                  / ____|  _ \_   _|&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; | |  | |_ __   ___ _ __ | (___ | |_) || |&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; | |  | | &amp;#39;_ \ / _ \ &amp;#39;_ \ \___ \|  _ &amp;lt; | |&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; | |__| | |_) |  __/ | | |____) | |_) || |_&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  \____/| .__/ \___|_| |_|_____/|____/_____|&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        | |&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        |_|&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform Name             : riscv-virtio,qemu&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform Features         : medeleg&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform HART Count       : 1&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform IPI Device       : aclint-mswi&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform Timer Device     : aclint-mtimer @ 10000000Hz&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform Console Device   : uart8250&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform HSM Device       : ---&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform Reboot Device    : sifive_test&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Platform Shutdown Device  : sifive_test&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Firmware Base             : 0x80000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Firmware Size             : 252 KB&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Runtime SBI Version       : 0.3&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Name              : root&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Boot HART         : 0&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 HARTs             : 0*&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Region00          : 0x0000000002000000-0x000000000200ffff (I)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Region01          : 0x0000000080000000-0x000000008003ffff ()&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Region02          : 0x0000000000000000-0xffffffffffffffff (R,W,X)&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Next Address      : 0x0000000086000000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Next Arg1         : 0x0000000087e00000&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 Next Mode         : S-mode&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Domain0 SysReset          : yes&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»ä¸­å¯è§å½“å‰ç³»ç»Ÿçš„ SBI è§„èŒƒç‰ˆæœ¬æ˜¯ &lt;code&gt;0.3&lt;/code&gt;ï¼Œå®ç°ç¨‹åºæ˜¯ &lt;em&gt;OpenSBI&lt;/em&gt;ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åº &lt;code&gt;app.out&lt;/code&gt; çš„å…¥å£åœ°å€ &lt;code&gt;0x8600_0000&lt;/code&gt; ä¹Ÿæ­£ç¡®åœ°å–å¾—ã€‚&lt;/p&gt;&lt;p&gt;ç„¶åä¸‹é¢æ˜¯ç¨‹åº &lt;code&gt;app.out&lt;/code&gt; çš„è¾“å‡ºå†…å®¹ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Hello SBI!&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;SBI specification version, major: 0, minor: 3.&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;SBI implementation ID: 1.&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœæ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;&lt;h2 id=&#34;è£¸æœºç¨‹åºçš„è°ƒè¯•&#34;&gt;è£¸æœºç¨‹åºçš„è°ƒè¯•&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨ QEMU è°ƒè¯•è£¸æœºç¨‹åºéå¸¸æ–¹ä¾¿ï¼Œåªéœ€åœ¨å¯åŠ¨ QEMU ç¨‹åºæ—¶ï¼Œåœ¨å‘½ä»¤è¡Œå‚æ•°æœ«å°¾æ·»åŠ ä¸Š &lt;code&gt;-s -S&lt;/code&gt; å‚æ•°ï¼ŒQEMU å°±ä¼šæˆä¸ºä¸€ä¸ª GDB Serverï¼Œç„¶åå¼€å‘è€…å°±å¯ä»¥ä½¿ç”¨ GDB Client æ¥è¿›è¡Œè°ƒè¯•äº†ã€‚å…¶ä¸­å‚æ•°ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;-s&lt;/code&gt; æ˜¯ &lt;code&gt;-gdb tc::1234&lt;/code&gt; çš„ç®€å†™ï¼Œè¡¨ç¤º QEMU å°†ä¼šåœ¨ TCP ç«¯å£ &lt;code&gt;1234&lt;/code&gt; å¼€å¯ GDB Serverã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;-S&lt;/code&gt; è¡¨ç¤º QEMU å¯åŠ¨åå…ˆæš‚åœ CPUï¼Œç›´åˆ° GDB Client è¿æ¥è¿›æ¥å¹¶æ‰§è¡Œè¯¸å¦‚ &lt;code&gt;c&lt;/code&gt;ï¼Œ&lt;code&gt;si&lt;/code&gt; ç­‰å‘½ä»¤ï¼ŒQEMU CPU æ‰å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3 id=&#34;gdb-çš„è°ƒè¯•æ–¹å¼&#34;&gt;GDB çš„è°ƒè¯•æ–¹å¼&lt;/h3&gt;&lt;p&gt;GDB ç¨‹åºå¯ä»¥åˆ†ä¸º &lt;em&gt;æœåŠ¡ç«¯&lt;/em&gt; å’Œ &lt;em&gt;å®¢æˆ·ç«¯&lt;/em&gt;ï¼Œå…¶ä¸­æœåŠ¡ç«¯è´Ÿè´£åŠ è½½å’Œæ‰§è¡Œç›®æ ‡ç¨‹åºï¼Œå®¢æˆ·ç«¯è´Ÿè´£åŠ è½½ç›®æ ‡ç¨‹åºçš„ç¬¦å·ï¼Œä»¥åŠå‘æœåŠ¡ç«¯å‘é€å„ç§è°ƒè¯•å‘½ä»¤ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;å¦‚æœå‡†å¤‡è°ƒè¯•æŸä¸ªç¨‹åºï¼Œé€šå¸¸éœ€è¦åœ¨ GCC ç¼–è¯‘ç”Ÿæˆç›®æ ‡ç¨‹åºæ—¶åŠ ä¸Š &lt;code&gt;-g&lt;/code&gt; å‚æ•°ï¼Œä»¥ä¾¿åœ¨è°ƒè¯•æ—¶èƒ½æ˜¾ç¤ºç›¸åº”çš„æºä»£ç ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&#34;images/gdb.png&#34; alt=&#34;GDB&#34;&gt;&lt;/p&gt;&lt;p&gt;ä¸Šå›¾æ˜¯å¸¸è§çš„å‡ ç§è°ƒè¯•æ–¹å¼ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GDB è°ƒè¯•æœ¬åœ°çš„ç¨‹åº&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¿™æ˜¯æœ€å¸¸è§çš„ä¸€ç§æ–¹å¼ï¼ŒGDB ç›´æ¥åŠ è½½ã€è¿è¡Œã€è°ƒè¯•ä½äºæœ¬åœ°çš„ç›®æ ‡ç¨‹åºã€‚æ­¤æ—¶ GDB ç¨‹åºå¯ä»¥è§†ä¸ºé›†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯äºä¸€ä½“ã€‚æ¯”å¦‚å‡è®¾æœ‰ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;app.out&lt;/code&gt;ï¼Œæœ‰æŸä¸ªå‡½æ•°æœªèƒ½é¢„æœŸå·¥ä½œï¼Œé‚£ä¹ˆå¯ä»¥ç”¨å‘½ä»¤ &lt;code&gt;$ gdb app.out&lt;/code&gt; æ¥å¼€å§‹è°ƒè¯•ã€‚è¿›å…¥ GDB äº¤äº’ç•Œé¢åï¼Œå°±å¯ä»¥ &amp;ldquo;å¼€å§‹ä¸ºå‡½æ•°è®¾ç½®æ–­ç‚¹ã€é€è¡Œè¿è¡Œã€è§‚å¯Ÿå±€éƒ¨å˜é‡åŠå¯„å­˜å™¨çŠ¶æ€&amp;rdquo; ç­‰ä¸€ç³»åˆ—å¸¸è§„æ“ä½œã€‚&lt;/p&gt;&lt;p&gt;è°ƒè¯•æœ¬åœ°ç¨‹åºä¹Ÿå¯ä»¥åˆ†æˆæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤ä¸ªç¨‹åºè¿›è¡Œï¼Œå³ç”¨å‘½ä»¤ &lt;code&gt;$ gdbserver localhost:1234 app.out&lt;/code&gt; å¯åŠ¨ GDB Serverï¼Œç”¨å‘½ä»¤ &lt;code&gt;$ gdb -ex &amp;quot;target remote localhost:1234&amp;quot;&lt;/code&gt; å¯åŠ¨ GDB Clientã€‚ä¸è¿‡å®åœ¨æ²¡å¿…è¦è¿™æ ·åšã€‚&lt;/p&gt;&lt;p&gt;ä½¿ç”¨è¿™ç§è°ƒè¯•æ–¹å¼æœ‰ä¸€ä¸ªå±€é™ï¼šå°±æ˜¯ç›®æ ‡ç¨‹åºå¿…é¡»æ˜¯å½“å‰å¹³å°å¯è¿è¡Œçš„ï¼ˆå³æ¶æ„å’Œå¹³å°éƒ½ç¬¦åˆï¼‰ã€‚&lt;/p&gt;&lt;ol start=&#34;2&#34;&gt;&lt;li&gt;GDB Server åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šè¿è¡Œ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¼€å‘è€…åœ¨å½“å‰æœºå™¨ä¸Šè¿è¡Œçš„ GDB ä¼šä½œä¸ºå®¢æˆ·ç«¯ï¼Œé€šè¿‡ GDB &lt;code&gt;target remote HOST:PORT&lt;/code&gt; å‘½ä»¤è¿æ¥åˆ° GDB Serverï¼Œç„¶åå‘ GDB Server å‘é€è°ƒè¯•å‘½ä»¤ã€æŸ¥çœ‹è°ƒè¯•çš„ç»“æœç­‰ã€‚&lt;/p&gt;&lt;p&gt;è¿™ç§è°ƒè¯•æ–¹å¼æ„å‘³ç€ç›®æ ‡ç¨‹åºæ˜¯åœ¨å¦ä¸€å°æœºå™¨ä¸Šè¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶åœ¨ GDB Client é‡Œæ‰€æœ‰çš„æ˜¾ç¤ºä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¨‹åºçš„å…±äº«åº“åŠ è½½æƒ…å†µã€è¿›ç¨‹çš„å†…å­˜æ˜ å°„æƒ…å†µã€å¯„å­˜å™¨çš„å€¼ç­‰ï¼Œéƒ½æ˜¯ Server æœºå™¨ä¸Šçš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;p&gt;è®©äººç–‘æƒ‘çš„æ˜¯ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼å¯åŠ¨ GDB Client æ—¶ï¼Œä¸€èˆ¬ä¹ŸåŒæ—¶éœ€è¦åœ¨æœ¬æœºä¸Šæœ‰ç›®æ ‡ç¨‹åºã€ç›®æ ‡ç¨‹åºçš„æºä»£ç ï¼Œè€Œä¸”ä¹Ÿéœ€è¦åŠ è½½è¿› GDB Client é‡Œã€‚è¿™æ˜¯å› ä¸º GDB Server åªè´Ÿè´£æ‰§è¡Œç›®æ ‡ç¨‹åºï¼Œè™½ç„¶ç›®æ ‡ç¨‹åºé‡Œæœ¬æ¥å°±æœ‰è°ƒè¯•ä¿¡æ¯ï¼Œä½† GDB Server å‘é€ç»™å®¢æˆ·ç«¯çš„åªæœ‰å½“å‰æŒ‡ä»¤çš„ä½ç½®ä»¥åŠå¯„å­˜å™¨å’Œå†…å­˜æ•°æ®ç­‰æœ‰é™çš„å†…å®¹ã€‚GDB Client éœ€è¦ç¨‹åºçš„ç¬¦å·ä¿¡æ¯ï¼ˆæ¯”å¦‚å‡½æ•°çš„åç§°ã€åœ°å€ã€æºä»£ç ç­‰ï¼‰æ‰èƒ½å°†æœ‰é™çš„æ•°æ®è¿˜åŸä¸ºç°åœºä¿¡æ¯ï¼ˆæ¯”å¦‚å°†å½“å‰æ‰§è¡Œä½ç½®è½¬æ¢ä¸ºæºä»£ç çš„å½“å‰è¡Œï¼‰ã€‚&lt;/p&gt;&lt;ol start=&#34;3&#34;&gt;&lt;li&gt;GDB Server ä¸º QEMUã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¿™ç§æ–¹å¼å…¶å®è·Ÿç¬¬ 2 ç§æƒ…å†µç±»ä¼¼ï¼Œåªä¸è¿‡ GDB Server åœ¨èƒŒååŒæ—¶å¯åŠ¨äº†ä¸€å°è™šæ‹Ÿæœºï¼Œå¹¶ä¸”å®Œå…¨æ§åˆ¶è¿™å°è™šæ‹Ÿæœºçš„ç¡¬ä»¶ã€‚&lt;/p&gt;&lt;ol start=&#34;4&#34;&gt;&lt;li&gt;GDB Server ä¸º OpenOCD&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;img src=&#34;images/openocd.png&#34; alt=&#34;OpenOCD&#34;&gt;&lt;/p&gt;&lt;p&gt;è¿™ç§æ–¹å¼å¸¸è§äºè°ƒè¯• MCU æˆ–è€… FPGA çš„æƒ…å†µï¼Œä¹‹æ‰€ä»¥éœ€è¦ OpenOCD ä½œä¸ºä¸­é—´åª’ä»‹ï¼Œæ˜¯å› ä¸ºç›®æ ‡æœºå™¨æ ¹æœ¬æ— æ³•è¿è¡Œ GDB Serverï¼Œå®ƒåªæä¾›åŸå§‹çš„æˆ–è€…æœ‰é™çš„è°ƒè¯•èƒ½åŠ›ã€‚OpenOCD èµ·åˆ°ä¸€ä¸ª &lt;em&gt;é€‚é…å™¨&lt;/em&gt; çš„ä½œç”¨ï¼ŒæŠŠåŸå§‹çš„ä¿¡å·æˆ–è€…æœ‰é™çš„è°ƒè¯•èƒ½åŠ›è½¬æ¢ä¸ºå¤§å®¶ç†Ÿæ‚‰çš„ GDB ç•Œé¢ï¼ˆæŠ€æœ¯æ¥è¯´ï¼ŒOpenOCD æä¾›äº† GDB Server Protocolï¼‰ã€‚QEMU çš„è°ƒè¯•åŠŸèƒ½å…¶å·¥ä½œåŸç†è·Ÿ OpenOCD ç±»ä¼¼ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;æ³¨æ„å›¾ä¸­çš„ &lt;a href=&#34;https://www.fpga4fun.com/JTAG1.html&#34;&gt;JTAG&lt;/a&gt; å’Œ &lt;a href=&#34;https://wiki.segger.com/SWD&#34;&gt;SWD&lt;/a&gt; æ˜¯ä¸‹è½½å™¨è·Ÿ MCU ä¹‹é—´çš„é€šä¿¡åè®®ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸‹è½½å™¨è·Ÿ MCU ä¹‹é—´çš„ç”µçº¿è¿æ¥æ–¹å¼ï¼‰ï¼Œè€Œå¸¸è§çš„ &lt;code&gt;ST-Link&lt;/code&gt;ï¼Œ&lt;code&gt;J-Link&lt;/code&gt; ç­‰ä¸€èˆ¬æ˜¯æŒ‡ä¸‹è½½å™¨ï¼ˆä¹Ÿå«è°ƒè¯•å™¨ã€ä»¿çœŸå™¨ã€çƒ§å½•å™¨ã€æ¢é’ˆ &lt;code&gt;probe&lt;/code&gt; ç­‰ç­‰å¤çµç²¾æ€ªçš„åç§°ï¼‰ç¡¬ä»¶çš„åç§°ã€‚&lt;code&gt;CMSIS-DAP&lt;/code&gt; å’Œ &lt;code&gt;DAPLink&lt;/code&gt; æ˜¯ ARM çš„å¼€å‘çš„ç”¨äºè¿æ¥ç”µè„‘ï¼ˆUSBï¼‰å’Œä¸‹è½½å™¨ä¹‹é—´çš„å›ºä»¶ï¼ˆ&lt;code&gt;å›ºä»¶&lt;/code&gt; å¯ä»¥ç®€å•ç†è§£ä¸º &lt;code&gt;ç¨‹åº&lt;/code&gt;ï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªä¸‹è½½å™¨ç¡¬ä»¶ï¼Œé™¤äº†è´­ä¹°ç°æˆçš„ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¼€æºçš„ &lt;code&gt;DAPLink&lt;/code&gt; å›ºä»¶å’Œä¸€ä¸ª STM32F103 MCU è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œï¼Œè¯¦ç»†å¯å‚é˜… &lt;a href=&#34;https://daplink.io/&#34;&gt;DAPLink.io&lt;/a&gt;ã€‚OpenOCD æ”¯æŒçš„ä¸‹è½½å™¨åˆ—è¡¨å¯ä»¥å‚é˜… &lt;a href=&#34;https://openocd.org/doc/html/Debug-Adapter-Hardware.html&#34;&gt;OpenOCD - Debug Adapter Hardware&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote&gt;&lt;p&gt;æœ‰äº› MCU å¼€å‘æ¿è‡ªå¸¦äº†ä¸‹è½½å™¨ï¼Œæ¯”å¦‚ &lt;em&gt;micro:bit&lt;/em&gt;ï¼Œé€šè¿‡ USB è¿æ¥åˆ°ç”µè„‘ä¹‹åä¼šå‡ºç°ä¸€ä¸ª U ç›˜ï¼Œç„¶åæŠŠ &lt;em&gt;HEX/BIN&lt;/em&gt; æ–‡ä»¶å¾€é‡Œé¢æ‹–æ”¾å°±å¯ä»¥å®Œæˆçƒ§å½•ï¼Œå…¶å®è¿™æ˜¯ &lt;code&gt;DAPLink&lt;/code&gt; çš„åŠŸèƒ½ï¼Œå…·ä½“å¯ä»¥å‚é˜…&lt;a href=&#34;https://tech.microbit.org/software/daplink-interface/&#34;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚è‡³äº &lt;em&gt;STM32 Nucleo&lt;/em&gt; ç³»åˆ—å¼€å‘æ¿å› ä¸ºé›†æˆäº† &lt;code&gt;ST-Link&lt;/code&gt; æ‰€ä»¥è¿æ¥ç”µè„‘ä¹‹åä¹Ÿä¼šå‡ºç°ä¸€ä¸ª U ç›˜ã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›æ¯”å¦‚ &lt;em&gt;Raspberry Pi Pico&lt;/em&gt; å¼€å‘æ¿ï¼ŒæŒ‰ä½æ¿ä¸Šçš„ &lt;code&gt;BOOTSEL&lt;/code&gt; æŒ‰é’®å†è¿æ¥ USB æ¥çº¿ä¹Ÿä¼šåœ¨ç”µè„‘ä¸Šå‡ºç°ä¸€ä¸ª U ç›˜ï¼Œè¿™æ˜¯ ä¸€ä¸ªåå­—å« &lt;a href=&#34;https://github.com/microsoft/uf2&#34;&gt;UF2 Bootloader&lt;/a&gt; ç”¨äºç®€åŒ–ä¸‹è½½å›ºä»¶å·¥ä½œçš„å·¥å…·ï¼Œå®ƒä¸å…·æœ‰è°ƒè¯•åŠŸèƒ½ï¼Œä¸è¿‡å®˜æ–¹å€’æ˜¯æä¾›äº†ä¸€ä¸ª &lt;a href=&#34;https://www.raspberrypi.com/documentation/microcontrollers/raspberry-pi-pico.html#debugging-using-another-raspberry-pi-pico&#34;&gt;Pico ç‰ˆ DAPLink å›ºä»¶&lt;/a&gt;ï¼Œå®ƒå¯ä»¥è®© Pico å˜æˆä¸€ä¸ªä¸‹è½½å™¨ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;ä½¿ç”¨ OpenOCD è¿æ¥ MCU å¼€å‘æ¿æ—¶ï¼Œéœ€è¦æŒ‡å®š &lt;code&gt;interface/*.cfg&lt;/code&gt; æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸»è¦å†…å®¹å°±æ˜¯ç”¨äºæŒ‡å®šä¸‹è½½å™¨ï¼ˆé©±åŠ¨ï¼‰çš„åç§°ï¼Œè¯¦ç»†å¯å‚é˜… &lt;a href=&#34;https://openocd.org/doc/html/Debug-Adapter-Configuration.html&#34;&gt;OpenOCD - Debug Adapter Configuration&lt;/a&gt;ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å¤§éƒ¨åˆ†å¼€å‘æ¿éƒ½å¸¦æœ‰ USB æ¥å£ï¼Œä½†è¿™ä¸ªæ¥å£ä¸€èˆ¬åªç”¨äºä¾›ç”µã€çƒ§å½•ï¼ˆä¹Ÿå«ä¸‹è½½ï¼‰ã€å’Œä¸²å£é€šä¿¡ï¼ˆUARTï¼‰ï¼Œä¸ä¸€å®šæ”¯æŒè°ƒè¯•åŠŸèƒ½ã€‚è‡³äº STM32 ç³»åˆ—çš„èŠ¯ç‰‡ï¼Œå®ƒå†…ç½®äº† USB é€šä¿¡åŠŸèƒ½ï¼Œæœ‰äº›æ ¸å¿ƒæ¿ï¼ˆä¹Ÿå°±æ˜¯é™¤äº† MCU èŠ¯ç‰‡ä¹‹å¤–æ²¡æœ‰ä»»ä½•å…¶å®ƒèŠ¯ç‰‡çš„å¼€å‘æ¿ï¼‰æŠŠ USB æ¥å£ç›´æ¥è¿æ¥åˆ°èŠ¯ç‰‡çš„ USB ç«¯å£ï¼Œä½†å› ä¸ºé»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰ç›¸åº”çš„ç¨‹åºï¼Œæ‰€ä»¥å®ƒåªèƒ½ç”¨äºä¾›ç”µï¼Œé™¤æ­¤æ²¡æœ‰ä»»ä½•åŠŸèƒ½ã€‚&lt;/p&gt;&lt;h3 id=&#34;è°ƒè¯•è£¸æœºç¨‹åº&#34;&gt;è°ƒè¯•è£¸æœºç¨‹åº&lt;/h3&gt;&lt;p&gt;ä¸‹é¢æ¼”ç¤ºå¦‚ä½•é€šè¿‡ QEMU è°ƒè¯•è£¸æœºç¨‹åºï¼Œæ‰€ä½¿ç”¨çš„ç¨‹åºæ˜¯æœ¬æ–‡å¼€å¤´æ¼”ç¤ºçš„ &lt;code&gt;hello-uart&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆç¼–è¯‘ï¼š&lt;/p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-as -g -o app.o app.S&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ riscv64-elf-ld -T app.lds -o app.out app.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„è¦æ·»åŠ  &lt;code&gt;-g&lt;/code&gt; å‚æ•°ï¼Œè¿™æ ·åœ¨è°ƒè¯•æ—¶èƒ½æ˜¾ç¤ºç­‰å¤šä¿¡æ¯ã€‚&lt;/p&gt;&lt;p&gt;ç„¶åå¯åŠ¨ QEMU çš„è°ƒè¯•æœåŠ¡ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;$ qemu-system-riscv64 -machine virt -nographic -bios none -kernel app.out -s -S&lt;/code&gt;&lt;/p&gt;&lt;p&gt;ç°åœ¨ QEMU åº”è¯¥æ˜¯å¤„äºé™æ­¢çš„çŠ¶æ€ï¼Œæ­£ç­‰å¾… GDB Client è¿æ¥ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&#34;images/gdb-bare-metal.webp&#34; alt=&#34;gdb bare-metal&#34;&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;set disassemble-next-line on&lt;/code&gt;&lt;/p&gt;</description>
     </item>
   
 </channel>
</rss>
